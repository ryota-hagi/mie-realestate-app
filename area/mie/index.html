<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="VBmM5Mikm2LrkY9dXa30MUHtT9KD2SpZFsoGHBuFPWM" /> <script async src="https://www.googletagmanager.com/gtag/js?id=G-SZV3XF0W0G"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-SZV3XF0W0G");</script>
<title>三重県で注文住宅を建てるなら｜エリア別 土地相場・費用シミュレーター | 注文住宅比較.com</title>
<meta name="description" content="三重県で注文住宅を建てるなら、まずエリア別の土地相場を比較。四日市・桑名・鈴鹿・いなべ・亀山・菰野・東員の7エリアの費用シミュレーション、国土交通省の実取引データで理想の土地探しをサポートします。">
<meta name="keywords" content="三重県,注文住宅,土地探し,土地相場,四日市,桑名,鈴鹿,いなべ,亀山,菰野,東員,不動産,土地価格,名古屋通勤,子育て,住みやすさ,エリア比較">
<link rel="canonical" href="https://research.chuumon-soudan.com/area/mie/"> <meta property="og:title" content="三重県で注文住宅を建てるなら｜エリア別 土地相場・費用シミュレーター">
<meta property="og:description" content="三重県北部7エリアの土地価格・取引データ・子育て環境をリアルタイム比較。国土交通省の公式データで注文住宅の土地探しをサポート。">
<meta property="og:type" content="website">
<meta property="og:url" content="https://research.chuumon-soudan.com/area/mie/">
<meta property="og:site_name" content="注文住宅比較.com">
<meta property="og:locale" content="ja_JP"> <meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="三重県で注文住宅を建てるなら｜エリア別 土地相場・費用シミュレーター">
<meta name="twitter:description" content="四日市・桑名・鈴鹿・いなべ・亀山・菰野・東員の7エリアの土地相場と費用を無料シミュレーション。国土交通省データに基づく注文住宅の土地探しツール。">
<meta property="og:image" content="https://research.chuumon-soudan.com/og-image-hub.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:image" content="https://research.chuumon-soudan.com/og-image-hub.png"> <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "三重県 注文住宅エリア比較ツール",
  "description": "三重県北部7エリアの土地価格相場・取引データ・子育て環境をリアルタイムで比較できる無料ツール",
  "url": "https://research.chuumon-soudan.com/area/mie/",
  "applicationCategory": "RealEstate",
  "operatingSystem": "Web",
  "offers": { "@type": "Offer", "price": "0", "priceCurrency": "JPY" },
  "author": { "@type": "Organization", "name": "注文住宅比較.com", "url": "https://research.chuumon-soudan.com/about/", "description": "注文住宅の土地探し・費用比較をサポートする情報サイト" }, "publisher": { "@type": "Organization", "name": "注文住宅比較.com", "url": "https://research.chuumon-soudan.com/about/" }, "dateModified": "2026-02-24",
  "areaServed": { "@type": "State", "name": "三重県" },
  "about": [
    { "@type": "Thing", "name": "注文住宅" },
    { "@type": "Thing", "name": "土地探し" },
    { "@type": "Thing", "name": "不動産価格" }
  ]
}
</script>
<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js" as="script">
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js" as="script">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  /* === Tailwind CSS v3.4.19 (production build) === */
  *,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:after,:before{box-sizing:border-box;border:0 solid #e5e7eb}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.sticky{position:sticky}.top-0{top:0}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:.25rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.ml-1{margin-left:.25rem}.mt-0\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.hidden{display:none}.h-12{height:3rem}.h-6{height:1.5rem}.w-12{width:3rem}.w-16{width:4rem}.w-28{width:7rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-8{width:2rem}.w-full{width:100%}.min-w-0{min-width:0}.max-w-6xl{max-width:72rem}.flex-1{flex:1 1 0%}.flex-shrink-0{flex-shrink:0}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:.25rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem*var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.5rem*(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem*var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.75rem*(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem*var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem*(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem*var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem*(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem*var(--tw-space-y-reverse))}.overflow-x-auto{overflow-x:auto}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-xl{border-radius:.75rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-amber-200{--tw-border-opacity:1;border-color:rgb(253 230 138/var(--tw-border-opacity,1))}.border-blue-100{--tw-border-opacity:1;border-color:rgb(219 234 254/var(--tw-border-opacity,1))}.border-blue-200{--tw-border-opacity:1;border-color:rgb(191 219 254/var(--tw-border-opacity,1))}.border-gray-100{--tw-border-opacity:1;border-color:rgb(243 244 246/var(--tw-border-opacity,1))}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235/var(--tw-border-opacity,1))}.border-gray-50{--tw-border-opacity:1;border-color:rgb(249 250 251/var(--tw-border-opacity,1))}.border-green-200{--tw-border-opacity:1;border-color:rgb(187 247 208/var(--tw-border-opacity,1))}.bg-amber-50{--tw-bg-opacity:1;background-color:rgb(255 251 235/var(--tw-bg-opacity,1))}.bg-amber-500{--tw-bg-opacity:1;background-color:rgb(245 158 11/var(--tw-bg-opacity,1))}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254/var(--tw-bg-opacity,1))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255/var(--tw-bg-opacity,1))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246/var(--tw-bg-opacity,1))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity,1))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity,1))}.bg-gray-400{--tw-bg-opacity:1;background-color:rgb(156 163 175/var(--tw-bg-opacity,1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231/var(--tw-bg-opacity,1))}.bg-green-50{--tw-bg-opacity:1;background-color:rgb(240 253 244/var(--tw-bg-opacity,1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94/var(--tw-bg-opacity,1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74/var(--tw-bg-opacity,1))}.bg-purple-50{--tw-bg-opacity:1;background-color:rgb(250 245 255/var(--tw-bg-opacity,1))}.bg-slate-400{--tw-bg-opacity:1;background-color:rgb(148 163 184/var(--tw-bg-opacity,1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity,1))}.p-2{padding:.5rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.leading-relaxed{line-height:1.625}.text-amber-700{--tw-text-opacity:1;color:rgb(180 83 9/var(--tw-text-opacity,1))}.text-amber-800{--tw-text-opacity:1;color:rgb(146 64 14/var(--tw-text-opacity,1))}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246/var(--tw-text-opacity,1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235/var(--tw-text-opacity,1))}.text-blue-700{--tw-text-opacity:1;color:rgb(29 78 216/var(--tw-text-opacity,1))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity,1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity,1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity,1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99/var(--tw-text-opacity,1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81/var(--tw-text-opacity,1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity,1))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity,1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74/var(--tw-text-opacity,1))}.text-green-700{--tw-text-opacity:1;color:rgb(21 128 61/var(--tw-text-opacity,1))}.text-green-800{--tw-text-opacity:1;color:rgb(22 101 52/var(--tw-text-opacity,1))}.text-purple-700{--tw-text-opacity:1;color:rgb(126 34 206/var(--tw-text-opacity,1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity,1))}.shadow-md{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.shadow-md,.shadow-sm{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgba(0,0,0,.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color)}.outline{outline-style:solid}.blur{--tw-blur:blur(8px)}.blur,.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-filter{-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.hover\:bg-blue-50:hover{--tw-bg-opacity:1;background-color:rgb(239 246 255/var(--tw-bg-opacity,1))}.hover\:bg-blue-700:hover{--tw-bg-opacity:1;background-color:rgb(29 78 216/var(--tw-bg-opacity,1))}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity,1))}.hover\:bg-gray-50:hover{--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity,1))}.hover\:bg-green-700:hover{--tw-bg-opacity:1;background-color:rgb(21 128 61/var(--tw-bg-opacity,1))}@media (min-width:640px){.sm\:block{display:block}.sm\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.sm\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.sm\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}}@media (min-width:768px){.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}@media (min-width:1024px){.lg\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.lg\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}
  * { font-family: 'Noto Sans JP', sans-serif; }
  body { background: linear-gradient(135deg, #f0f4ff 0%, #e8f0fe 50%, #f5f0ff 100%); min-height: 100vh; }
  .glass { background: rgba(255,255,255,0.85); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.6); }
  .card { background: white; border-radius: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04); border: 1px solid #e5e7eb; transition: all 0.2s; }
  .card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
  .medal-gold { background: linear-gradient(135deg, #FFD700, #FFA500); }
  .medal-silver { background: linear-gradient(135deg, #C0C0C0, #A0A0A0); }
  .medal-bronze { background: linear-gradient(135deg, #CD7F32, #B8860B); }
  input[type="range"] { -webkit-appearance: none; height: 6px; border-radius: 3px; outline: none; }
  input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #3b82f6; cursor: pointer; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
  .tab-active { background: #3b82f6; color: white; box-shadow: 0 2px 8px rgba(59,130,246,0.3); }
  .score-bar { height: 6px; border-radius: 3px; background: #e5e7eb; overflow: hidden; }
  .score-bar-fill { height: 100%; border-radius: 3px; transition: width 0.5s ease; }
  .fade-in { animation: fadeIn 0.3s ease-in; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  .pulse-dot { width: 8px; height: 8px; border-radius: 50%; animation: pulse 2s infinite; }
  @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
  .status-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 12px; border-radius: 9999px; font-size: 12px; font-weight: 500; }
  /* Map styles */
  .map-layout { display: flex; gap: 0; height: 600px; }
  #map-container { flex: 1; min-height: 400px; border-radius: 12px 0 0 12px; overflow: hidden; z-index: 1; }
  #map-sidebar { width: 340px; background: white; border-left: 1px solid #e5e7eb; border-radius: 0 12px 12px 0; overflow-y: auto; padding: 0; }
  .leaflet-container { font-family: 'Noto Sans JP', sans-serif; }
  .map-marker-icon { transition: transform 0.2s; }
  .map-marker-icon:hover { transform: scale(1.15); }
  .sidebar-header { padding: 16px; border-bottom: 1px solid #e5e7eb; position: sticky; top: 0; background: white; z-index: 2; }
  .sidebar-body { padding: 16px; }
  .tx-table { width: 100%; border-collapse: collapse; font-size: 12px; }
  .tx-table th { background: #f9fafb; padding: 6px 8px; text-align: left; font-weight: 500; color: #6b7280; position: sticky; top: 0; }
  .tx-table td { padding: 6px 8px; border-top: 1px solid #f3f4f6; }
  .tx-table tr[data-tx-idx] { cursor: pointer; transition: background 0.15s; }
  .tx-table tr[data-tx-idx]:hover { background: #dbeafe; }
  .tx-table tr.tx-active { background: #bfdbfe; }
  /* School district toggle */
  .school-toggle { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 6px; font-size: 12px; cursor: pointer; user-select: none; transition: all 0.2s; border: 1px solid #d1d5db; background: white; }
  .school-toggle.active { background: #dbeafe; border-color: #3b82f6; color: #1e40af; }
  .school-toggle:hover { background: #f3f4f6; }
  .school-toggle.active:hover { background: #bfdbfe; }
  /* School icon markers */
  .school-icon-marker { background: none !important; border: none !important; }
  /* Map loading overlay */
  .map-loading-overlay {
    position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 800;
    background: rgba(0,0,0,0.25); display: flex; flex-direction: column;
    align-items: center; justify-content: center; pointer-events: none;
    transition: opacity 0.3s;
  }
  .map-loading-overlay.hidden { opacity: 0; pointer-events: none; }
  .map-loading-box {
    background: white; border-radius: 12px; padding: 16px 28px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.18); text-align: center;
    animation: mapLoadBounce 2s ease-in-out infinite;
  }
  @keyframes mapLoadBounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }
  .map-loading-spinner {
    width: 32px; height: 32px; border: 3px solid #e5e7eb;
    border-top-color: #3b82f6; border-radius: 50%;
    animation: spin 0.8s linear infinite; margin: 0 auto 8px;
  }
  @keyframes spin { to { transform: rotate(360deg); } }
  .map-loading-progress {
    width: 120px; height: 4px; background: #e5e7eb; border-radius: 2px;
    margin: 8px auto 0; overflow: hidden;
  }
  .map-loading-progress-bar {
    height: 100%; background: #3b82f6; border-radius: 2px;
    transition: width 0.3s ease;
  }
  /* Fullscreen map */
  .map-fullscreen {
    position: fixed !important; top: 0; left: 0; width: 100vw; height: 100vh;
    z-index: 9999; border-radius: 0 !important; margin: 0;
  }
  .map-fullscreen #map-container { border-radius: 0; height: 100vh; }
  .map-fullscreen #map-sidebar { border-radius: 0; height: 100vh; }
  .map-fullscreen-controls {
    position: fixed; top: 12px; left: 50%; transform: translateX(-50%); z-index: 10001;
    background: rgba(255,255,255,0.92); backdrop-filter: blur(8px);
    padding: 8px 12px; border-radius: 10px; display: none;
    box-shadow: 0 2px 12px rgba(0,0,0,0.15);
    gap: 8px; align-items: center;
  }
  .map-fullscreen-controls.visible { display: flex; }
  .map-fullscreen-btn {
    display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px;
    border-radius: 6px; font-size: 12px; cursor: pointer; user-select: none;
    transition: all 0.2s; border: 1px solid #d1d5db; background: white; color: #374151;
  }
  .map-fullscreen-btn:hover { background: #f3f4f6; }
  .map-fullscreen-btn.active { background: #dbeafe; border-color: #3b82f6; color: #1e40af; }
  @media (max-width: 768px) {
    .map-layout { flex-direction: column; height: auto; min-height: 400px; }
    #map-container { height: 400px; min-height: 400px; border-radius: 12px 12px 0 0; }
    #map-sidebar { width: 100%; border-left: none; border-top: 1px solid #e5e7eb; border-radius: 0 0 12px 12px; max-height: 350px; }
    .map-fullscreen #map-sidebar { height: auto; max-height: 40vh; }
  }
  /* === Second Opinion Feature === */
  .so-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center; }
  .so-modal { background: white; border-radius: 16px; max-width: 560px; width: 90%; max-height: 85vh; overflow-y: auto; padding: 24px; box-shadow: 0 25px 50px rgba(0,0,0,0.2); }
  .so-fixed-bar { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(255,255,255,0.95); backdrop-filter: blur(8px); border-top: 1px solid #e5e7eb; padding: 12px 16px; z-index: 100; display: flex; align-items: center; justify-content: center; gap: 16px; box-shadow: 0 -2px 10px rgba(0,0,0,0.08); }
  .so-badge-yellow { background: #fef3c7; color: #92400e; border: 1px solid #fbbf24; padding: 2px 8px; border-radius: 9999px; font-size: 0.7rem; font-weight: 600; }
  .so-badge-red { background: #fee2e2; color: #991b1b; border: 1px solid #f87171; padding: 2px 8px; border-radius: 9999px; font-size: 0.7rem; font-weight: 600; }
  .so-badge-none { background: #f0fdf4; color: #166534; border: 1px solid #86efac; padding: 2px 8px; border-radius: 9999px; font-size: 0.7rem; font-weight: 600; }
  .so-compare-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
  .so-compare-table th, .so-compare-table td { padding: 8px 12px; border: 1px solid #e5e7eb; text-align: left; }
  .so-compare-table th { background: #f9fafb; font-weight: 600; white-space: nowrap; }
  .so-compare-table .missing { color: #d97706; font-style: italic; }
  .so-radio-group { display: flex; flex-wrap: wrap; gap: 8px; }
  .so-radio-group label { padding: 8px 16px; border: 1px solid #d1d5db; border-radius: 8px; cursor: pointer; font-size: 0.85rem; transition: all 0.2s; }
  .so-radio-group label:hover { border-color: #3b82f6; background: #eff6ff; }
  .so-radio-group input:checked + span { color: #1d4ed8; }
  .so-radio-group label:has(input:checked) { border-color: #3b82f6; background: #dbeafe; }
  /* === Compare Filter UI (Pattern C) === */
  .cmp-filter-tag { display: inline-flex; align-items: center; gap: 4px; padding: 7px 13px; border-radius: 20px; font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.2s; border: 1.5px solid #e5e7eb; background: white; color: #6b7280; user-select: none; }
  .cmp-filter-tag:hover { border-color: #93c5fd; color: #3b82f6; }
  .cmp-filter-tag.active { background: #3b82f6; color: white; border-color: #3b82f6; }
  .cmp-filter-tag .cmp-tag-x { margin-left: 4px; opacity: 0.7; cursor: pointer; }
  .cmp-filter-tag .cmp-tag-x:hover { opacity: 1; }
  .cmp-add-col-btn { display: inline-flex; align-items: center; gap: 4px; padding: 7px 13px; border-radius: 20px; font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.2s; border: 1.5px dashed #d1d5db; background: transparent; color: #9ca3af; }
  .cmp-add-col-btn:hover { border-color: #3b82f6; color: #3b82f6; }
  .cmp-preset-btn { padding: 5px 13px; border-radius: 16px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s; border: 1px solid #e5e7eb; background: white; color: #6b7280; }
  .cmp-preset-btn:hover { border-color: #3b82f6; color: #3b82f6; background: #eff6ff; }
  .cmp-row { background: white; border-radius: 10px; padding: 13px 14px; margin-bottom: 6px; cursor: pointer; transition: all 0.2s; border: 1px solid #f3f4f6; display: flex; align-items: center; gap: 10px; }
  .cmp-row:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.06); border-color: #bfdbfe; }
  .cmp-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(4px); z-index: 10000; display: flex; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.25s; }
  .cmp-modal-overlay.open { opacity: 1; pointer-events: auto; }
  .cmp-modal-body { background: white; border-radius: 20px; max-width: 560px; width: 92%; max-height: 85vh; overflow-y: auto; padding: 24px; box-shadow: 0 25px 60px rgba(0,0,0,0.15); transform: translateY(20px); transition: transform 0.3s; }
  .cmp-modal-overlay.open .cmp-modal-body { transform: translateY(0); }
  .cmp-score-bar { height: 5px; border-radius: 3px; background: #e5e7eb; overflow: hidden; }
  .cmp-score-fill { height: 100%; border-radius: 3px; transition: width 0.5s ease; }
  @media (max-width: 768px) {
    .comp-layout-sidebar { flex-direction: column !important; }
    .comp-layout-sidebar > div:first-child { width: 100% !important; }
    .comp-layout-sidebar > div:first-child .sticky { position: relative !important; top: 0 !important; }
    .mobile-title-text { font-size: 1.1rem; }
    .mobile-subtitle-text { font-size: 0.75rem; }
    #mobile-menu-fab, #mobile-drawer-overlay, #mobile-drawer-panel { display: block !important; }
    #mobile-menu-fab { display: flex !important; }
    #pc-nav-bar { display: none !important; }
    #global-nav-links { display: none !important; }
    .cmp-modal-body { max-width: 100%; width: 100%; max-height: 100vh; border-radius: 16px 16px 0 0; height: auto; position: fixed; bottom: 0; left: 0; right: 0; max-height: 90vh; }
  }

  .tip-icon { display: inline-flex; align-items: center; justify-content: center; width: 16px; height: 16px; border-radius: 50%; background: #dbeafe; color: #2563eb; font-size: 10px; font-weight: 700; cursor: help; position: relative; margin-left: 4px; vertical-align: middle; }
  .tip-icon:hover .tip-body, .tip-icon:focus .tip-body { display: block; }
  .tip-body { display: none; position: absolute; bottom: calc(100% + 6px); left: 50%; transform: translateX(-50%); width: 260px; padding: 8px 12px; background: #1e293b; color: #f1f5f9; font-size: 12px; line-height: 1.5; border-radius: 8px; z-index: 50; font-weight: 400; box-shadow: 0 4px 12px rgba(0,0,0,0.15); pointer-events: none; }
  .tip-body::after { content: ''; position: absolute; top: 100%; left: 50%; transform: translateX(-50%); border: 5px solid transparent; border-top-color: #1e293b; }
  /* FAQ accordion */
  .faq-answer { display: none; }
  .faq-open .faq-answer { display: block; }
  .faq-open .faq-chevron { transform: rotate(180deg); }
  
  .seo-static-content { max-width: 800px; margin: 0 auto; padding: 24px 16px; font-family: 'Noto Sans JP', sans-serif; color: #374151; line-height: 1.8; }
  .seo-static-content h1 { font-size: 1.5rem; font-weight: 700; color: #111827; margin-bottom: 16px; }
  .seo-static-content h2 { font-size: 1.2rem; font-weight: 700; color: #1f2937; margin-top: 32px; margin-bottom: 12px; border-bottom: 2px solid #e5e7eb; padding-bottom: 8px; }
  .seo-static-content h3 { font-size: 1rem; font-weight: 600; color: #374151; margin-top: 16px; margin-bottom: 8px; }
  .seo-static-content p { margin-bottom: 12px; font-size: 0.95rem; }
  .seo-static-content ul, .seo-static-content ol { margin-bottom: 16px; padding-left: 24px; }
  .seo-static-content li { margin-bottom: 8px; font-size: 0.9rem; }
  .seo-static-content a { color: #2563eb; text-decoration: underline; }
  .seo-static-content footer { margin-top: 32px; padding-top: 16px; border-top: 1px solid #e5e7eb; font-size: 0.8rem; color: #6b7280; }
  .seo-faq-item { margin-bottom: 16px; padding: 12px 16px; background: #f9fafb; border-radius: 8px; }
  .seo-tip { margin-bottom: 12px; padding: 12px 16px; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3b82f6; }

  /* --- Area Guide (SEO static version, hidden by JS) --- */
  .area-guide { max-width: 800px; margin: 32px auto 0; padding: 0 16px 32px; font-family: 'Noto Sans JP', sans-serif; color: #374151; line-height: 1.8; }
  .area-guide-title { font-size: 1.3rem; font-weight: 700; color: #111827; margin-bottom: 16px; }
  .area-guide details { margin-bottom: 8px; }
  .area-guide summary { cursor: pointer; font-weight: 600; }
  .guide-body p { margin-bottom: 10px; font-size: 0.93rem; }
  .guide-links a, .guide-city-list a, .guide-article-list a { color: #2563eb; }
  .guide-city-list, .guide-article-list { list-style: none; padding: 0; }
  .area-guide-footer { margin-top: 16px; font-size: 0.78rem; color: #9ca3af; }

  /* --- Guide Cards (JS-rendered) --- */
  .guide-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 14px; padding: 18px 12px 14px; text-align: center; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 6px; transition: all 0.2s; }
  .guide-card:hover { border-color: #93c5fd; box-shadow: 0 4px 12px rgba(59,130,246,0.12); transform: translateY(-2px); }
  .guide-card-icon { font-size: 1.6rem; line-height: 1; }
  .guide-card-title { font-size: 0.82rem; font-weight: 600; color: #1f2937; line-height: 1.3; }
  .guide-card-desc { font-size: 0.7rem; color: #6b7280; line-height: 1.3; }

  /* --- Guide Modal (popup) --- */
  .guide-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.45); z-index: 9999; display: none; align-items: flex-end; justify-content: center; }
  .guide-modal-overlay.open { display: flex; }
  .guide-modal-body { background: #fff; border-radius: 20px 20px 0 0; width: 100%; max-width: 600px; max-height: 80vh; overflow-y: auto; padding: 28px 22px 32px; position: relative; box-shadow: 0 -4px 30px rgba(0,0,0,0.15); animation: guideSlideUp 0.25s ease-out; }
  @keyframes guideSlideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
  .guide-modal-close { position: absolute; top: 14px; right: 18px; background: #f3f4f6; border: none; width: 32px; height: 32px; border-radius: 50%; font-size: 1.2rem; cursor: pointer; color: #6b7280; display: flex; align-items: center; justify-content: center; transition: background 0.2s; }
  .guide-modal-close:hover { background: #e5e7eb; color: #374151; }
  #guide-modal-content h3 { font-size: 1.15rem; font-weight: 700; color: #111827; margin-bottom: 14px; padding-right: 30px; }
  #guide-modal-content p { font-size: 0.93rem; color: #374151; line-height: 1.8; margin-bottom: 10px; }
  #guide-modal-content p:last-child { margin-bottom: 0; }
  #guide-modal-content a { color: #2563eb; text-decoration: none; }
  #guide-modal-content a:hover { text-decoration: underline; }
  #guide-modal-content ul { list-style: none; padding: 0; margin: 0 0 10px; }
  #guide-modal-content li { padding: 5px 0; border-bottom: 1px solid #f3f4f6; font-size: 0.9rem; }
  #guide-modal-content li:last-child { border-bottom: none; }
  #guide-modal-content li a { font-weight: 500; }
  .guide-modal-links { font-size: 0.88rem; color: #4b5563; margin-top: 12px; padding-top: 12px; border-top: 1px solid #f3f4f6; }
  @media (min-width: 641px) {
    .guide-modal-overlay { align-items: center; }
    .guide-modal-body { border-radius: 16px; max-height: 70vh; }
    @keyframes guideSlideUp { from { transform: translateY(30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
  }
  
</style>
<script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"トップ","item":"https://research.chuumon-soudan.com/"},{"@type":"ListItem","position":2,"name":"三重県エリア比較","item":"https://research.chuumon-soudan.com/area/mie/"}]}</script>
<script type="application/ld+json">{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"注文住宅と建売住宅、どちらが向いている？","acceptedAnswer":{"@type":"Answer","text":"間取り・外観・性能を自由に決めたい方は注文住宅がおすすめ。三重県は土地が安いため、注文住宅でも建売と同程度の総額に抑えやすいのが特徴です。一方、すぐ入居したい・手間を省きたい方には建売住宅が向いています。"}},{"@type":"Question","name":"三重県で使える住宅補助金はありますか？","acceptedAnswer":{"@type":"Answer","text":"2026年はみらいエコ住宅2026事業（最大125万円）、住宅ローン控除（最大455万円）、給湯省エネ2026事業（最大17万円）等が利用可能。桑名市の移住補助金（最大100万円）など自治体独自の制度もあります。"}},{"@type":"Question","name":"ハウスメーカーと工務店、どちらを選ぶべき？","acceptedAnswer":{"@type":"Answer","text":"ハウスメーカーは品質の安定感と保証が強み、工務店は自由度と価格の柔軟性が特徴。三重県では地元工務店の坪単価50〜65万円に対し、大手ハウスメーカーは70〜90万円が相場。必ず3社以上の相見積もりで比較しましょう。"}}]}</script>
</head>
<body>
<div id="app"></div> <article id="seo-static" class="seo-static-content"> <h1>三重県で注文住宅を建てるなら｜エリア別 土地相場・費用シミュレーター</h1> <p>三重県北部で注文住宅を検討中の方へ。四日市・桑名・鈴鹿・いなべ・亀山・菰野・東員の7エリアの土地価格相場、費用シミュレーション、国土交通省の実取引データを比較して、理想の土地を見つけましょう。</p> <section> <h2>エリア別 注文住宅ガイド</h2> <ul><li><a href="/area/mie/yokkaichi/"><strong>四日市市</strong></a>: 四日市市で注文住宅を検討中の方へ。土地相場（坪単価18.8万円〜）、名古屋35分のアクセス、費用シミュレーション、実取引データを提供。</li><li><a href="/area/mie/kuwana/"><strong>桑名市</strong></a>: 桑名市で注文住宅を検討中の方へ。名古屋25分の好アクセス、土地相場（坪18.4万円〜）、費用シミュレーション、水害リスク情報を提供。</li><li><a href="/area/mie/suzuka/"><strong>鈴鹿市</strong></a>: 鈴鹿市で注文住宅を検討中の方へ。手頃な土地相場（坪13.6万円〜）で広い家が建てやすい。費用シミュレーション・実取引データを提供。</li><li><a href="/area/mie/inabe/"><strong>いなべ市</strong></a>: いなべ市で注文住宅を検討中の方へ。県北部最安の土地相場（坪8.1万円〜）、移住支援制度、費用シミュレーション、自然豊かな環境情報を提供。</li><li><a href="/area/mie/kameyama/"><strong>亀山市</strong></a>: 亀山市で注文住宅を検討中の方へ。交通の要衝で車通勤に便利、手頃な土地相場（坪9.8万円〜）、費用シミュレーション・取引データを提供。</li><li><a href="/area/mie/komono/"><strong>菰野町</strong></a>: 菰野町で注文住宅を検討中の方へ。温泉と自然に囲まれた人気の住環境、土地相場（坪10.3万円〜）、費用シミュレーション・取引データを提供。</li><li><a href="/area/mie/toin/"><strong>東員町</strong></a>: 東員町で注文住宅を検討中の方へ。人口増加中の子育てしやすい街、土地相場（坪11.7万円〜）、費用シミュレーション・取引データを提供。</li></ul> </section>
</article>
<section id="area-guide" class="area-guide"> <h2 class="area-guide-title">三重県の注文住宅ガイド</h2> <details> <summary><h3>三重県が注文住宅に選ばれる理由</h3></summary> <div class="guide-body"> <p>三重県北部は名古屋まで電車25〜50分の通勤圏でありながら、土地の坪単価は8〜19万円と全国平均（坪26万円）の1/3〜2/3。同じ4,000万円の予算でも、名古屋市内より300〜600万円分のゆとりが生まれます。</p> <p>鈴鹿山脈から伊勢湾まで自然環境に恵まれ、子育て支援も充実。各市町村の医療費助成は15〜18歳までカバーされています。</p> <p class="guide-links">詳しく: <a href="/knowledge/mie-livability/">三重県の住みやすい街ランキング</a> / <a href="/knowledge/cost/">注文住宅の費用内訳ガイド</a></p> </div> </details> <details> <summary><h3>エリア別の特徴と土地相場</h3></summary> <div class="guide-body"> <ul class="guide-city-list"><li><a href="/area/mie/yokkaichi/">四日市市</a>（坪18.8万円）</li><li><a href="/area/mie/kuwana/">桑名市</a>（坪18.4万円）</li><li><a href="/area/mie/suzuka/">鈴鹿市</a>（坪13.6万円）</li><li><a href="/area/mie/inabe/">いなべ市</a>（坪8.1万円）</li><li><a href="/area/mie/kameyama/">亀山市</a>（坪9.8万円）</li><li><a href="/area/mie/komono/">菰野町</a>（坪10.3万円）</li><li><a href="/area/mie/toin/">東員町</a>（坪11.7万円）</li></ul> <p>各エリアの詳細な取引データ・費用シミュレーションは、上のツールまたは各エリアページでご確認いただけます。</p> </div> </details> <details> <summary><h3>注文住宅の費用相場（三重県の場合）</h3></summary> <div class="guide-body"> <p>三重県で注文住宅を建てる場合、土地50坪＋建物35坪で総額2,800〜4,200万円が目安です。全国平均（約4,903万円）より700〜2,100万円安く建てられます。</p> <p>住宅ローンは変動金利0.3〜0.5%台が主流。つなぎ融資の手配も忘れずに。2026年は補助金・減税制度も充実しています。</p> <p class="guide-links">詳しく: <a href="/knowledge/cost/">費用の内訳</a> / <a href="/knowledge/housing-loan/">住宅ローンガイド</a> / <a href="/knowledge/subsidy-2026/">2026年の補助金</a></p> </div> </details> <details> <summary><h3>名古屋通勤・子育て環境</h3></summary> <div class="guide-body"> <p>桑名から名古屋25分、四日市35分、鈴鹿50分（近鉄利用）。定期代は月1.5〜3万円程度です。テレワーク併用なら、いなべ市や菰野町の自然豊かなエリアも選択肢に入ります。</p> <p>四日市市は小中学校58校・医療費助成18歳まで。桑名市は「子育て支援日本一」を掲げ、教育環境の充実に力を入れています。</p> <p class="guide-links">詳しく: <a href="/knowledge/mie-commute/">名古屋通勤ガイド</a> / <a href="/knowledge/mie-school-district/">学区ガイド</a></p> </div> </details> <details> <summary><h3>家づくりの進め方</h3></summary> <div class="guide-body"> <p>注文住宅は情報収集から入居まで12〜18ヶ月。まず予算を決め、土地探し・建築会社選びを並行して進めます。見積もりは必ず3社以上で比較しましょう。</p> <p>設計打ち合わせは平均5〜10回。間取りは生活動線と収納計画が最重要ポイントです。</p> <p class="guide-links">詳しく: <a href="/knowledge/flow/">家づくりの流れ</a> / <a href="/knowledge/builder-comparison/">建築会社の選び方</a> / <a href="/knowledge/design-meeting/">設計打ち合わせのコツ</a></p> </div> </details> <details> <summary><h3>住宅性能の選び方</h3></summary> <div class="guide-body"> <p>三重県は温暖な5〜6地域ですが、夏の猛暑対策に断熱等級5以上（UA値0.60以下）が推奨されます。ZEH水準にすると補助金35〜110万円の対象に。</p> <p>南海トラフ地震に備え、耐震等級3の取得も検討しましょう。許容応力度計算による構造計算が最も信頼性が高い方法です。</p> <p class="guide-links">詳しく: <a href="/knowledge/energy-efficiency/">断熱性能ガイド</a> / <a href="/knowledge/earthquake-resistance/">耐震性能ガイド</a></p> </div> </details> <details> <summary><h3>よくある質問（三重県の注文住宅）</h3></summary> <div class="guide-body"> <div class="seo-faq-item"><h3>三重県で注文住宅の土地相場はいくらですか？</h3><p>三重県北部7エリアの住宅地平均地価は約22,000〜53,700円/m²（坪単価8〜19万円）です。最も高いのは桑名市（坪18.4万円）、最も手頃なのはいなべ市（坪8.1万円）。名古屋通勤圏でも手頃な土地が見つかります。</p></div><div class="seo-faq-item"><h3>三重県から名古屋への通勤は可能ですか？</h3><p>可能です。桑名市から名古屋駅まで近鉄急行で最短25分、四日市市から約35分。車でも東名阪自動車道で40分〜1時間程度。三重県北部は名古屋通勤圏として人気があります。</p></div><div class="seo-faq-item"><h3>三重県で注文住宅を建てる総費用の目安は？</h3><p>土地50坪＋建物35坪のスタンダードプラン（65万円/坪）の場合、エリアにより総額2,800〜4,200万円程度。いなべ市なら2,800万円台、桑名駅近なら4,000万円超も。当サイトの費用シミュレーターで詳細な試算が可能です。</p></div><div class="seo-faq-item"><h3>三重県で注文住宅を建てるメリットは？</h3><p>最大のメリットは土地代の安さです。全国平均の坪26万円に対し、三重県北部は坪8〜19万円。同じ予算なら広い土地を確保でき、建物のグレードアップや住宅性能の向上に資金を回せます。名古屋通勤圏でありながらゆとりある暮らしが実現します。</p></div><div class="seo-faq-item"><h3>三重県の注文住宅で使える補助金はありますか？</h3><p>2026年はみらいエコ住宅2026事業（最大125万円）、住宅ローン控除（最大455万円）、給湯省エネ2026事業（最大17万円）などが利用可能。桑名市の移住補助金（最大100万円）など自治体独自の制度もあります。</p></div> </div> </details> <details> <summary><h3>関連ガイド記事</h3></summary> <div class="guide-body"> <ul class="guide-article-list"> <li><a href="/knowledge/cost/">注文住宅の費用内訳ガイド</a></li> <li><a href="/knowledge/flow/">注文住宅の流れ・スケジュール</a></li> <li><a href="/knowledge/housing-loan/">住宅ローン完全ガイド</a></li> <li><a href="/knowledge/land-selection/">土地探しで失敗しない10のポイント</a></li> <li><a href="/knowledge/builder-comparison/">ハウスメーカー・工務店の選び方</a></li> <li><a href="/knowledge/energy-efficiency/">断熱性能・省エネ基準ガイド</a></li> <li><a href="/knowledge/earthquake-resistance/">耐震性能ガイド</a></li> <li><a href="/knowledge/floor-plan/">間取り実例集</a></li> <li><a href="/knowledge/subsidy-2026/">2026年の住宅補助金</a></li> <li><a href="/knowledge/mie-livability/">三重県の住みやすい街ランキング</a></li> </ul> <p><a href="/knowledge/">全19記事を見る →</a></p> </div> </details> <p class="area-guide-footer">データ出典: <a href="https://www.reinfolib.mlit.go.jp/" rel="noopener">国土交通省 不動産情報ライブラリ</a> ｜ 最終更新: 2026-02-24</p>
</section>
<div id="guide-modal" class="guide-modal-overlay" onclick="if(event.target===this)closeGuideModal()"> <div class="guide-modal-body"> <button class="guide-modal-close" onclick="closeGuideModal()">&times;</button> <div id="guide-modal-content"></div> </div>
</div> <div id="cmp-detail-modal" class="cmp-modal-overlay"> <div class="cmp-modal-body" id="cmp-detail-modal-body"></div>
</div> <div id="cmp-col-modal" class="cmp-modal-overlay"> <div class="cmp-modal-body" id="cmp-col-modal-body"></div>
</div> <script>const CONFIG={PROXY_URL:"https://jvfmvitknqnmuduyscnl.supabase.co/functions/v1/mcp-proxy",MCP_REINFO:"https://mcp.n-3.ai/mcp?tools=get-time,reinfolib-real-estate-price,reinfolib-city-list",MCP_ESTAT:"https://mcp.n-3.ai/mcp?tools=e-stat-get-stats-list,e-stat-get-meta-info,e-stat-get-data-catalog"};class MCPClient{constructor(mcpUrl,proxyUrl){this.mcpUrl=mcpUrl,this.proxyUrl=proxyUrl,this.sessionId=null,this.requestId=0,this.connected=!1,this.tools=[],this.useProxy=!!proxyUrl}_buildFetchUrl(){return this.useProxy?`${this.proxyUrl}?url=${encodeURIComponent(this.mcpUrl)}`:this.mcpUrl}async initialize(){const attempts=this.useProxy?[!0,!1]:[!1];let lastError;for(const viaProxy of attempts)try{this.useProxy=viaProxy;const url=this._buildFetchUrl(),res=await fetch(url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream"},body:JSON.stringify({jsonrpc:"2.0",id:++this.requestId,method:"initialize",params:{protocolVersion:"2025-03-26",capabilities:{},clientInfo:{name:"yume-no-sumika-realestate",version:"1.0.0"}}})});if(!res.ok)throw new Error(`HTTP ${res.status}`);const sid=res.headers.get("Mcp-Session-Id");sid&&(this.sessionId=sid);const data=await this._parseResponse(res),headers={"Content-Type":"application/json",Accept:"application/json"};return this.sessionId&&(headers["Mcp-Session-Id"]=this.sessionId),await fetch(this._buildFetchUrl(),{method:"POST",headers:headers,body:JSON.stringify({jsonrpc:"2.0",method:"notifications/initialized"})}),this.connected=!0,console.log("MCP connected via "+(viaProxy?"proxy":"direct")),data}catch(e){lastError=e,console.warn(`MCP ${viaProxy?"proxy":"direct"} failed:`,e.message)}throw this.connected=!1,lastError}async listTools(){const data=await this._request("tools/list",{});return data&&data.tools&&(this.tools=data.tools),this.tools}async callTool(name,args={}){return this._request("tools/call",{name:name,arguments:args})}async _request(method,params){const url=this._buildFetchUrl(),headers={"Content-Type":"application/json",Accept:"application/json, text/event-stream"};this.sessionId&&(headers["Mcp-Session-Id"]=this.sessionId);const res=await fetch(url,{method:"POST",headers:headers,body:JSON.stringify({jsonrpc:"2.0",id:++this.requestId,method:method,params:params})});if(!res.ok)throw new Error(`HTTP ${res.status}`);return this._parseResponse(res)}async _parseResponse(res){if((res.headers.get("Content-Type")||"").includes("text/event-stream")){const lines=(await res.text()).split("\n");let lastData=null;for(const line of lines)if(line.startsWith("data: "))try{lastData=JSON.parse(line.slice(6))}catch{}return lastData?.result||lastData}const json=await res.json();return json.result||json}}const AREAS=[{id:"yokkaichi",name:"四日市市",cityCode:"24202",lat:34.965,lng:136.6244,landPriceAvg:57020,residentialPrice:48385,commercialPrice:89007,pricePerTsubo:188498,yoyChange:1.33,population:311e3,popGrowthRate:-.3,accessToNagoya:35,hospitals:42,schools:58,parks:35,shopping:120,safetyScore:78,childcareScore:82,naturalScore:55,description:"三重県最大の都市。石油化学コンビナートと港湾を擁する産業都市。近鉄・JR両線で名古屋へ直通。大型商業施設が充実し、医療・教育インフラも県内トップクラス。",highlights:["県内最大の商業集積","名古屋へ35分","医療施設充実","東名阪・新名神IC"],risks:["一部地域の大気環境","中心部の地価上昇"],trend:[{y:"2020",p:52e3},{y:"2021",p:53200},{y:"2022",p:54500},{y:"2023",p:55800},{y:"2024",p:56300},{y:"2025",p:57020}],recAreas:["富田・富洲原エリア（駅近で割安）","笹川・日永エリア（住環境良好）","水沢・小山田エリア（自然豊か）"]},{id:"kuwana",name:"桑名市",cityCode:"24205",lat:35.0585,lng:136.6834,landPriceAvg:55543,residentialPrice:53686,commercialPrice:86714,pricePerTsubo:183614,yoyChange:.82,population:14e4,popGrowthRate:-.5,accessToNagoya:25,hospitals:18,schools:28,parks:22,shopping:55,safetyScore:82,childcareScore:85,naturalScore:68,description:"名古屋への通勤圏として人気。桑名駅から名古屋まで最短25分。ナガシマスパーランドやなばなの里など観光資源も豊富。歴史的な城下町の風情が残る。",highlights:["名古屋へ最短25分","子育て環境◎","観光資源豊富","住環境の良さ"],risks:["揖斐川・長良川の洪水リスク","人口減少傾向"],trend:[{y:"2020",p:52500},{y:"2021",p:53e3},{y:"2022",p:53800},{y:"2023",p:54500},{y:"2024",p:55100},{y:"2025",p:55543}],recAreas:["桑名駅周辺（利便性重視）","多度エリア（自然と価格バランス）","長島エリア（ゆったり居住）"]},{id:"suzuka",name:"鈴鹿市",cityCode:"24207",lat:34.8824,lng:136.5842,landPriceAvg:41015,residentialPrice:38e3,commercialPrice:62e3,pricePerTsubo:135587,yoyChange:1.11,population:195e3,popGrowthRate:-.2,accessToNagoya:55,hospitals:25,schools:42,parks:28,shopping:72,safetyScore:80,childcareScore:80,naturalScore:65,description:"鈴鹿サーキットとHonda技研の企業城下町。名古屋圏と比べ地価が手頃で、広い土地を確保しやすい。新名神鈴鹿スマートICの開通で交通利便性が向上。",highlights:["地価が手頃で広い家が建てやすい","Honda関連の雇用安定","新名神スマートIC","中勢バイパス整備"],risks:["名古屋通勤にはやや遠い","沿岸部の津波リスク"],trend:[{y:"2020",p:38500},{y:"2021",p:39e3},{y:"2022",p:39600},{y:"2023",p:40200},{y:"2024",p:40600},{y:"2025",p:41015}],recAreas:["白子駅周辺（利便性◎）","平田・算所エリア（落ち着いた住宅地）","庄野・加佐登エリア（新興住宅地）"]},{id:"inabe",name:"いなべ市",cityCode:"24212",lat:35.1146,lng:136.5612,landPriceAvg:24500,residentialPrice:22e3,commercialPrice:35e3,pricePerTsubo:81e3,yoyChange:.45,population:44e3,popGrowthRate:-.8,accessToNagoya:65,hospitals:6,schools:14,parks:18,shopping:15,safetyScore:88,childcareScore:75,naturalScore:95,description:"鈴鹿山脈の麓に広がる自然豊かなまち。アウトドアレジャーが充実し、移住先として注目度上昇中。地価は県北部で最も手頃な水準。",highlights:["圧倒的な自然環境","地価が非常に手頃","移住支援制度充実","アウトドア天国"],risks:["商業施設が少ない","公共交通が不便","人口減少"],trend:[{y:"2020",p:23500},{y:"2021",p:23700},{y:"2022",p:23900},{y:"2023",p:24100},{y:"2024",p:24300},{y:"2025",p:24500}],recAreas:["北勢エリア（駅近・利便性）","員弁エリア（閑静な住宅地）","藤原エリア（山間部・格安）"]},{id:"kameyama",name:"亀山市",cityCode:"24210",lat:34.854,lng:136.452,landPriceAvg:29500,residentialPrice:27e3,commercialPrice:42e3,pricePerTsubo:97500,yoyChange:.68,population:49e3,popGrowthRate:-.6,accessToNagoya:60,hospitals:8,schools:16,parks:15,shopping:22,safetyScore:85,childcareScore:76,naturalScore:80,description:"東名阪と新名神が交差する交通の要衝。旧東海道の宿場町の歴史を持つ。Sharp亀山工場をはじめ製造業が集積。",highlights:["高速道路の結節点","製造業の雇用","歴史的な街並み","割安な地価"],risks:["JRの本数が少ない","商業施設が限定的"],trend:[{y:"2020",p:28e3},{y:"2021",p:28300},{y:"2022",p:28700},{y:"2023",p:29e3},{y:"2024",p:29200},{y:"2025",p:29500}],recAreas:["亀山駅周辺（JRアクセス）","関エリア（宿場町の風情）","野村エリア（新興住宅地）"]},{id:"komono",name:"菰野町",cityCode:"24341",lat:35.0244,lng:136.509,landPriceAvg:31e3,residentialPrice:29e3,commercialPrice:45e3,pricePerTsubo:102500,yoyChange:.55,population:41e3,popGrowthRate:-.1,accessToNagoya:50,hospitals:7,schools:12,parks:20,shopping:25,safetyScore:86,childcareScore:83,naturalScore:92,description:"御在所岳と湯の山温泉を抱える観光と自然のまち。近鉄湯の山線で四日市へ直通。人口減少率が低く、移住先として人気が高い。",highlights:["温泉と自然環境","人口減少率が低い","四日市へのアクセス良好","移住人気上昇中"],risks:["鉄道は湯の山線のみ","大型商業施設が少ない"],trend:[{y:"2020",p:29500},{y:"2021",p:29800},{y:"2022",p:30200},{y:"2023",p:30500},{y:"2024",p:30800},{y:"2025",p:31e3}],recAreas:["菰野駅周辺（利便性重視）","湯の山エリア（温泉・自然）","竹成・千草エリア（閑静）"]},{id:"toin",name:"東員町",cityCode:"24343",lat:35.069,lng:136.603,landPriceAvg:35500,residentialPrice:33e3,commercialPrice:48e3,pricePerTsubo:117400,yoyChange:.72,population:26e3,popGrowthRate:.1,accessToNagoya:40,hospitals:5,schools:8,parks:12,shopping:18,safetyScore:87,childcareScore:88,naturalScore:72,description:"イオンモール東員を中心に商業施設が充実したコンパクトシティ。人口が微増傾向でファミリー層に人気。",highlights:["人口増加傾向","イオンモール東員","子育て世代に人気","コンパクトで住みやすい"],risks:["鉄道アクセスが限定的","町域が狭い"],trend:[{y:"2020",p:33500},{y:"2021",p:34e3},{y:"2022",p:34500},{y:"2023",p:35e3},{y:"2024",p:35200},{y:"2025",p:35500}],recAreas:["東員駅周辺（駅近）","笹尾エリア（ファミリー向け）","城山エリア（新興住宅地）"]}],CITY_SEO_DATA={yokkaichi:{nameJa:"四日市市",tips:[{title:"西部の低層住居専用地域が注文住宅に人気",body:"四日市市西部（水沢・小山田・桜地区）は第一種低層住居専用地域が多く、閑静な住環境で注文住宅に最適です。コンビナートのある東部沿岸と比べ空気もきれいで、坪単価も10〜15万円と手頃。名古屋通勤なら近鉄四日市駅まで車15分圏内がおすすめです。"},{title:"新名神・東名阪ICの活用で通勤・買い物が便利",body:"四日市市は新名神高速道路と東名阪自動車道のICが複数あり、車での名古屋通勤（約40分）や大型商業施設へのアクセスが良好。土地選びの際は高速IC徒歩圏ではなく、IC車10分圏をターゲットにすると土地価格を抑えつつ利便性を確保できます。"},{title:"笹川・日永エリアは生活利便性と価格のバランスが良い",body:"近鉄内部線沿線の笹川・日永エリアは、スーパー・病院・学校が徒歩圏に揃い、坪単価12〜18万円程度。近鉄四日市駅まで10分以内でアクセスでき、注文住宅用の50〜60坪の土地が1,000万円前後で見つかることも。"}],faqs:[{question:"四日市市で注文住宅用の土地相場はいくらですか？",answer:"四日市市の住宅地平均地価は約48,000円/m²（坪単価約18.8万円）です。西部郊外では坪10〜15万円、駅近の住宅地では坪20〜30万円が目安です。50坪の土地であれば500万〜1,500万円程度が相場となります。"},{question:"四日市市から名古屋への通勤時間はどのくらいですか？",answer:"近鉄四日市駅から名古屋駅まで急行で約35分です。JR四日市駅からは快速みえで約30分。朝のラッシュ時でも座れることが多く、名古屋通勤に適したエリアです。車通勤の場合は東名阪自動車道で約40分〜1時間です。"},{question:"四日市市で注文住宅を建てる総費用の目安は？",answer:"土地50坪＋建物35坪（約115m²）のスタンダードプランの場合、土地代800〜1,200万円＋建築費2,275万円（65万円/坪×35坪）＋諸費用300〜400万円で、総額3,400〜3,900万円程度が目安です。ローコスト住宅なら総額2,500万円台も可能です。"},{question:"四日市市のハザードマップで注意すべき地域は？",answer:"東部沿岸（塩浜・楠地区）は津波・高潮リスク、市内中心部を流れる三滝川・海蔵川沿いは洪水リスクがあります。注文住宅用の土地購入前には必ず四日市市のハザードマップを確認し、特に西部の高台エリアが安全性が高くおすすめです。"},{question:"四日市市の子育て環境はどうですか？",answer:"四日市市は県内最多の58校の小中学校、42の医療施設があり、子育て環境は充実しています。待機児童対策も進んでおり、2024年度の待機児童数はほぼゼロ。市独自の子ども医療費助成（18歳まで）もあります。"}],checklist_notes:"四日市市は工業地帯と住宅地が混在するエリアがあるため、用途地域の確認が特に重要です。",neighbors:[{id:"kuwana",name:"桑名市"},{id:"suzuka",name:"鈴鹿市"},{id:"komono",name:"菰野町"}],cityUrl:"/area/mie/yokkaichi/"},kuwana:{nameJa:"桑名市",tips:[{title:"ハザードマップの確認が特に重要なエリア",body:"桑名市は揖斐川・長良川・木曽川の三川が合流する地域で、河川沿いの低地は洪水リスクがあります。注文住宅の土地選びでは必ず桑名市のハザードマップを確認し、浸水想定区域外の高台を選びましょう。多度地区や員弁川以北は比較的安全です。"},{title:"名古屋通勤なら桑名駅徒歩圏が最強",body:"桑名駅から名古屋駅まで近鉄急行で最短25分。JR関西本線・養老鉄道も利用可能な交通の要衝です。駅徒歩15分圏は坪20〜30万円とやや高めですが、名古屋通勤の利便性を考えると十分な価値があります。"},{title:"長島エリアはゆとりある土地が見つかりやすい",body:"桑名市長島地区はナガシマスパーランド周辺の観光地ですが、住宅地としても開発が進んでいます。坪10〜15万円と手頃で、60坪以上のゆとりある土地が見つかりやすい。桑名駅まで車15分程度でアクセスも良好です。"}],faqs:[{question:"桑名市で注文住宅用の土地相場はいくらですか？",answer:"桑名市の住宅地平均地価は約53,700円/m²（坪単価約18.4万円）です。桑名駅周辺は坪20〜30万円、郊外の多度・長島エリアでは坪8〜15万円が目安。50坪の土地で400万〜1,500万円程度の幅があります。"},{question:"桑名市から名古屋への通勤時間はどのくらいですか？",answer:"桑名駅から名古屋駅まで近鉄急行で最短25分、JR関西本線快速で約20分です。三重県北部では名古屋に最も近いエリアの一つで、通勤ラッシュ時でも比較的快適に通勤できます。"},{question:"桑名市で注文住宅を建てる総費用の目安は？",answer:"土地50坪＋建物35坪のスタンダードプランの場合、土地代700〜1,500万円＋建築費2,275万円＋諸費用300〜400万円で、総額3,300〜4,200万円程度が目安です。郊外エリアなら土地代を大幅に抑えられます。"},{question:"桑名市の水害リスクはどのくらいありますか？",answer:"桑名市は揖斐川・長良川・木曽川の合流点に位置し、一部地域は浸水想定区域に含まれます。特に海抜の低い東部エリアは注意が必要です。土地購入前には桑名市の洪水ハザードマップ、内水ハザードマップを必ず確認してください。"}],checklist_notes:"桑名市は河川が多いため、洪水ハザードマップの確認と地盤調査が特に重要です。",neighbors:[{id:"yokkaichi",name:"四日市市"},{id:"toin",name:"東員町"},{id:"inabe",name:"いなべ市"}],cityUrl:"/area/mie/kuwana/"},suzuka:{nameJa:"鈴鹿市",tips:[{title:"地価が手頃で広い家が建てやすいエリア",body:"鈴鹿市の住宅地坪単価は約13.6万円と、四日市や桑名と比べて3〜5万円/坪ほど安く、同じ予算でより広い土地を確保できます。60坪の土地でも800万円台から見つかるため、庭付きの注文住宅を検討している方に特におすすめです。"},{title:"白子駅周辺は利便性と価格のバランスが良い",body:"近鉄白子駅は特急停車駅で名古屋まで約40分。駅周辺の住宅地は坪15〜20万円程度で、スーパーや病院も徒歩圏。鈴鹿市で最も生活利便性が高いエリアの一つです。注文住宅用の区画分譲地も多く出ています。"},{title:"新名神スマートICで交通利便性が大幅向上",body:"2019年開通の新名神鈴鹿PAスマートICにより、鈴鹿市西部から名古屋方面への車アクセスが大幅に改善。IC周辺の土地価格は坪10万円前後とまだ手頃で、今後の値上がりも期待できるエリアです。"}],faqs:[{question:"鈴鹿市で注文住宅用の土地相場はいくらですか？",answer:"鈴鹿市の住宅地平均地価は約38,000円/m²（坪単価約13.6万円）です。白子駅周辺は坪15〜20万円、郊外エリアでは坪8〜12万円が目安。60坪の土地が500万〜1,200万円程度で見つかります。"},{question:"鈴鹿市から名古屋への通勤は可能ですか？",answer:"近鉄白子駅から名古屋駅まで特急で約40分、急行で約55分です。四日市や桑名と比べるとやや遠いですが、特急利用で十分通勤圏内。車では新名神高速で約50分です。地価の安さを考えると良い選択肢です。"},{question:"鈴鹿市で注文住宅を建てる総費用の目安は？",answer:"土地60坪＋建物35坪のスタンダードプランの場合、土地代500〜1,000万円＋建築費2,275万円＋諸費用300〜400万円で、総額3,100〜3,700万円程度が目安。鈴鹿市なら土地を広く取れるのが魅力です。"},{question:"鈴鹿市の住環境・子育て環境はどうですか？",answer:"鈴鹿市は人口約19.5万人の中核市で、42校の小中学校と25の医療施設があります。Honda技研の企業城下町として雇用が安定しており、ファミリー層が多い住宅地が形成されています。"}],checklist_notes:"鈴鹿市は沿岸部の津波リスクに注意。内陸部の住宅地を選ぶと安心です。",neighbors:[{id:"yokkaichi",name:"四日市市"},{id:"kameyama",name:"亀山市"}],cityUrl:"/area/mie/suzuka/"},inabe:{nameJa:"いなべ市",tips:[{title:"県北部で最もコストを抑えた注文住宅が可能",body:"いなべ市の坪単価は約8.1万円と三重県北部7エリアで最も手頃。60坪の土地が500万円以下で見つかることも珍しくなく、土地＋建物の総予算2,500万円台で注文住宅の夢が叶います。移住支援制度（最大100万円）も活用可能です。"},{title:"自然環境を重視するなら最高の選択肢",body:"鈴鹿山脈の麓に位置するいなべ市は、自然環境スコアが7エリア中トップ。登山・キャンプ・釣りなどアウトドアを日常的に楽しめます。「いなべ市農業公園」や「藤原岳」など、子どもの情操教育にも最適な環境です。"},{title:"北勢エリア（阿下喜駅周辺）が生活拠点として便利",body:"いなべ市内で最も生活利便性が高いのが北勢エリア。三岐鉄道北勢線の阿下喜駅があり、スーパー・病院・学校が集まります。坪8〜10万円程度で、注文住宅に十分な広さの土地を確保できます。"}],faqs:[{question:"いなべ市で注文住宅用の土地相場はいくらですか？",answer:"いなべ市の住宅地平均地価は約22,000円/m²（坪単価約8.1万円）です。北勢エリアで坪8〜10万円、山間部の藤原エリアでは坪5万円以下も。60坪の土地が300〜600万円程度で見つかります。"},{question:"いなべ市から名古屋への通勤は可能ですか？",answer:"いなべ市から名古屋駅までは車で約65分（東名阪自動車道経由）。公共交通では三岐鉄道＋近鉄で約90分。名古屋への毎日の通勤にはやや遠いですが、テレワーク併用なら十分選択肢に入ります。"},{question:"いなべ市の移住支援制度はありますか？",answer:"いなべ市は移住・定住支援に力を入れており、移住支援金（最大100万円）、空き家バンク制度、新築住宅建設奨励金などがあります。詳細はいなべ市役所の移住サポートセンターに確認することをおすすめします。"},{question:"いなべ市で注文住宅を建てる総費用の目安は？",answer:"土地60坪＋建物35坪のスタンダードプランの場合、土地代300〜600万円＋建築費2,275万円＋諸費用250〜350万円で、総額2,800〜3,200万円程度が目安。県北部で最もコストを抑えた家づくりが可能です。"}],checklist_notes:"いなべ市は山間部が多いため、地盤調査と上下水道の引き込み状況の確認が特に重要です。",neighbors:[{id:"kuwana",name:"桑名市"},{id:"toin",name:"東員町"},{id:"komono",name:"菰野町"}],cityUrl:"/area/mie/inabe/"},kameyama:{nameJa:"亀山市",tips:[{title:"高速道路の結節点で車通勤に最適",body:"亀山市は東名阪自動車道と新名神高速道路が交差する交通の要衝。名古屋方面へも大阪方面へもアクセスが良く、車通勤メインの方には特におすすめ。亀山ICや鈴鹿IC近くの住宅地は坪10〜15万円程度です。"},{title:"旧東海道の歴史ある街並みと新興住宅地の共存",body:"関宿をはじめとする歴史的な街並みが残る一方、亀山駅周辺では新興住宅地の開発も進んでいます。野村エリアは区画整理された新興住宅地で、坪12〜15万円程度。学校・公園も近く、ファミリー向けの注文住宅に適しています。"}],faqs:[{question:"亀山市で注文住宅用の土地相場はいくらですか？",answer:"亀山市の住宅地平均地価は約27,000円/m²（坪単価約9.8万円）です。亀山駅周辺で坪12〜18万円、郊外の関エリアでは坪6〜10万円が目安。60坪の土地が400〜1,000万円程度で見つかります。"},{question:"亀山市から名古屋への通勤時間はどのくらいですか？",answer:"JR亀山駅から名古屋駅まで快速みえで約60分。車では東名阪自動車道で約50分〜1時間です。名古屋通勤は可能ですが、週数回のテレワーク併用が理想的です。"},{question:"亀山市で注文住宅を建てる総費用の目安は？",answer:"土地60坪＋建物35坪のスタンダードプランの場合、土地代400〜800万円＋建築費2,275万円＋諸費用250〜350万円で、総額2,900〜3,400万円程度が目安です。"},{question:"亀山市の製造業雇用は安定していますか？",answer:"亀山市にはSharp亀山工場をはじめ、多数の製造業が集積しています。液晶パネル工場の規模は縮小しましたが、代替産業の誘致も進んでおり、雇用基盤は維持されています。"}],checklist_notes:"亀山市はJRの本数が限られるため、車中心の生活を前提にした土地選びがおすすめです。",neighbors:[{id:"suzuka",name:"鈴鹿市"}],cityUrl:"/area/mie/kameyama/"},komono:{nameJa:"菰野町",tips:[{title:"温泉と自然に囲まれた理想の住環境",body:"御在所岳と湯の山温泉を抱える菰野町は、自然環境スコアが92/100と非常に高い。温泉施設が身近にあり、週末は登山やキャンプを楽しめる環境。子育て世代の移住先として人気が高まっています。"},{title:"人口減少率が低く、将来性のあるエリア",body:"菰野町の人口減少率は-0.1%と7エリア中最低（最も安定）。四日市のベッドタウンとして若年層の流入が続いており、新規分譲地も定期的に供給されています。坪10〜15万円で良質な住宅地が見つかります。"},{title:"菰野駅周辺が最も利便性の高い住宅エリア",body:"近鉄湯の山線の菰野駅周辺は、スーパー・ドラッグストア・クリニックが集まる生活拠点。四日市駅まで近鉄で約20分、車なら15分程度。坪12〜18万円で駅近の住宅地が見つかります。"}],faqs:[{question:"菰野町で注文住宅用の土地相場はいくらですか？",answer:"菰野町の住宅地平均地価は約29,000円/m²（坪単価約10.3万円）です。菰野駅周辺で坪12〜18万円、湯の山エリアで坪8〜12万円が目安。50〜60坪の土地が500〜900万円程度で見つかります。"},{question:"菰野町から名古屋への通勤は可能ですか？",answer:"菰野駅から近鉄湯の山線で四日市駅へ約20分、そこから名古屋駅まで急行で約35分。乗り換え込みで約60分の通勤時間です。車では東名阪自動車道四日市IC経由で約50分。"},{question:"菰野町で注文住宅を建てる総費用の目安は？",answer:"土地55坪＋建物35坪のスタンダードプランの場合、土地代500〜900万円＋建築費2,275万円＋諸費用280〜380万円で、総額3,100〜3,600万円程度が目安です。"},{question:"菰野町の子育て環境はどうですか？",answer:"菰野町は子育て支援に力を入れており、子ども医療費助成（18歳まで）、保育料の軽減制度があります。自然体験の場が豊富で、12の学校と7つの医療施設があり、コンパクトながら充実した環境です。"}],checklist_notes:"菰野町は山間部に近いため、冬季の積雪・凍結対策と地盤調査を念入りに行いましょう。",neighbors:[{id:"yokkaichi",name:"四日市市"},{id:"inabe",name:"いなべ市"}],cityUrl:"/area/mie/komono/"},toin:{nameJa:"東員町",tips:[{title:"人口増加傾向のコンパクトシティ",body:"東員町は7エリアで唯一人口が微増傾向（+0.1%）のエリア。イオンモール東員を核とした商業施設の充実度が高く、ファミリー層の転入が続いています。コンパクトな町域で、どこに住んでも生活施設にアクセスしやすいのが魅力です。"},{title:"名古屋通勤は三岐鉄道＋近鉄の組み合わせ",body:"東員駅から三岐鉄道で桑名駅へ約15分、そこから近鉄で名古屋駅まで約25分。乗り換え込みで約40〜50分の通勤時間です。車では東名阪自動車道桑名IC経由で約40分。通勤利便性は悪くありません。"},{title:"笹尾・城山エリアの新興住宅地がファミリーに人気",body:"東員町南部の笹尾・城山エリアは区画整理された新興住宅地で、坪12〜15万円程度。イオンモール東員まで車5分、小学校も近く、注文住宅を建てるファミリー世帯に人気のエリアです。"}],faqs:[{question:"東員町で注文住宅用の土地相場はいくらですか？",answer:"東員町の住宅地平均地価は約33,000円/m²（坪単価約11.7万円）です。東員駅周辺で坪13〜18万円、笹尾エリアで坪10〜14万円が目安。50坪の土地が500〜900万円程度で見つかります。"},{question:"東員町から名古屋への通勤時間はどのくらいですか？",answer:"三岐鉄道で桑名駅経由、近鉄で名古屋駅まで約40〜50分です。車では東名阪自動車道経由で約40分。桑名駅での乗り換えがスムーズで、実質的な通勤負担は小さめです。"},{question:"東員町で注文住宅を建てる総費用の目安は？",answer:"土地50坪＋建物35坪のスタンダードプランの場合、土地代500〜900万円＋建築費2,275万円＋諸費用280〜380万円で、総額3,100〜3,600万円程度が目安です。"},{question:"東員町の子育て環境はどうですか？",answer:"東員町は子育て世代に人気が高く、子育てスコアは7エリア中トップの88点。小中学校8校、保育園も充実しており、イオンモール東員があるため日常の買い物にも困りません。町の人口が増加傾向にあるのも安心材料です。"}],checklist_notes:"東員町は町域が狭いため、将来の増築・建て替え時の建ぺい率・容積率の余裕を確認しておきましょう。",neighbors:[{id:"kuwana",name:"桑名市"},{id:"inabe",name:"いなべ市"}],cityUrl:"/area/mie/toin/"},_checklist:[{id:1,label:"用途地域を確認した",detail:"第一種低層住居専用地域は注文住宅に最も適した用途地域の一つ。建ぺい率・容積率が厳しい分、閑静な住環境が保証されます。"},{id:2,label:"前面道路の幅員を確認した",detail:"建築基準法上、幅員4m以上の道路に2m以上接している必要があります（接道義務）。4m未満の場合はセットバック（後退）が必要です。"},{id:3,label:"ハザードマップを確認した",detail:"洪水・土砂災害・津波の各ハザードマップを確認。三重県は河川が多く、沿岸部は津波リスクもあるため、必ず事前チェックを。"},{id:4,label:"上下水道の状況を確認した",detail:"上水道・下水道が前面道路まで来ているか確認。未整備の場合は引き込み工事費（50〜150万円）が別途必要になります。"},{id:5,label:"地盤の状態を確認した",detail:"地盤改良工事が必要な場合、表層改良で30〜50万円、柱状改良で50〜100万円、鋼管杭で100〜200万円程度の追加費用がかかります。"},{id:6,label:"接道義務を確認した",detail:"建築基準法第43条により、建築物の敷地は幅員4m以上の道路に2m以上接していなければなりません。私道の場合は権利関係も要確認。"},{id:7,label:"建築条件の有無を確認した",detail:"「建築条件付き」の土地は指定の建築会社で建てる必要があります。注文住宅で好きな会社を選びたい場合は「条件なし」を選びましょう。"},{id:8,label:"周辺の開発計画を確認した",detail:"近隣に大規模商業施設や道路の建設計画があると、将来の利便性・地価に影響します。市町の都市計画課で確認できます。"},{id:9,label:"現地を複数回訪問した",detail:"平日・休日、朝・昼・夜と時間帯を変えて現地を訪問。騒音・交通量・日当たり・近隣の様子を自分の目で確認しましょう。"},{id:10,label:"複数の建築会社から見積もりを取った",detail:"最低3社から見積もりを取り、価格だけでなく標準仕様・保証内容・アフターサービスを比較。相見積もりで適正価格を把握できます。"}]},COLORS=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4"],state={view:"ranking",selectedAreaId:null,mapSelectedAreaId:null,mcpStatus:"disconnected",mcpMessage:"",mcpLiveData:null,weights:{price:25,access:20,growth:15,living:15,family:15,nature:10},charts:{},mapSelectedDistrict:null,cmpSelectedColumns:["pricePerTsubo","accessToNagoya","total"],cmpCharts:{},weightsExpanded:!1},WEIGHT_PRESETS={kosodate:{label:"🍼 子育て重視",weights:{price:10,access:10,growth:5,living:20,family:35,nature:20}},tsuukin:{label:"🚃 通勤重視",weights:{price:15,access:35,growth:20,living:15,family:10,nature:5}},kakaku:{label:"💰 価格重視",weights:{price:35,access:10,growth:25,living:15,family:10,nature:5}}},CMP_COLUMNS=[{key:"pricePerTsubo",label:"坪単価",icon:"💰",format:v=>`${(v/1e4).toFixed(1)}万円`},{key:"accessToNagoya",label:"名古屋距離",icon:"🚃",format:v=>`${v}分`},{key:"total",label:"総合スコア",icon:"📊",format:v=>`${v}pt`,isScore:!0},{key:"residentialPrice",label:"住宅地価格",icon:"🏠",format:v=>`${(v/1e4).toFixed(1)}万/m²`},{key:"population",label:"人口",icon:"👥",format:v=>`${(v/1e4).toFixed(1)}万人`},{key:"popGrowthRate",label:"人口増減率",icon:"📈",format:v=>`${v>0?"+":""}${v}%`},{key:"yoyChange",label:"地価変動率",icon:"📉",format:v=>`+${v}%`},{key:"hospitals",label:"医療施設",icon:"🏥",format:v=>`${v}件`},{key:"schools",label:"学校数",icon:"🏫",format:v=>`${v}校`},{key:"parks",label:"公園数",icon:"🌳",format:v=>`${v}箇所`},{key:"shopping",label:"商業施設",icon:"🛒",format:v=>`${v}件`},{key:"price",label:"価格スコア",icon:"💎",format:v=>`${v}pt`,isScore:!0},{key:"access",label:"交通スコア",icon:"🚄",format:v=>`${v}pt`,isScore:!0},{key:"growth",label:"成長スコア",icon:"🌱",format:v=>`${v}pt`,isScore:!0},{key:"living",label:"利便スコア",icon:"🏪",format:v=>`${v}pt`,isScore:!0},{key:"family",label:"子育スコア",icon:"👶",format:v=>`${v}pt`,isScore:!0},{key:"nature",label:"自然スコア",icon:"🍃",format:v=>`${v}pt`,isScore:!0}],CMP_PRESETS={kosodate:{label:"🍼 子育て重視",cols:["pricePerTsubo","family","schools","parks","hospitals"]},tsuukin:{label:"🚃 通勤重視",cols:["accessToNagoya","access","pricePerTsubo","total"]},kakaku:{label:"💰 価格重視",cols:["pricePerTsubo","residentialPrice","yoyChange","price"]}};function getCmpVal(area,key){return["price","access","growth","living","family","nature","total"].includes(key)?area.scores[key]:area[key]}let mapInstance=null,mapMarkers={},txMarkerLayer=null,schoolDistrictLayer=null,schoolMarkerLayer=null,schoolDistrictData=null,showSchoolDistricts=!1,districtAreaLayer=null,showDistrictAreas=!1;function calcScores(area,w){const priceScore=100-(area.residentialPrice-2e4)/4e4*100,accessScore=(70-area.accessToNagoya)/70*100,growthScore=Math.min(100,Math.max(0,area.yoyChange/2*100)),livingScore=area.hospitals/45*25+area.schools/60*25+area.shopping/120*25+area.safetyScore/100*25,familyScore=(area.childcareScore+area.safetyScore+Math.min(100,area.parks/35*100))/3,natureScore=area.naturalScore,total=priceScore*(w.price/100)+accessScore*(w.access/100)+growthScore*(w.growth/100)+livingScore*(w.living/100)+familyScore*(w.family/100)+natureScore*(w.nature/100);return{price:Math.round(priceScore),access:Math.round(accessScore),growth:Math.round(growthScore),living:Math.round(livingScore),family:Math.round(familyScore),nature:Math.round(natureScore),total:Math.round(total)}}function getRankedAreas(){return AREAS.map(a=>({...a,scores:calcScores(a,state.weights)})).sort((a,b)=>b.scores.total-a.scores.total)}async function loadStaticData(){try{updateStatusText("キャッシュデータ読み込み中...");const res=await fetch("/data/live-data.json");if(!res.ok)throw new Error(`HTTP ${res.status}`);return applyStaticData(await res.json()),!0}catch(e){return console.log("Static data not available:",e.message),!1}}function applyStaticData(data){for(const area of AREAS){const src=data.areas[area.id];src&&(area._liveTransactions=src.transactions,area._liveAvgTradePrice=src.avgTradePrice,area._liveTransactionCount=src.transactionCount,AREA_FULL_LOADED.add(area.id))}state.mcpStatus="connected",state.fetchedAt=data.fetchedAt;let totalTx=0;AREAS.forEach(a=>{a._liveTransactions&&(totalTx+=a._liveTransactions.length)});const fetchDate=new Date(data.fetchedAt).toLocaleDateString("ja-JP");state.mcpMessage=`データ読込完了（${fetchDate}取得・計${totalTx.toLocaleString()}件）`,render(),"map"===state.view&&txMarkerLayer&&showAllTransactionPins()}let mcpReinfo=null;async function connectMCP(){state.mcpStatus="connecting",state.mcpMessage="MCPサーバーに接続中（プロキシ経由で試行）...",render();try{mcpReinfo=new MCPClient(CONFIG.MCP_REINFO,CONFIG.PROXY_URL),await mcpReinfo.initialize();const tools=await mcpReinfo.listTools();state.mcpStatus="connected",state.mcpMessage=`接続完了 — ${tools.length}個のツールが利用可能`,render(),await fetchLiveData(),fetchAllAreasData()}catch(e){state.mcpStatus="error",state.mcpMessage=`接続失敗: ${e.message}（キャッシュデータを使用中）`,render()}}function updateStatusText(msg){state.mcpMessage=msg;const el=document.getElementById("mcp-status-text");el&&(el.textContent=msg)}async function fetchLiveData(){if(mcpReinfo&&mcpReinfo.connected)try{updateStatusText("概要データを取得中...");const cityResult=await mcpReinfo.callTool("reinfolib-city-list",{area:"24"}),priceResults=[];for(const area of AREAS)try{updateStatusText(`${area.name} の概要データ取得中...`);const priceData=await mcpReinfo.callTool("reinfolib-real-estate-price",{year:"2024",area:"24",city:area.cityCode});priceResults.push({cityCode:area.cityCode,quarters:[priceData]})}catch(e){console.warn(`Overview fetch failed for ${area.name}:`,e),priceResults.push({cityCode:area.cityCode,quarters:[]})}state.mcpLiveData={cities:cityResult,prices:priceResults},updateAreasWithLiveData(priceResults);let totalTx=0;AREAS.forEach(a=>{a._liveTransactions&&(totalTx+=a._liveTransactions.length)}),state.mcpMessage=`概要データ取得完了（計${totalTx}件） — 詳細データを自動取得中...`,render()}catch(e){state.mcpMessage=`データ取得エラー: ${e.message}（キャッシュデータを使用中）`,render()}}const AREA_FULL_LOADED=new Set;let _currentFetchAreaId=null,_fetchPriorityAreaId=null,_autoFetchRunning=!1;async function fetchAreaFullData(areaId,options={}){if(!mcpReinfo||!mcpReinfo.connected)return;if(AREA_FULL_LOADED.has(areaId))return;if(_currentFetchAreaId===areaId)return;const area=AREAS.find(a=>a.id===areaId);if(!area)return;_currentFetchAreaId=areaId;const isSelected=state.mapSelectedAreaId===areaId,showOverlay=void 0!==options.showOverlay?options.showOverlay:isSelected;showOverlay&&showMapLoading(area.name,0);const yearQuarters=[{year:"2024",quarter:"4"},{year:"2024",quarter:"3"},{year:"2024",quarter:"2"},{year:"2024",quarter:"1"},{year:"2023",quarter:"4"},{year:"2023",quarter:"3"},{year:"2023",quarter:"2"},{year:"2023",quarter:"1"},{year:"2022",quarter:"4"},{year:"2022",quarter:"3"},{year:"2022",quarter:"2"},{year:"2022",quarter:"1"},{year:"2021",quarter:"4"},{year:"2021",quarter:"3"},{year:"2021",quarter:"2"},{year:"2021",quarter:"1"},{year:"2020",quarter:"4"},{year:"2020",quarter:"3"},{year:"2020",quarter:"2"},{year:"2020",quarter:"1"}],allData=[];let done=0;const total=yearQuarters.length;for(const yq of yearQuarters)try{done++;const pct=Math.round(done/total*100);showOverlay&&updateMapLoading(`${area.name} ${yq.year}年Q${yq.quarter}`,pct),updateStatusText(`${area.name} 詳細取得中... (${done}/${total})`);const priceData=await mcpReinfo.callTool("reinfolib-real-estate-price",{year:yq.year,quarter:yq.quarter,area:"24",city:area.cityCode});allData.push(priceData)}catch(e){console.warn(`Detail fetch failed for ${area.name} ${yq.year}Q${yq.quarter}:`,e)}updateAreasWithLiveData([{cityCode:area.cityCode,quarters:allData}]),AREA_FULL_LOADED.add(areaId),_currentFetchAreaId=null,showOverlay&&hideMapLoading();const txCount=area._liveTransactions?area._liveTransactions.length:0;if(updateStatusText(`${area.name}: 詳細データ取得完了（${txCount}件）`),"map"===state.view){const ranked=getRankedAreas(),rankedArea=ranked.find(a=>a.id===areaId);state.mapSelectedAreaId===areaId&&rankedArea&&updateMapSidebar(rankedArea,ranked),txMarkerLayer&&(await geocodeAreaDistricts(area,{showOverlay:showOverlay}),state.mapSelectedAreaId===areaId&&showTransactionPins(area))}geocodeDistrictsBackground().catch(e=>console.warn("Geocoding error:",e))}async function fetchAllAreasData(){if(_autoFetchRunning)return;if(!mcpReinfo||!mcpReinfo.connected)return;_autoFetchRunning=!0;const areaIds=AREAS.map(a=>a.id);let completedCount=AREA_FULL_LOADED.size;for(;;){let nextId=null;if(_fetchPriorityAreaId&&!AREA_FULL_LOADED.has(_fetchPriorityAreaId)&&(nextId=_fetchPriorityAreaId,_fetchPriorityAreaId=null),nextId||(nextId=areaIds.find(id=>!AREA_FULL_LOADED.has(id))),!nextId)break;const remaining=AREAS.length-AREA_FULL_LOADED.size;updateStatusText(`${AREAS.find(a=>a.id===nextId)?.name||nextId} 詳細取得中... （残り${remaining}エリア）`),await fetchAreaFullData(nextId),completedCount=AREA_FULL_LOADED.size}_autoFetchRunning=!1;let totalTx=0;if(AREAS.forEach(a=>{a._liveTransactions&&(totalTx+=a._liveTransactions.length)}),state.mcpMessage=`全エリアデータ取得完了（計${totalTx.toLocaleString()}件）`,updateStatusText(`全エリアデータ取得完了（計${totalTx.toLocaleString()}件）`),"map"===state.view&&txMarkerLayer&&!state.mapSelectedAreaId){showAllTransactionPins(getRankedAreas())}}function extractTransactionsFromMCPResponse(data){let content=data;if(content&&content.content&&(content=content.content),!Array.isArray(content)){if(content&&content.data&&Array.isArray(content.data))return console.log("[TX] Direct data array found:",content.data.length,"records"),content.data;if(content&&"string"==typeof content)try{const p=JSON.parse(content);if(p.data&&Array.isArray(p.data))return console.log("[TX] Parsed string data:",p.data.length,"records"),p.data}catch{}return console.warn("[TX] Content is not array:",typeof content,content?Object.keys(content):"null"),[]}const textContent=content.find(c=>"text"===c.type);if(!textContent)return console.warn("[TX] No text content found in array of",content.length,"elements"),[];try{const parsed=JSON.parse(textContent.text);if(parsed.data&&Array.isArray(parsed.data))return console.log("[TX] Extracted",parsed.data.length,"records from text content"),parsed.data;for(const key of Object.keys(parsed))if(Array.isArray(parsed[key])&&parsed[key].length>0)return console.log("[TX] Found array in key",key,":",parsed[key].length,"records"),parsed[key];console.warn("[TX] No data array found. Keys:",Object.keys(parsed))}catch(e){console.warn("[TX] JSON parse error:",e.message,"text:",textContent.text?.substring(0,200))}return[]}function updateAreasWithLiveData(priceResults){for(const result of priceResults){const area=AREAS.find(a=>a.cityCode===result.cityCode);if(!area)continue;const allRecords=[],sources=result.quarters||(result.data?[result.data]:[]);console.log(`[DATA] ${area.name}: ${sources.length} sources to process`);for(const src of sources){if(!src)continue;const records=extractTransactionsFromMCPResponse(src);allRecords.push(...records)}if(console.log(`[DATA] ${area.name}: ${allRecords.length} total records from all sources`),0===allRecords.length)continue;const seen=new Set,uniqueRecords=allRecords.filter(d=>{const key=[d.TradePrice||"",d.DistrictName||d.Region||"",d.Area||"",d.Period||"",d.Type||d.TradeType||"",d.BuildingYear||"",d.NearestStation||"",d.FloorPlan||"",d.Structure||""].join("|");return!seen.has(key)&&(seen.add(key),!0)});console.log(`[DATA] ${area.name}: ${uniqueRecords.length} unique records after dedup (removed ${allRecords.length-uniqueRecords.length})`),uniqueRecords.length>0&&console.log(`[DATA] ${area.name}: Sample record keys:`,Object.keys(uniqueRecords[0])),area._liveTransactions=uniqueRecords.map(d=>({TradePrice:null!=d.TradePrice&&""!==d.TradePrice?parseInt(d.TradePrice):null,Type:d.Type||d.TradeType||"",Area:d.Area?parseFloat(d.Area):null,FloorPlan:d.FloorPlan||"",BuildingYear:d.BuildingYear||"",NearestStation:d.NearestStation||"",DistanceToStation:d.TimeToNearestStation||d.DistanceToStation||"",Use:d.Use||d.Purpose||"",District:d.DistrictName||d.Region||"",Structure:d.Structure||"",CityPlanning:d.CityPlanning||"",Period:d.Period||""})),console.log(`[DATA] ${area.name}: Final _liveTransactions count = ${area._liveTransactions.length}`);const prices=uniqueRecords.filter(d=>null!=d.TradePrice&&""!==d.TradePrice).map(d=>parseInt(d.TradePrice)).filter(p=>!isNaN(p));prices.length>0&&(area._liveAvgTradePrice=Math.round(prices.reduce((a,b)=>a+b,0)/prices.length),area._liveTransactionCount=uniqueRecords.length)}}const _loadedLibs={};function loadLib(url,type){return _loadedLibs[url]||(_loadedLibs[url]=new Promise((resolve,reject)=>{const el="css"===type?Object.assign(document.createElement("link"),{rel:"stylesheet",href:url}):Object.assign(document.createElement("script"),{src:url});el.onload=resolve,el.onerror=reject,document.head.appendChild(el)})),_loadedLibs[url]}async function ensureChartJs(){window.Chart||await loadLib("https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js","js")}async function ensureLeaflet(){window.L||(await loadLib("https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css","css"),await loadLib("https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js","js"))}function render(){const app=document.getElementById("app"),ranked=getRankedAreas(),isDetailCompat=(state.selectedAreaId?ranked.find(a=>a.id===state.selectedAreaId):ranked[0],"detail"===state.view),effectiveView=isDetailCompat?"ranking":state.view;app.innerHTML=`\n    ${renderHeader()}\n    <div class="max-w-6xl mx-auto px-4 py-6">\n      ${renderWeights()}\n      ${"ranking"===effectiveView?renderRanking(ranked):""}\n      ${"compare"===effectiveView?renderCompare(ranked):""}\n      ${"map"===effectiveView?renderMap(ranked):""}\n      \n      \n    <div class="card p-6 mb-6" id="cost-simulator">\n      <h2 class="text-lg font-bold text-gray-800 mb-1">💰 注文住宅 費用シミュレーター</h2>\n      <p class="text-xs text-gray-500 mb-4">スライダーを動かすと即時に再計算されます。土地価格は国土交通省の実取引データに基づく坪単価を使用しています。</p>\n      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">\n        <div>\n        <label class="text-sm font-medium text-gray-700">エリア選択</label>\n        <select id="cs-area" class="w-full mt-1 px-3 py-2 border border-gray-200 rounded-lg text-sm" onchange="csCalc()">\n          <option value="yokkaichi">四日市市</option><option value="kuwana">桑名市</option><option value="suzuka">鈴鹿市</option><option value="inabe">いなべ市</option><option value="kameyama">亀山市</option><option value="komono">菰野町</option><option value="toin">東員町</option>\n        </select>\n      </div>\n        <div>\n          <label class="text-sm font-medium text-gray-700">土地面積: <span id="cs-land-val">50</span>坪</label>\n          <input type="range" id="cs-land" min="30" max="100" value="50" step="5" class="w-full cursor-pointer mt-1" oninput="csCalc()" style="background:linear-gradient(to right,#3b82f6 0%,#3b82f6 29%,#e5e7eb 29%,#e5e7eb 100%)">\n          <div class="flex justify-between text-xs text-gray-400"><span>30坪</span><span>100坪</span></div>\n        </div>\n        <div>\n          <label class="text-sm font-medium text-gray-700">建物延床面積: <span id="cs-building-val">35</span>坪</label>\n          <input type="range" id="cs-building" min="20" max="60" value="35" step="1" class="w-full cursor-pointer mt-1" oninput="csCalc()" style="background:linear-gradient(to right,#3b82f6 0%,#3b82f6 38%,#e5e7eb 38%,#e5e7eb 100%)">\n          <div class="flex justify-between text-xs text-gray-400"><span>20坪</span><span>60坪</span></div>\n        </div>\n        <div>\n          <label class="text-sm font-medium text-gray-700">建築グレード</label>\n          <div class="flex gap-2 mt-1">\n            <label class="flex-1 text-center px-2 py-2 border rounded-lg cursor-pointer text-xs transition-all" id="cs-grade-low-label">\n              <input type="radio" name="cs-grade" value="50" class="hidden" onchange="csCalc()"> ローコスト<br><span class="font-bold">50万/坪</span>\n            </label>\n            <label class="flex-1 text-center px-2 py-2 border rounded-lg cursor-pointer text-xs transition-all border-blue-500 bg-blue-50" id="cs-grade-std-label">\n              <input type="radio" name="cs-grade" value="65" class="hidden" checked onchange="csCalc()"> スタンダード<br><span class="font-bold">65万/坪</span>\n            </label>\n            <label class="flex-1 text-center px-2 py-2 border rounded-lg cursor-pointer text-xs transition-all" id="cs-grade-hi-label">\n              <input type="radio" name="cs-grade" value="85" class="hidden" onchange="csCalc()"> ハイグレード<br><span class="font-bold">85万/坪</span>\n            </label>\n          </div>\n        </div>\n        <div>\n          <label class="text-sm font-medium text-gray-700">頭金: <span id="cs-down-val">300</span>万円</label>\n          <input type="range" id="cs-down" min="0" max="2000" value="300" step="50" class="w-full cursor-pointer mt-1" oninput="csCalc()" style="background:linear-gradient(to right,#10b981 0%,#10b981 15%,#e5e7eb 15%,#e5e7eb 100%)">\n          <div class="flex justify-between text-xs text-gray-400"><span>0万</span><span>2,000万</span></div>\n        </div>\n        <div>\n          <label class="text-sm font-medium text-gray-700">金利: <span id="cs-rate-val">0.80</span>%</label>\n          <input type="range" id="cs-rate" min="0.3" max="3.0" value="0.8" step="0.05" class="w-full cursor-pointer mt-1" oninput="csCalc()">\n          <div class="flex justify-between text-xs text-gray-400"><span>0.3%</span><span>3.0%</span></div>\n        </div>\n        <div>\n          <label class="text-sm font-medium text-gray-700">ローン期間: <span id="cs-years-val">35</span>年</label>\n          <input type="range" id="cs-years" min="20" max="40" value="35" step="1" class="w-full cursor-pointer mt-1" oninput="csCalc()">\n          <div class="flex justify-between text-xs text-gray-400"><span>20年</span><span>40年</span></div>\n        </div>\n      </div>\n      <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-3" id="cs-results">\n        <div class="bg-blue-50 rounded-lg p-3 text-center">\n          <div class="text-xs text-gray-500">土地購入費</div>\n          <div class="text-lg font-bold text-blue-700" id="cs-land-cost">-</div>\n        </div>\n        <div class="bg-green-50 rounded-lg p-3 text-center">\n          <div class="text-xs text-gray-500">建築費</div>\n          <div class="text-lg font-bold text-green-700" id="cs-build-cost">-</div>\n        </div>\n        <div class="bg-amber-50 rounded-lg p-3 text-center">\n          <div class="text-xs text-gray-500">諸費用</div>\n          <div class="text-lg font-bold text-amber-700" id="cs-misc-cost">-</div>\n        </div>\n        <div class="bg-purple-50 rounded-lg p-3 text-center">\n          <div class="text-xs text-gray-500 font-medium">総額</div>\n          <div class="text-xl font-bold text-gray-900" id="cs-total">-</div>\n        </div>\n      </div>\n      <div class="bg-gray-50 rounded-lg p-3 text-center">\n        <span class="text-xs text-gray-500">月々返済額（元利均等）</span>\n        <span class="text-lg font-bold text-blue-600 ml-2" id="cs-monthly">-</span>\n      </div>\n    </div>\n      \n    <div class="card p-6 mb-6" id="city-pages">\n      <h2 class="text-lg font-bold text-gray-800 mb-2">📍 市区町村別 注文住宅ガイド</h2>\n      <p class="text-xs text-gray-500 mb-4">各市の詳細な土地相場・費用シミュレーション・取引データをご覧いただけます</p>\n      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">\n        \n            <a href="/area/mie/yokkaichi/" class="block p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-all group">\n              <div class="text-base font-bold text-gray-800 group-hover:text-blue-700">四日市市</div>\n              <div class="text-xs text-gray-500 mt-1">四日市市で注文住宅を検討中の方へ。土地相場（坪単価18.8万円〜）、名古屋35分のアクセス、費用シミュレーション、実取引...</div>\n            </a>\n            <a href="/area/mie/kuwana/" class="block p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-all group">\n              <div class="text-base font-bold text-gray-800 group-hover:text-blue-700">桑名市</div>\n              <div class="text-xs text-gray-500 mt-1">桑名市で注文住宅を検討中の方へ。名古屋25分の好アクセス、土地相場（坪18.4万円〜）、費用シミュレーション、水害リスク...</div>\n            </a>\n            <a href="/area/mie/suzuka/" class="block p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-all group">\n              <div class="text-base font-bold text-gray-800 group-hover:text-blue-700">鈴鹿市</div>\n              <div class="text-xs text-gray-500 mt-1">鈴鹿市で注文住宅を検討中の方へ。手頃な土地相場（坪13.6万円〜）で広い家が建てやすい。費用シミュレーション・実取引デー...</div>\n            </a>\n            <a href="/area/mie/inabe/" class="block p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-all group">\n              <div class="text-base font-bold text-gray-800 group-hover:text-blue-700">いなべ市</div>\n              <div class="text-xs text-gray-500 mt-1">いなべ市で注文住宅を検討中の方へ。県北部最安の土地相場（坪8.1万円〜）、移住支援制度、費用シミュレーション、自然豊かな...</div>\n            </a>\n            <a href="/area/mie/kameyama/" class="block p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-all group">\n              <div class="text-base font-bold text-gray-800 group-hover:text-blue-700">亀山市</div>\n              <div class="text-xs text-gray-500 mt-1">亀山市で注文住宅を検討中の方へ。交通の要衝で車通勤に便利、手頃な土地相場（坪9.8万円〜）、費用シミュレーション・取引デ...</div>\n            </a>\n            <a href="/area/mie/komono/" class="block p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-all group">\n              <div class="text-base font-bold text-gray-800 group-hover:text-blue-700">菰野町</div>\n              <div class="text-xs text-gray-500 mt-1">菰野町で注文住宅を検討中の方へ。温泉と自然に囲まれた人気の住環境、土地相場（坪10.3万円〜）、費用シミュレーション・取...</div>\n            </a>\n            <a href="/area/mie/toin/" class="block p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-all group">\n              <div class="text-base font-bold text-gray-800 group-hover:text-blue-700">東員町</div>\n              <div class="text-xs text-gray-500 mt-1">東員町で注文住宅を検討中の方へ。人口増加中の子育てしやすい街、土地相場（坪11.7万円〜）、費用シミュレーション・取引デ...</div>\n            </a>\n      </div>\n    </div>\n      \n      <div class="card p-5 mb-6">\n        <h2 class="text-base font-bold text-gray-800 mb-3">📖 三重県の注文住宅ガイド</h2>\n        <p class="text-xs text-gray-400 mb-3">タップで詳しく見る</p>\n        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:14px;">\n          <button class="guide-card" onclick="openGuideModal(0)"><span class="guide-card-icon">🏡</span><span class="guide-card-title">三重県が選ばれる理由</span><span class="guide-card-desc">名古屋通勤圏で土地が安い</span></button>\n          <button class="guide-card" onclick="openGuideModal(1)"><span class="guide-card-icon">📍</span><span class="guide-card-title">エリア別の土地相場</span><span class="guide-card-desc">7エリアの特徴を比較</span></button>\n          <button class="guide-card" onclick="openGuideModal(2)"><span class="guide-card-icon">💰</span><span class="guide-card-title">費用相場とローン</span><span class="guide-card-desc">総額2,800〜4,200万円</span></button>\n          <button class="guide-card" onclick="openGuideModal(3)"><span class="guide-card-icon">🚃</span><span class="guide-card-title">通勤・子育て環境</span><span class="guide-card-desc">名古屋25〜50分</span></button>\n          <button class="guide-card" onclick="openGuideModal(4)"><span class="guide-card-icon">📋</span><span class="guide-card-title">家づくりの進め方</span><span class="guide-card-desc">12〜18ヶ月の流れ</span></button>\n          <button class="guide-card" onclick="openGuideModal(5)"><span class="guide-card-icon">🔧</span><span class="guide-card-title">住宅性能の選び方</span><span class="guide-card-desc">断熱・耐震のポイント</span></button>\n        </div>\n        <div style="text-align:center;padding-top:10px;border-top:1px solid #f3f4f6;line-height:1.8;">\n          <span style="font-size:0.78rem;color:#9ca3af;">関連記事: </span>\n          <a href="/knowledge/cost/" class="text-xs text-blue-600 hover:underline">費用内訳</a> <span style="color:#e5e7eb;">|</span>\n          <a href="/knowledge/flow/" class="text-xs text-blue-600 hover:underline">家づくりの流れ</a> <span style="color:#e5e7eb;">|</span>\n          <a href="/knowledge/housing-loan/" class="text-xs text-blue-600 hover:underline">住宅ローン</a> <span style="color:#e5e7eb;">|</span>\n          <a href="/knowledge/land-selection/" class="text-xs text-blue-600 hover:underline">土地探し</a> <span style="color:#e5e7eb;">|</span>\n          <a href="/knowledge/builder-comparison/" class="text-xs text-blue-600 hover:underline">建築会社選び</a> <span style="color:#e5e7eb;">|</span>\n          <a href="/knowledge/" class="text-xs text-blue-600 hover:underline font-medium">全19記事 →</a>\n        </div>\n      </div>\n      <div class="card p-6 mb-6">\n        <h2 class="text-lg font-bold text-gray-800 mb-4">❓ よくある質問</h2>\n        <div class="space-y-2">\n          <div class="border border-gray-200 rounded-lg overflow-hidden">\n            <button class="w-full text-left px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors" onclick="this.parentElement.classList.toggle('faq-open')">\n              <span class="text-sm font-medium text-gray-800">注文住宅と建売住宅、どちらが向いている？</span>\n              <svg class="w-5 h-5 text-gray-400 faq-chevron transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>\n            </button>\n            <div class="faq-answer px-4 py-3 text-sm text-gray-600 leading-relaxed border-t border-gray-100">間取り・外観・性能を自由に決めたい方は注文住宅がおすすめ。三重県は土地が安いため、注文住宅でも建売と同程度の総額に抑えやすいのが特徴です。一方、すぐ入居したい・手間を省きたい方には建売住宅が向いています。</div>\n          </div>\n          <div class="border border-gray-200 rounded-lg overflow-hidden">\n            <button class="w-full text-left px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors" onclick="this.parentElement.classList.toggle('faq-open')">\n              <span class="text-sm font-medium text-gray-800">三重県で使える住宅補助金はありますか？</span>\n              <svg class="w-5 h-5 text-gray-400 faq-chevron transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>\n            </button>\n            <div class="faq-answer px-4 py-3 text-sm text-gray-600 leading-relaxed border-t border-gray-100">2026年はみらいエコ住宅2026事業（最大125万円）、住宅ローン控除（最大455万円）、給湯省エネ2026事業（最大17万円）等が利用可能。桑名市の移住補助金（最大100万円）など自治体独自の制度もあります。<a href="/knowledge/subsidy-2026/" style="color:#2563eb;">詳しくはこちら →</a></div>\n          </div>\n          <div class="border border-gray-200 rounded-lg overflow-hidden">\n            <button class="w-full text-left px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors" onclick="this.parentElement.classList.toggle('faq-open')">\n              <span class="text-sm font-medium text-gray-800">ハウスメーカーと工務店、どちらを選ぶべき？</span>\n              <svg class="w-5 h-5 text-gray-400 faq-chevron transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>\n            </button>\n            <div class="faq-answer px-4 py-3 text-sm text-gray-600 leading-relaxed border-t border-gray-100">ハウスメーカーは品質の安定感と保証が強み、工務店は自由度と価格の柔軟性が特徴。三重県では地元工務店の坪単価50〜65万円に対し、大手ハウスメーカーは70〜90万円が相場。必ず3社以上の相見積もりで比較しましょう。<a href="/knowledge/builder-comparison/" style="color:#2563eb;">詳しくはこちら →</a></div>\n          </div>\n        </div>\n      </div>\n      \n    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 mb-6 text-center">\n      <h3 class="text-base font-bold text-gray-800 mb-2">具体的な物件が見つかったら...</h3>\n      <p class="text-sm text-gray-600 mb-4">AIが複数物件を自動比較。SUUMO・ホームズ等のURLを貼るだけで、見やすい比較表を作成します。</p>\n      <a href="/" class="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors shadow-sm">\n        🏠 注文住宅比較.comを使う →\n      </a>\n    </div>\n      \n    <div class="card p-4 mb-6">\n      <div class="flex items-center justify-center gap-3 flex-wrap">\n        <span class="text-xs text-gray-500">このページをシェア:</span>\n        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fresearch.chuumon-soudan.com%2Farea%2Fmie%2F&text=%E4%B8%89%E9%87%8D%E7%9C%8C%E3%81%A7%E6%B3%A8%E6%96%87%E4%BD%8F%E5%AE%85%E3%82%92%E5%BB%BA%E3%81%A6%E3%82%8B%E3%81%AA%E3%82%89%EF%BD%9C%E3%82%A8%E3%83%AA%E3%82%A2%E5%88%A5%20%E5%9C%9F%E5%9C%B0%E7%9B%B8%E5%A0%B4%E3%83%BB%E8%B2%BB%E7%94%A8%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BF%E3%83%BC" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:4px;padding:6px 14px;background:#000;color:white;border-radius:6px;font-size:12px;font-weight:500;text-decoration:none;">𝕏 ポスト</a>\n        <a href="https://social-plugins.line.me/lineit/share?url=https%3A%2F%2Fresearch.chuumon-soudan.com%2Farea%2Fmie%2F" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:4px;padding:6px 14px;background:#06c755;color:white;border-radius:6px;font-size:12px;font-weight:500;text-decoration:none;">LINE 送る</a>\n        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fresearch.chuumon-soudan.com%2Farea%2Fmie%2F" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:4px;padding:6px 14px;background:#1877f2;color:white;border-radius:6px;font-size:12px;font-weight:500;text-decoration:none;">Facebook</a>\n      </div>\n    </div>\n      ${renderFooter()}\n    </div>\n  `,bindEvents(ranked),requestAnimationFrame(()=>{"compare"===effectiveView&&ensureChartJs().then(()=>drawCompareCharts(ranked)),"map"===effectiveView&&setTimeout(()=>{ensureLeaflet().then(()=>{if(initializeMap(ranked),state.mapSelectedAreaId){const selArea=ranked.find(a=>a.id===state.mapSelectedAreaId);selArea&&updateMapSidebar(selArea,ranked)}})},50),isDetailCompat&&state.selectedAreaId&&(state.view="ranking",openCmpDetailModal(state.selectedAreaId))})}function renderHeader(){const tabs=[{id:"ranking",label:"🏆 ランキング"},{id:"compare",label:"📊 比較"},{id:"map",label:"🗺️ 地図"}];tabs.find(t=>t.id===state.view)||tabs[0];return`\n    \x3c!-- 共通ヘッダー --\x3e\n    <div style="background:white;border-bottom:1px solid #e5e7eb;padding:10px 16px;">\n      <div style="max-width:72rem;margin:0 auto;display:flex;align-items:center;justify-content:space-between;">\n        <a href="/" style="text-decoration:none;display:flex;align-items:center;">\n          <picture>\n            <source srcset="/images/header-banner.webp" type="image/webp">\n            <img src="/images/header-banner.png" alt="注文住宅比較.com - 絶対に後悔しない家づくり" style="height:56px;width:auto;">\n          </picture>\n        </a>\n        <div id="global-nav-links" style="display:flex;align-items:center;gap:16px;font-size:13px;">\n          <a href="/" style="color:#6b7280;text-decoration:none;font-weight:500;">物件比較</a>\n          <span style="color:#2563EB;font-weight:600;">エリア比較</span>\n          <a href="/knowledge/" style="color:#6b7280;text-decoration:none;font-weight:500;">知識</a>\n          <a href="/about/" style="color:#6b7280;text-decoration:none;font-weight:500;">運営者情報</a>\n        </div>\n      </div>\n    </div>\n    <nav class="flex items-center gap-1 flex-wrap px-4 py-2 text-xs text-gray-400" aria-label="パンくずリスト"><a href="/" class="text-sm text-blue-600 hover:underline">トップ</a> <span class="mx-1">/</span> <span class="text-sm text-gray-600">三重県エリア比較</span></nav>\n    \x3c!-- タイトル（スクロールで消える） --\x3e\n    <header class="glass border-b border-gray-200">\n      <div class="max-w-6xl mx-auto px-4 py-4">\n        <div class="flex items-center justify-between">\n          <div>\n            <h1 class="text-2xl font-bold text-gray-900 mobile-title-text">🏠 三重県 注文住宅エリア比較</h1>\n            <p class="text-sm text-gray-500 mt-1 mobile-subtitle-text">三重県北部の土地相場・取引データを比較して、注文住宅に最適なエリアを見つけよう</p>\n        <div style="display:flex;flex-wrap:wrap;gap:8px;margin-top:6px;">\n          <span style="font-size:11px;color:#6b7280;background:#f3f4f6;padding:2px 8px;border-radius:4px;">📊 データ出典: <a href="https://www.reinfolib.mlit.go.jp/" style="color:#3b82f6;text-decoration:none;" rel="noopener">国土交通省 不動産情報ライブラリ</a></span>\n          <span style="font-size:11px;color:#6b7280;background:#f3f4f6;padding:2px 8px;border-radius:4px;">✏️ 監修: <a href="/about/" style="color:#3b82f6;text-decoration:none;" rel="noopener">注文住宅比較.com</a> 編集部</span>\n          <span style="font-size:11px;color:#6b7280;background:#f3f4f6;padding:2px 8px;border-radius:4px;">🕐 最終更新: 2026-02-24</span>\n        </div>\n            <a href="index.html" style="display:inline-block;margin-top:6px;font-size:13px;color:#3b82f6;font-weight:500;text-decoration:none;">🏠 注文住宅比較.comで物件を比較する →</a>\n            ${"connected"===state.mcpStatus?(()=>{let totalTx=0;AREAS.forEach(a=>{a._liveTransactions&&(totalTx+=a._liveTransactions.length)});const dateStr=state.fetchedAt?new Date(state.fetchedAt).toLocaleDateString("ja-JP"):"";return`<p class="text-xs text-green-600 mt-1">📊 取引データ ${totalTx.toLocaleString()}件${dateStr?`（${dateStr} 更新）`:""}</p>`})():"connecting"===state.mcpStatus?'<p class="text-xs text-blue-500 mt-1">⏳ データ読み込み中...</p>':""}\n          </div>\n        </div>\n      </div>\n    </header>\n    \x3c!-- タブバー（PCのみ表示） --\x3e\n    <nav id="pc-nav-bar" class="sticky top-0 z-50 bg-white/95 backdrop-blur border-b border-gray-200 shadow-sm">\n      <div class="max-w-6xl mx-auto px-4 py-2">\n        <div class="flex gap-2">\n          ${tabs.map(t=>`\n            <button data-tab="${t.id}" class="px-4 py-2 rounded-lg text-sm font-medium transition-all ${state.view===t.id?"tab-active":"bg-gray-100 text-gray-600 hover:bg-gray-200"}">\n              ${t.label}\n            </button>\n          `).join("")}\n        </div>\n      </div>\n    </nav>\n    \x3c!-- モバイル: 右上固定ハンバーガーボタン --\x3e\n    <button id="mobile-menu-fab" onclick="openMobileDrawer()" style="display:none;position:fixed;top:12px;right:12px;z-index:60;width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,0.92);backdrop-filter:blur(8px);box-shadow:0 2px 8px rgba(0,0,0,0.15);border:1px solid #e5e7eb;font-size:18px;color:#374151;cursor:pointer;" aria-label="メニューを開く">\n      ☰\n    </button>\n    \x3c!-- モバイル: 右サイドドロワー --\x3e\n    <div id="mobile-drawer-overlay" style="display:none;position:fixed;inset:0;z-index:70;background:rgba(0,0,0,0.4);opacity:0;transition:opacity 0.3s;" onclick="closeMobileDrawer()"></div>\n    <div id="mobile-drawer-panel" style="display:none;position:fixed;top:0;right:0;z-index:80;height:100%;width:260px;background:#fff;box-shadow:-4px 0 20px rgba(0,0,0,0.15);transform:translateX(100%);transition:transform 0.3s ease-out;">\n      <div style="padding:16px;border-bottom:1px solid #e5e7eb;display:flex;align-items:center;justify-content:space-between;">\n        <span style="font-size:14px;font-weight:700;color:#1f2937;">メニュー</span>\n        <button onclick="closeMobileDrawer()" style="width:32px;height:32px;border-radius:50%;background:#f3f4f6;border:none;display:flex;align-items:center;justify-content:center;color:#6b7280;font-size:20px;cursor:pointer;">&times;</button>\n      </div>\n      <div style="padding:16px;display:flex;flex-direction:column;gap:8px;">\n        ${tabs.map(t=>`\n          <button data-tab="${t.id}" onclick="closeMobileDrawer()" class="${state.view===t.id?"tab-active":""}" style="width:100%;text-align:left;padding:12px 16px;border-radius:8px;font-size:14px;font-weight:500;border:none;cursor:pointer;transition:background 0.2s;${state.view===t.id?"":"background:#f9fafb;color:#4b5563;"}">\n            ${t.label}\n          </button>\n        `).join("")}\n      </div>\n      \x3c!-- グローバルナビ --\x3e\n      <div style="padding:0 16px 16px;border-top:1px solid #e5e7eb;margin-top:8px;">\n        <div style="font-size:11px;font-weight:600;color:#9ca3af;margin:12px 0 8px;letter-spacing:0.05em;">サイトメニュー</div>\n        <div style="display:flex;flex-direction:column;gap:6px;">\n          <a href="/" style="display:block;padding:10px 16px;border-radius:8px;font-size:13px;font-weight:500;background:#f9fafb;color:#4b5563;text-decoration:none;">物件比較</a>\n          <span style="display:block;padding:10px 16px;border-radius:8px;font-size:13px;font-weight:600;background:#dbeafe;color:#1d4ed8;">エリア比較</span>\n          <a href="/knowledge/" style="display:block;padding:10px 16px;border-radius:8px;font-size:13px;font-weight:500;background:#f9fafb;color:#4b5563;text-decoration:none;">知識</a>\n          <a href="/about/" style="display:block;padding:10px 16px;border-radius:8px;font-size:13px;font-weight:500;background:#f9fafb;color:#4b5563;text-decoration:none;">運営者情報</a>\n        </div>\n      <div style="border-top:1px solid #e5e7eb;padding-top:8px;margin-top:8px;">\n          <div style="font-size:11px;color:#9ca3af;padding:0 16px 4px;">エリア別ガイド</div>\n          <a href="/area/mie/yokkaichi/" style="width:100%;text-align:left;padding:8px 16px;border-radius:8px;font-size:13px;background:#f0f9ff;color:#1e40af;border:none;text-decoration:none;display:block;">四日市市</a>\n          <a href="/area/mie/kuwana/" style="width:100%;text-align:left;padding:8px 16px;border-radius:8px;font-size:13px;background:#f0f9ff;color:#1e40af;border:none;text-decoration:none;display:block;">桑名市</a>\n          <a href="/area/mie/suzuka/" style="width:100%;text-align:left;padding:8px 16px;border-radius:8px;font-size:13px;background:#f0f9ff;color:#1e40af;border:none;text-decoration:none;display:block;">鈴鹿市</a>\n          <a href="/area/mie/inabe/" style="width:100%;text-align:left;padding:8px 16px;border-radius:8px;font-size:13px;background:#f0f9ff;color:#1e40af;border:none;text-decoration:none;display:block;">いなべ市</a>\n          <a href="/area/mie/kameyama/" style="width:100%;text-align:left;padding:8px 16px;border-radius:8px;font-size:13px;background:#f0f9ff;color:#1e40af;border:none;text-decoration:none;display:block;">亀山市</a>\n          <a href="/area/mie/komono/" style="width:100%;text-align:left;padding:8px 16px;border-radius:8px;font-size:13px;background:#f0f9ff;color:#1e40af;border:none;text-decoration:none;display:block;">菰野町</a>\n          <a href="/area/mie/toin/" style="width:100%;text-align:left;padding:8px 16px;border-radius:8px;font-size:13px;background:#f0f9ff;color:#1e40af;border:none;text-decoration:none;display:block;">東員町</a>\n        </div>\n      </div>\n    </div>\n  `}function openMobileDrawer(){const overlay=document.getElementById("mobile-drawer-overlay"),panel=document.getElementById("mobile-drawer-panel");overlay&&panel&&(overlay.style.opacity="1",overlay.style.pointerEvents="auto",panel.style.transform="translateX(0)",document.body.style.overflow="hidden")}function closeMobileDrawer(){const overlay=document.getElementById("mobile-drawer-overlay"),panel=document.getElementById("mobile-drawer-panel");overlay&&panel&&(overlay.style.opacity="0",overlay.style.pointerEvents="none",panel.style.transform="translateX(100%)",document.body.style.overflow="")}function renderMCPStatus(){const s={disconnected:{bg:"bg-gray-100",text:"text-gray-600",dot:"bg-gray-400"},connecting:{bg:"bg-blue-50",text:"text-blue-700",dot:"bg-blue-500"},connected:{bg:"bg-green-50",text:"text-green-700",dot:"bg-green-500"},error:{bg:"bg-amber-50",text:"text-amber-700",dot:"bg-amber-500"}}[state.mcpStatus],statusLabel={disconnected:"未接続",connecting:"取得中",connected:"データ取得済",error:"フォールバック"}[state.mcpStatus];return`\n    <div class="card p-4 mb-4 flex items-center justify-between flex-wrap gap-3">\n      <div class="flex items-center gap-3">\n        <div class="status-badge ${s.bg} ${s.text}">\n          <span class="pulse-dot ${s.dot}"></span>\n          ${statusLabel}\n        </div>\n        <span id="mcp-status-text" class="text-sm text-gray-500">${state.mcpMessage||"データ読み込み中..."}</span>\n      </div>\n      <div class="flex gap-2">\n        ${"connected"===state.mcpStatus?'\n          <button id="btn-connect-mcp" class="px-3 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors shadow-sm">\n            🔄 最新データ取得\n          </button>\n        ':"connecting"===state.mcpStatus?'\n          <span class="text-xs text-blue-600 self-center">取得中...</span>\n        ':'\n          <button id="btn-connect-mcp" class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors shadow-sm">\n            🔌 MCPサーバーに接続\n          </button>\n        '}\n      </div>\n    </div>\n  `}function renderWeights(){if("map"===state.view)return"";const activePreset=Object.entries(WEIGHT_PRESETS).find(([k,p])=>Object.entries(p.weights).every(([wk,wv])=>state.weights[wk]===wv));return`\n    <div class="card p-4 mb-6">\n      <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;">\n        <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">\n          <span style="font-size:14px;font-weight:700;color:#1f2937;">🎯 優先度</span>\n          ${Object.entries(WEIGHT_PRESETS).map(([k,p])=>`\n            <button data-weight-preset="${k}" style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;border:1.5px solid ${activePreset&&activePreset[0]===k?"#3b82f6":"#e5e7eb"};background:${activePreset&&activePreset[0]===k?"#eff6ff":"#fff"};color:${activePreset&&activePreset[0]===k?"#2563eb":"#6b7280"};cursor:pointer;transition:all 0.2s;white-space:nowrap;">\n              ${p.label}\n            </button>\n          `).join("")}\n        </div>\n        <button id="weights-toggle" style="display:flex;align-items:center;gap:4px;padding:6px 12px;border-radius:8px;font-size:12px;font-weight:500;color:#6b7280;background:#f9fafb;border:1px solid #e5e7eb;cursor:pointer;transition:all 0.2s;white-space:nowrap;">\n          ⚙️ カスタマイズ\n          <svg style="width:12px;height:12px;transition:transform 0.3s;${state.weightsExpanded?"transform:rotate(180deg);":""}" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>\n        </button>\n      </div>\n      <div id="weights-sliders" style="overflow:hidden;max-height:${state.weightsExpanded?"300px":"0"};opacity:${state.weightsExpanded?"1":"0"};transition:max-height 0.35s ease, opacity 0.3s ease;margin-top:${state.weightsExpanded?"16px":"0"};">\n        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">\n          ${[{key:"price",label:"価格の手頃さ",icon:"💰"},{key:"access",label:"名古屋アクセス",icon:"🚃"},{key:"growth",label:"資産価値上昇",icon:"📈"},{key:"living",label:"生活利便性",icon:"🏪"},{key:"family",label:"子育て環境",icon:"👨‍👩‍👧‍👦"},{key:"nature",label:"自然環境",icon:"🌿"}].map(i=>`\n            <div class="flex items-center gap-3">\n              <span class="text-xl w-8 text-center">${i.icon}</span>\n              <div class="flex-1">\n                <div class="flex justify-between mb-1">\n                  <span class="text-sm font-medium text-gray-700">${i.label}</span>\n                  <span class="text-sm font-bold text-blue-600" id="wv-${i.key}">${state.weights[i.key]}</span>\n                </div>\n                <input type="range" min="0" max="50" value="${state.weights[i.key]}" data-weight="${i.key}"\n                  class="w-full cursor-pointer" style="background: linear-gradient(to right, #3b82f6 0%, #3b82f6 ${2*state.weights[i.key]}%, #e5e7eb ${2*state.weights[i.key]}%, #e5e7eb 100%);">\n              </div>\n            </div>\n          `).join("")}\n        </div>\n      </div>\n    </div>\n  `}function renderRanking(ranked){const medals=["medal-gold","medal-silver","medal-bronze"],scoreKeys=[{key:"price",label:"価格"},{key:"access",label:"交通"},{key:"growth",label:"成長"},{key:"living",label:"利便"},{key:"family",label:"子育"},{key:"nature",label:"自然"}];return`\n    <div class="space-y-4 fade-in">\n      <h2 class="text-lg font-bold text-gray-800">🏆 おすすめエリアランキング</h2>\n      ${ranked.map((a,idx)=>`\n        <div class="card p-5 cursor-pointer" data-area-detail="${a.id}">\n          <div class="flex items-start gap-4">\n            <div class="flex-shrink-0 flex flex-col items-center w-16">\n              <div class="w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-lg ${idx<3?medals[idx]:"bg-slate-400"}">\n                ${idx+1}\n              </div>\n              <div class="text-2xl font-bold text-blue-600 mt-1">${a.scores.total}<span class="text-xs text-gray-400 font-normal">pt</span></div>\n            </div>\n            <div class="flex-1 min-w-0">\n              <div class="flex items-center gap-2 mb-1">\n                <h3 class="text-xl font-bold text-gray-900">${a.name}</h3>\n                ${a.popGrowthRate>0?'<span class="px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full font-medium">人口増加中</span>':""}\n                ${a._liveTransactionCount?`<span class="px-2 py-0.5 bg-blue-100 text-blue-700 text-xs rounded-full font-medium">LIVE ${a._liveTransactionCount}件</span>`:""}\n              </div>\n              <p class="text-sm text-gray-600 mb-2">${a.description}</p>\n              <a href="/area/mie/${a.id}/" class="inline-block text-xs text-blue-600 hover:underline mb-2">📄 ${a.name}の詳細ガイド →</a>\n              <div class="grid grid-cols-2 sm:grid-cols-4 gap-2">\n                <div class="text-center p-2 bg-blue-50 rounded-lg">\n                  <div class="text-xs text-gray-500">住宅地価格</div>\n                  <div class="text-sm font-bold text-blue-700">${(a.residentialPrice/1e4).toFixed(1)}万/m²</div>\n                </div>\n                <div class="text-center p-2 bg-green-50 rounded-lg">\n                  <div class="text-xs text-gray-500">名古屋まで</div>\n                  <div class="text-sm font-bold text-green-700">${a.accessToNagoya}分</div>\n                </div>\n                <div class="text-center p-2 bg-amber-50 rounded-lg">\n                  <div class="text-xs text-gray-500">地価変動</div>\n                  <div class="text-sm font-bold text-amber-700">+${a.yoyChange}%</div>\n                </div>\n                <div class="text-center p-2 bg-purple-50 rounded-lg">\n                  <div class="text-xs text-gray-500">人口</div>\n                  <div class="text-sm font-bold text-purple-700">${(a.population/1e4).toFixed(1)}万人</div>\n                </div>\n              </div>\n            </div>\n            <div class="flex-shrink-0 w-28 space-y-1 hidden sm:block">\n              ${scoreKeys.map(s=>`\n                <div class="flex items-center gap-1">\n                  <span class="text-xs text-gray-400 w-8 text-right">${s.label}</span>\n                  <div class="score-bar flex-1"><div class="score-bar-fill bg-blue-500" style="width:${a.scores[s.key]}%"></div></div>\n                  <span class="text-xs text-gray-500 w-5 text-right">${a.scores[s.key]}</span>\n                </div>\n              `).join("")}\n            </div>\n          </div>\n        </div>\n      `).join("")}\n    </div>\n  `}function renderCompare(ranked){const cols=state.cmpSelectedColumns.map(k=>CMP_COLUMNS.find(c=>c.key===k)).filter(Boolean);return`\n    <div class="space-y-5 fade-in">\n      <h2 class="text-lg font-bold text-gray-800">📊 エリア比較</h2>\n\n      \x3c!-- Filter Tags + Presets --\x3e\n      <div class="card p-4">\n        <div class="flex flex-wrap items-center gap-2 mb-3">\n          ${cols.map(c=>`\n            <span class="cmp-filter-tag active">\n              ${c.icon} ${c.label}\n              <span class="cmp-tag-x" data-cmp-remove-col="${c.key}">&times;</span>\n            </span>\n          `).join("")}\n          <button class="cmp-add-col-btn" id="cmp-open-col-modal">+ 項目を追加</button>\n        </div>\n        <div class="flex flex-wrap gap-2">\n          ${Object.entries(CMP_PRESETS).map(([k,v])=>`\n            <button class="cmp-preset-btn" data-cmp-preset="${k}">${v.label}</button>\n          `).join("")}\n        </div>\n      </div>\n\n      \x3c!-- Summary Rows --\x3e\n      <div style="display:flex;flex-direction:column;gap:6px;">\n        ${ranked.map((a,idx)=>{const medalBg=idx<3?"#3b82f6":"#94a3b8";return`\n          <div class="cmp-row" data-cmp-open-detail="${a.id}">\n            <span style="width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-size:12px;font-weight:700;flex-shrink:0;background:${medalBg}">${idx+1}</span>\n            <span style="font-weight:600;color:#111827;width:5em;flex-shrink:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:14px;">${a.name}</span>\n            ${cols.map(c=>{const val=getCmpVal(a,c.key),scoreColor=c.isScore?val>=80?"#2563eb":val>=70?"#16a34a":"#4b5563":"#1f2937";return`<div style="flex:1;text-align:center;min-width:0;">\n                <div style="font-size:11px;color:#9ca3af;margin-bottom:2px;" class="hidden sm:block">${c.label}</div>\n                <div style="font-size:13px;font-weight:700;color:${scoreColor}">${c.format(val)}</div>\n              </div>`}).join("")}\n            <svg style="width:16px;height:16px;flex-shrink:0;color:#d1d5db;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>\n          </div>\n          `}).join("")}\n      </div>\n    </div>\n  `}function renderDetail(area,ranked){if(!area)return"<p>エリアを選択してください</p>";return`\n    <div class="space-y-6 fade-in">\n      <div class="flex items-center gap-3 flex-wrap">\n        <button id="btn-back" class="px-3 py-1.5 bg-gray-100 text-gray-600 rounded-lg text-sm hover:bg-gray-200 transition-colors">← 戻る</button>\n        <h2 class="text-lg font-bold text-gray-800">🔍 ${area.name} の詳細分析</h2>\n        <button id="btn-to-map" class="px-3 py-1.5 bg-blue-100 text-blue-700 rounded-lg text-sm hover:bg-blue-50 transition-colors ml-auto">🗺️ マップで表示</button>\n      </div>\n\n      <div class="flex flex-wrap gap-2">\n        ${ranked.map(a=>`\n          <button data-area-switch="${a.id}" class="px-4 py-2 rounded-lg text-sm font-medium transition-all ${area.id===a.id?"bg-blue-600 text-white shadow-md":"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50"}">\n            ${a.name}\n          </button>\n        `).join("")}\n      </div>\n\n      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">\n        \x3c!-- レーダーチャート --\x3e\n        <div class="card p-6">\n          <h3 class="text-base font-bold text-gray-700 mb-4">総合評価</h3>\n          <canvas id="chart-radar" height="280"></canvas>\n          <div class="text-center mt-4">\n            <span class="text-4xl font-bold text-blue-600">${area.scores.total}</span>\n            <span class="text-sm text-gray-400 ml-1">/ 100点</span>\n          </div>\n          <div class="grid grid-cols-3 gap-2 mt-4">\n            ${[{key:"price",label:"価格の手頃さ",color:"#3b82f6"},{key:"access",label:"名古屋アクセス",color:"#10b981"},{key:"growth",label:"資産価値上昇",color:"#f59e0b"},{key:"living",label:"生活利便性",color:"#ef4444"},{key:"family",label:"子育て環境",color:"#8b5cf6"},{key:"nature",label:"自然環境",color:"#06b6d4"}].map(s=>`\n              <div class="text-center">\n                <div class="text-xs text-gray-500">${s.label}</div>\n                <div class="text-lg font-bold" style="color:${s.color}">${area.scores[s.key]}</div>\n              </div>\n            `).join("")}\n          </div>\n        </div>\n\n        \x3c!-- 基本情報 --\x3e\n        <div class="card p-6">\n          <h3 class="text-base font-bold text-gray-700 mb-4">基本データ</h3>\n          <div class="space-y-3">\n            ${[["🏠 住宅地平均",`${area.residentialPrice.toLocaleString()}円/m²`],["💴 坪単価",`${area.pricePerTsubo.toLocaleString()}円/坪`],["📈 前年比変動",`+${area.yoyChange}%`],["👥 人口",`${area.population.toLocaleString()}人`],["🚃 名古屋まで",`約${area.accessToNagoya}分`],["🏥 医療施設",`${area.hospitals}施設`],["🏫 教育施設",`${area.schools}施設`],["🛍 商業施設",`${area.shopping}施設`]].map(([l,v])=>`\n              <div class="flex justify-between items-center py-2 border-b border-gray-50">\n                <span class="text-sm text-gray-600">${l}</span>\n                <span class="text-sm font-bold text-gray-900">${v}</span>\n              </div>\n            `).join("")}\n            ${area._liveAvgTradePrice?`\n              <div class="flex justify-between items-center py-2 border-b border-blue-100 bg-blue-50 rounded px-2 mt-2">\n                <span class="text-sm text-blue-600 font-medium">🔴 LIVE 平均取引価格</span>\n                <span class="text-sm font-bold text-blue-700">${area._liveAvgTradePrice.toLocaleString()}円</span>\n              </div>\n            `:""}\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- 地価推移 --\x3e\n      <div class="card p-6">\n        <h3 class="text-base font-bold text-gray-700 mb-4">地価推移</h3>\n        <canvas id="chart-detail-trend" height="200"></canvas>\n      </div>\n\n      \x3c!-- 概要・ポイント・注意点 --\x3e\n      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">\n        <div class="card p-5">\n          <h3 class="text-base font-bold text-gray-700 mb-3">📝 概要</h3>\n          <p class="text-sm text-gray-600 leading-relaxed">${area.description}</p>\n        </div>\n        <div class="rounded-xl p-5 bg-green-50 border border-green-200">\n          <h3 class="text-base font-bold text-green-700 mb-3">✅ ポイント</h3>\n          <ul class="space-y-2">\n            ${area.highlights.map(h=>`<li class="text-sm text-green-800 flex items-start gap-2"><span class="mt-0.5">•</span>${h}</li>`).join("")}\n          </ul>\n        </div>\n        <div class="rounded-xl p-5 bg-amber-50 border border-amber-200">\n          <h3 class="text-base font-bold text-amber-700 mb-3">⚠️ 注意点</h3>\n          <ul class="space-y-2">\n            ${area.risks.map(r=>`<li class="text-sm text-amber-800 flex items-start gap-2"><span class="mt-0.5">•</span>${r}</li>`).join("")}\n          </ul>\n        </div>\n      </div>\n\n      \x3c!-- おすすめエリア --\x3e\n      <div class="rounded-xl p-6 bg-blue-50 border border-blue-200">\n        <h3 class="text-base font-bold text-blue-700 mb-3">🎯 ${area.name}のおすすめ物件エリア</h3>\n        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">\n          ${area.recAreas.map((r,i)=>`\n            <div class="bg-white rounded-lg p-4 border border-blue-100">\n              <div class="text-xs text-blue-500 font-medium mb-1">おすすめ ${i+1}</div>\n              <div class="text-sm font-medium text-gray-800">${r}</div>\n            </div>\n          `).join("")}\n        </div>\n      </div>\n\n    </div>\n  `}function renderMap(ranked){const selArea=state.mapSelectedAreaId?ranked.find(a=>a.id===state.mapSelectedAreaId):null;return`\n    <div class="space-y-4 fade-in">\n      <div class="flex items-center justify-between">\n        <h2 class="text-lg font-bold text-gray-800">🗺️ エリアマップ</h2>\n        <div class="flex gap-2">\n          <button id="btn-district-area-toggle" class="school-toggle ${showDistrictAreas?"active":""}" onclick="toggleDistrictAreas()">\n            <span>${showDistrictAreas?"📊 エリア ON":"📊 エリア"}</span>\n          </button>\n          <button id="btn-school-toggle" class="school-toggle ${showSchoolDistricts?"active":""}" onclick="toggleSchoolDistricts()">\n            <span>${showSchoolDistricts?"🏫 学区 ON":"🏫 学区"}</span>\n          </button>\n          <button id="btn-fullscreen-toggle" class="map-fullscreen-btn" onclick="toggleMapFullscreen()">\n            <span id="fullscreen-icon">⛶</span> <span id="fullscreen-label">拡大</span>\n          </button>\n        </div>\n      </div>\n      \x3c!-- Fullscreen floating controls --\x3e\n      <div id="map-fullscreen-controls" class="map-fullscreen-controls">\n        <span style="font-weight:600;font-size:13px;color:#1e40af;">🗺️ エリアマップ</span>\n        <button class="school-toggle ${showDistrictAreas?"active":""}" onclick="toggleDistrictAreas()">\n          <span>${showDistrictAreas?"📊 エリア ON":"📊 エリア"}</span>\n        </button>\n        <button class="school-toggle ${showSchoolDistricts?"active":""}" onclick="toggleSchoolDistricts()">\n          <span>${showSchoolDistricts?"🏫 学区 ON":"🏫 学区"}</span>\n        </button>\n        <button class="map-fullscreen-btn active" onclick="toggleMapFullscreen()">\n          <span>✕</span> <span>閉じる</span>\n        </button>\n      </div>\n      <div class="card overflow-hidden">\n        <div class="map-layout" style="position:relative;">\n          <div id="map-container"></div>\n          <div id="map-loading-overlay" class="map-loading-overlay hidden">\n            <div class="map-loading-box">\n              <div class="map-loading-spinner"></div>\n              <div id="map-loading-text" style="font-size:13px;font-weight:600;color:#1e40af;">データ取得中...</div>\n              <div class="map-loading-progress"><div id="map-loading-bar" class="map-loading-progress-bar" style="width:0%"></div></div>\n            </div>\n          </div>\n          <div id="map-sidebar">\n            ${selArea?"":'\n              <div class="flex flex-col items-center justify-center h-full text-center p-8">\n                <div class="text-4xl mb-3">📍</div>\n                <p class="text-sm font-medium text-gray-700 mb-1">エリアを選択してください</p>\n                <p class="text-xs text-gray-400">マップ上のマーカーをクリックすると<br>土地情報・取引データが表示されます</p>\n              </div>\n            '}\n          </div>\n        </div>\n      </div>\n    </div>\n  `}let _mapFullscreen=!1;function toggleMapFullscreen(){_mapFullscreen=!_mapFullscreen;const layout=document.querySelector(".map-layout"),btn=document.getElementById("btn-fullscreen-toggle"),icon=document.getElementById("fullscreen-icon"),label=document.getElementById("fullscreen-label"),floatingCtrl=document.getElementById("map-fullscreen-controls");if(layout){if(_mapFullscreen){layout.classList.add("map-fullscreen"),btn&&btn.classList.add("active"),icon&&(icon.textContent="✕"),label&&(label.textContent="閉じる");const card=layout.closest(".card");card&&(card.style.borderRadius="0"),floatingCtrl&&floatingCtrl.classList.add("visible"),document.body.style.overflow="hidden"}else{layout.classList.remove("map-fullscreen"),btn&&btn.classList.remove("active"),icon&&(icon.textContent="⛶"),label&&(label.textContent="拡大");const card=layout.closest(".card");card&&(card.style.borderRadius=""),floatingCtrl&&floatingCtrl.classList.remove("visible"),document.body.style.overflow=""}mapInstance&&setTimeout(()=>{mapInstance.invalidateSize()},200)}}document.addEventListener("keydown",function(e){"Escape"===e.key&&_mapFullscreen&&toggleMapFullscreen()});const SCHOOL_DISTRICT_COLORS=["#3b82f6","#ef4444","#22c55e","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#f97316","#14b8a6","#6366f1","#84cc16","#e11d48","#0ea5e9","#a855f7","#10b981","#f43f5e"],DISTRICT_AREA_COLORS=["#3b82f6","#ef4444","#22c55e","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#f97316","#14b8a6","#6366f1","#84cc16","#e11d48","#0ea5e9","#a855f7","#10b981","#f43f5e"];function toggleDistrictAreas(){showDistrictAreas=!showDistrictAreas;const btn=document.getElementById("btn-district-area-toggle");btn&&(btn.classList.toggle("active",showDistrictAreas),btn.querySelector("span").textContent=showDistrictAreas?"📊 エリア ON":"📊 エリア"),showDistrictAreas?renderDistrictAreas():(districtAreaLayer&&mapInstance&&(mapInstance.removeLayer(districtAreaLayer),districtAreaLayer=null),state.mapSelectedDistrict=null)}function renderDistrictAreas(){if(!mapInstance)return;districtAreaLayer&&mapInstance.removeLayer(districtAreaLayer),districtAreaLayer=L.layerGroup();const districtEntries=[];AREAS.forEach(area=>{if(!area._liveTransactions)return;const districtMap={};area._liveTransactions.forEach(tx=>{tx.District&&(districtMap[tx.District]||(districtMap[tx.District]=0),districtMap[tx.District]++)}),Object.entries(districtMap).forEach(([districtName,count])=>{const coords=findDistrictCoords(districtName,area.name);coords&&districtEntries.push({districtName:districtName,cityName:area.name,cityId:area.id,coords:coords,count:count,area:area})})});let colorIdx=0;districtEntries.forEach(entry=>{const color=DISTRICT_AREA_COLORS[colorIdx++%DISTRICT_AREA_COLORS.length],radius=Math.max(200,Math.min(600,80*entry.count)),circle=L.circle([entry.coords[0],entry.coords[1]],{radius:radius,color:color,weight:2,opacity:.8,fillColor:color,fillOpacity:.15,dashArray:"4 3"});circle.bindTooltip(`${entry.districtName} (${entry.count}件)`,{permanent:!1,direction:"top",className:"map-tooltip"}),circle.on("click",()=>{state.mapSelectedDistrict={cityId:entry.cityId,districtName:entry.districtName},state.mapSelectedAreaId=entry.cityId;const ranked=getRankedAreas();updateDistrictSidebar(entry.area,entry.districtName,ranked),renderDistrictAreas()}),state.mapSelectedDistrict&&state.mapSelectedDistrict.cityId===entry.cityId&&state.mapSelectedDistrict.districtName===entry.districtName&&circle.setStyle({fillOpacity:.35,weight:3,opacity:1,dashArray:null}),circle.on("mouseover",function(){this.setStyle({fillOpacity:.3,weight:3})}),circle.on("mouseout",function(){const isSelected=state.mapSelectedDistrict&&state.mapSelectedDistrict.cityId===entry.cityId&&state.mapSelectedDistrict.districtName===entry.districtName;this.setStyle({fillOpacity:isSelected?.35:.15,weight:isSelected?3:2})}),districtAreaLayer.addLayer(circle);const label=L.marker([entry.coords[0],entry.coords[1]],{icon:L.divIcon({html:`<div style="font-size:10px;font-weight:600;color:${color};text-shadow:1px 1px 2px white,-1px -1px 2px white,1px -1px 2px white,-1px 1px 2px white;white-space:nowrap;text-align:center;pointer-events:none;">${entry.districtName}</div>`,className:"school-icon-marker",iconSize:[80,16],iconAnchor:[40,8]}),interactive:!1});districtAreaLayer.addLayer(label)}),districtAreaLayer.addTo(mapInstance)}async function loadSchoolDistrictData(){if(schoolDistrictData)return schoolDistrictData;try{const resp=await fetch("/school-districts.geojson");if(!resp.ok)throw new Error(`HTTP ${resp.status}`);return schoolDistrictData=await resp.json(),console.log(`School districts loaded: ${schoolDistrictData.features.length} zones`),schoolDistrictData}catch(e){return console.warn("School district data load failed:",e),null}}function toggleSchoolDistricts(){showSchoolDistricts=!showSchoolDistricts;const btn=document.getElementById("btn-school-toggle");btn&&(btn.classList.toggle("active",showSchoolDistricts),btn.querySelector("span").textContent=showSchoolDistricts?"🏫 学区 ON":"🏫 学区"),showSchoolDistricts?renderSchoolDistricts():(schoolDistrictLayer&&mapInstance&&(mapInstance.removeLayer(schoolDistrictLayer),schoolDistrictLayer=null),schoolMarkerLayer&&mapInstance&&(mapInstance.removeLayer(schoolMarkerLayer),schoolMarkerLayer=null))}async function renderSchoolDistricts(){if(!mapInstance)return;const data=await loadSchoolDistrictData();if(!data)return;schoolDistrictLayer&&mapInstance.removeLayer(schoolDistrictLayer),schoolMarkerLayer&&mapInstance.removeLayer(schoolMarkerLayer);const polygonFeatures={type:"FeatureCollection",features:data.features.filter(f=>"Polygon"===f.geometry.type||"MultiPolygon"===f.geometry.type)},pointFeatures=data.features.filter(f=>"Point"===f.geometry.type&&"school"===f.properties.type);let colorIdx=0;schoolDistrictLayer=L.geoJSON(polygonFeatures,{style:feature=>{const color=SCHOOL_DISTRICT_COLORS[colorIdx++%SCHOOL_DISTRICT_COLORS.length];return{color:color,weight:2,opacity:.7,fillColor:color,fillOpacity:.08,dashArray:"4 3"}},onEachFeature:(feature,layer)=>{const p=feature.properties;layer.bindPopup(`\n        <div style="font-family:'Noto Sans JP',sans-serif;font-size:12px;line-height:1.6;">\n          <div style="font-weight:700;font-size:14px;color:#1e40af;margin-bottom:4px;">🏫 ${p.name}</div>\n          <table style="font-size:11px;">\n            <tr><td style="color:#6b7280;padding-right:8px;">設置者</td><td>${p.org}</td></tr>\n            <tr><td style="color:#6b7280;padding-right:8px;">所在地</td><td>${p.address}</td></tr>\n          </table>\n        </div>\n      `,{maxWidth:240}),layer.on("mouseover",function(){this.setStyle({fillOpacity:.25,weight:3})}),layer.on("mouseout",function(){this.setStyle({fillOpacity:.08,weight:2})})}}).addTo(mapInstance),schoolDistrictLayer.bringToBack();const schoolIcon=L.divIcon({html:'<div style="font-size:20px;text-align:center;line-height:1;filter:drop-shadow(1px 1px 1px rgba(0,0,0,0.3));">🏫</div>',className:"school-icon-marker",iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-14]});schoolMarkerLayer=L.layerGroup(),pointFeatures.forEach(f=>{const p=f.properties,coords=f.geometry.coordinates,marker=L.marker([coords[1],coords[0]],{icon:schoolIcon,zIndexOffset:500});marker.bindPopup(`\n      <div style="font-family:'Noto Sans JP',sans-serif;font-size:12px;line-height:1.6;">\n        <div style="font-weight:700;font-size:14px;color:#1e40af;margin-bottom:4px;">🏫 ${p.name}</div>\n        <table style="font-size:11px;">\n          <tr><td style="color:#6b7280;padding-right:8px;">設置者</td><td>${p.org}</td></tr>\n          <tr><td style="color:#6b7280;padding-right:8px;">所在地</td><td>${p.address}</td></tr>\n        </table>\n      </div>\n    `,{maxWidth:240}),schoolMarkerLayer.addLayer(marker)}),schoolMarkerLayer.addTo(mapInstance)}function initializeMap(ranked){if(document.getElementById("map-container")&&window.L){if(mapInstance){try{mapInstance.remove()}catch{}mapInstance=null,mapMarkers={},txMarkerLayer=null}if(mapInstance=L.map("map-container",{zoomControl:!0}).setView([34.98,136.56],10),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://osm.org/copyright">OpenStreetMap</a>',maxZoom:18}).addTo(mapInstance),txMarkerLayer=L.layerGroup().addTo(mapInstance),ranked.forEach((area,idx)=>{const icon=createMapIcon(COLORS[AREAS.findIndex(a=>a.id===area.id)%COLORS.length],idx+1,area.scores.total,area.id===state.mapSelectedAreaId),marker=L.marker([area.lat,area.lng],{icon:icon,zIndexOffset:1e3}).addTo(mapInstance);marker.bindTooltip(`${area.name} (${area.scores.total}pt)`,{direction:"top",offset:[0,-20],className:"map-tooltip"}),marker.on("click",async()=>{state.mapSelectedAreaId=area.id,state.mapSelectedDistrict=null,ranked.forEach((a,i)=>{const c=COLORS[AREAS.findIndex(x=>x.id===a.id)%COLORS.length];mapMarkers[a.id].setIcon(createMapIcon(c,i+1,a.scores.total,a.id===area.id))}),updateMapSidebar(area,ranked),await geocodeAreaDistricts(area),showTransactionPins(area),mapInstance.flyTo([area.lat,area.lng],13,{duration:.8}),AREA_FULL_LOADED.has(area.id)||(_fetchPriorityAreaId=area.id,!_autoFetchRunning&&mcpReinfo&&mcpReinfo.connected&&fetchAreaFullData(area.id))}),mapMarkers[area.id]=marker}),setTimeout(()=>{mapInstance&&mapInstance.invalidateSize()},100),setTimeout(()=>{mapInstance&&mapInstance.invalidateSize()},500),showAllTransactionPins(ranked),showSchoolDistricts&&renderSchoolDistricts(),showDistrictAreas&&renderDistrictAreas(),state.mapSelectedAreaId){const sel=ranked.find(a=>a.id===state.mapSelectedAreaId);sel&&(showTransactionPins(sel),mapInstance.setView([sel.lat,sel.lng],13),AREA_FULL_LOADED.has(sel.id)||(_fetchPriorityAreaId=sel.id,!_autoFetchRunning&&mcpReinfo&&mcpReinfo.connected&&fetchAreaFullData(sel.id)))}}}const STATION_COORDS={"近鉄四日市":[34.9665,136.6142],"四日市":[34.9667,136.6186],"富田":[34.989,136.6266],"富洲原":[34.997,136.631],"阿倉川":[34.976,136.6175],"川原町":[34.972,136.6153],"新正":[34.962,136.6154],"赤堀":[34.958,136.6156],"日永":[34.944,136.6088],"南日永":[34.952,136.612],"泊":[34.938,136.611],"追分":[34.934,136.605],"内部":[34.928,136.5925],"小古曽":[34.936,136.599],"河原田":[34.912,136.5814],"塩浜":[34.938,136.6217],"海山道":[34.956,136.6238],"霞ヶ浦":[34.957,136.6262],"大矢知":[34.997,136.628],"平津":[34.996,136.618],"暁学園前":[34.993,136.608],"山城":[34.981,136.5936],"保々":[34.991,136.582],"北楠":[34.918,136.61],"楠":[34.912,136.615],"南四日市":[34.947,136.62],"中川原":[34.961,136.607],"伊勢松本":[34.969,136.601],"西日野":[34.95,136.597],"近鉄富田":[34.988,136.622],"桑名":[35.0614,136.6918],"播磨":[35.046,136.677],"益生":[35.066,136.6785],"馬道":[35.06,136.686],"西桑名":[35.062,136.686],"在良":[35.073,136.676],"星川":[35.081,136.671],"七和":[35.087,136.659],"穴太":[35.091,136.65],"多度":[35.117,136.629],"長島":[35.076,136.715],"蓮花寺":[35.078,136.665],"下深谷":[35.039,136.669],"伊勢朝日":[35.032,136.669],"白子":[34.843,136.611],"鈴鹿":[34.871,136.543],"鈴鹿市":[34.881,136.581],"三日市":[34.874,136.577],"平田町":[34.876,136.559],"加佐登":[34.886,136.523],"玉垣":[34.855,136.601],"柳":[34.848,136.599],"磯山":[34.836,136.615],"千代崎":[34.831,136.617],"箕田":[34.863,136.593],"鼓ヶ浦":[34.838,136.613],"徳田":[34.884,136.559],"伊勢若松":[34.856,136.608],"千里":[34.887,136.506],"中瀬古":[34.866,136.571],"三里":[35.093,136.554],"北勢中央公園口":[35.087,136.548],"麻生田":[35.099,136.548],"阿下喜":[35.126,136.549],"楚原":[35.116,136.549],"大泉":[35.108,136.554],"梅戸井":[35.084,136.551],"亀山":[34.855,136.449],"関":[34.855,136.397],"加太":[34.85,136.355],"井田川":[34.874,136.489],"菰野":[35.017,136.516],"中菰野":[35.024,136.509],"大羽根園":[35.029,136.502],"湯の山温泉":[35.036,136.486],"桜":[35.009,136.528],"東員":[35.06,136.595],"大長":[35.066,136.589],"北大社":[35.073,136.592]},STATION_TO_NAGOYA_MIN={"近鉄四日市":35,"四日市":50,"富田":38,"富洲原":40,"阿倉川":37,"川原町":36,"新正":36,"赤堀":37,"日永":40,"南日永":39,"泊":42,"追分":43,"内部":45,"小古曽":44,"河原田":48,"塩浜":42,"海山道":38,"霞ヶ浦":37,"大矢知":40,"平津":42,"暁学園前":44,"山城":46,"保々":48,"北楠":48,"楠":50,"南四日市":40,"中川原":38,"伊勢松本":40,"西日野":42,"近鉄富田":37,"桑名":25,"播磨":30,"益生":27,"馬道":26,"西桑名":26,"在良":28,"星川":30,"七和":32,"穴太":34,"多度":40,"長島":22,"蓮花寺":31,"下深谷":32,"伊勢朝日":33,"白子":55,"鈴鹿":65,"鈴鹿市":60,"三日市":62,"平田町":63,"加佐登":68,"玉垣":57,"柳":58,"磯山":56,"千代崎":54,"箕田":59,"鼓ヶ浦":55,"徳田":63,"伊勢若松":56,"千里":70,"中瀬古":61,"三里":52,"北勢中央公園口":53,"麻生田":54,"阿下喜":58,"楚原":56,"大泉":54,"梅戸井":51,"亀山":70,"関":80,"加太":90,"井田川":65,"菰野":50,"中菰野":52,"大羽根園":54,"湯の山温泉":58,"桜":48,"東員":38,"大長":40,"北大社":42};function findStationCoords(stationName){if(!stationName)return null;if(STATION_COORDS[stationName])return STATION_COORDS[stationName];const cleaned=stationName.replace(/駅$/,"").replace(/\(.*\)/,"").trim();if(STATION_COORDS[cleaned])return STATION_COORDS[cleaned];for(const[key,coords]of Object.entries(STATION_COORDS))if(cleaned.includes(key)||key.includes(cleaned))return coords;return null}const DISTRICT_CACHE=new Map,DISTRICT_CACHE_KEY="mie-realestate-district-coords-v2";function loadDistrictCache(){try{const stored=localStorage.getItem(DISTRICT_CACHE_KEY);if(!stored)return;const obj=JSON.parse(stored);for(const[k,v]of Object.entries(obj))DISTRICT_CACHE.set(k,v);console.log(`District cache loaded: ${DISTRICT_CACHE.size} entries`)}catch(e){console.warn("Cache load failed:",e)}}function saveDistrictCache(){try{const obj={};for(const[k,v]of DISTRICT_CACHE.entries())obj[k]=v;localStorage.setItem(DISTRICT_CACHE_KEY,JSON.stringify(obj))}catch(e){console.warn("Cache save failed:",e)}}async function geocodeDistrict(district,cityName){const cacheKey=`${cityName}-${district}`;if(DISTRICT_CACHE.has(cacheKey))return DISTRICT_CACHE.get(cacheKey);const queries=[`三重県${cityName}${district}`,`${cityName}${district}`];for(const q of queries)try{const url=`https://msearch.gsi.go.jp/address-search/AddressSearch?q=${encodeURIComponent(q)}`,resp=await fetch(url);if(!resp.ok)continue;const results=await resp.json();if(results.length>0){const coords_arr=results[0].geometry.coordinates,lat=parseFloat(coords_arr[1]),lng=parseFloat(coords_arr[0]);if(lat>=34.2&&lat<=35.5&&lng>=135.8&&lng<=137){const coords=[lat,lng];return DISTRICT_CACHE.set(cacheKey,coords),coords}}}catch(e){}const nomQueries=[`${district}, ${cityName}, 三重県`,`${district}, ${cityName}`];for(const q of nomQueries)try{const url=`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(q)}&format=json&limit=1&countrycodes=jp`,resp=await fetch(url,{headers:{"User-Agent":"MieRealEstateApp/1.0"}});if(!resp.ok)continue;const results=await resp.json();if(results.length>0){const lat=parseFloat(results[0].lat),lng=parseFloat(results[0].lon);if(lat>=34.2&&lat<=35.5&&lng>=135.8&&lng<=137){const coords=[lat,lng];return DISTRICT_CACHE.set(cacheKey,coords),coords}}}catch(e){}return DISTRICT_CACHE.set(cacheKey,null),null}async function geocodeDistrictsBackground(){const uncached=[];for(const area of AREAS)if(area._liveTransactions)for(const tx of area._liveTransactions){if(!tx.District)continue;const key=`${area.name}-${tx.District}`;DISTRICT_CACHE.has(key)||uncached.find(u=>u.key===key)||uncached.push({key:key,district:tx.District,cityName:area.name})}if(0===uncached.length)return;const total=uncached.length;let done=0;for(const{district:district,cityName:cityName}of uncached)done++,updateStatusText(`地区の位置情報を取得中... (${done}/${total})`),await geocodeDistrict(district,cityName),done%5==0&&saveDistrictCache(),done<total&&await new Promise(r=>setTimeout(r,300));if(saveDistrictCache(),updateStatusText(`位置情報取得完了 (${done}件) — ピンを更新中...`),"map"===state.view&&txMarkerLayer){const ranked=getRankedAreas();if(state.mapSelectedAreaId){const sel=ranked.find(a=>a.id===state.mapSelectedAreaId);sel&&showTransactionPins(sel)}else showAllTransactionPins(ranked)}updateStatusText(`ライブデータ取得完了 — 地区位置: ${Array.from(DISTRICT_CACHE.values()).filter(v=>null!==v).length}件解決済み`)}function findDistrictCoords(district,cityName){if(!district||!cityName)return null;const key=`${cityName}-${district}`;return DISTRICT_CACHE.get(key)||null}function aggregateDistrictMetrics(area,districtName){if(!area._liveTransactions||!districtName)return null;const txs=area._liveTransactions.map((t,i)=>({...t,_areaIdx:i})).filter(t=>t.District===districtName);if(0===txs.length)return null;const prices=txs.filter(t=>null!=t.TradePrice&&!isNaN(t.TradePrice)).map(t=>t.TradePrice),avgPrice=prices.length>0?prices.reduce((a,b)=>a+b,0)/prices.length:null,minPrice=prices.length>0?Math.min(...prices):null,maxPrice=prices.length>0?Math.max(...prices):null,pricePerM2=txs.filter(t=>null!=t.TradePrice&&!isNaN(t.TradePrice)&&t.Area&&t.Area>0).map(t=>t.TradePrice/t.Area),avgPricePerM2=pricePerM2.length>0?pricePerM2.reduce((a,b)=>a+b,0)/pricePerM2.length:null,stationCounts={};txs.forEach(t=>{if(t.NearestStation){const s=t.NearestStation.replace(/\(.*\)/,"").trim();stationCounts[s]=(stationCounts[s]||0)+1}});const topStation=Object.entries(stationCounts).sort((a,b)=>b[1]-a[1])[0],nearestStation=topStation?topStation[0]:null;let nagoyaMin=null;if(nearestStation){const cleaned=nearestStation.replace(/駅$/,"").trim();if(nagoyaMin=STATION_TO_NAGOYA_MIN[cleaned]||STATION_TO_NAGOYA_MIN[nearestStation]||null,!nagoyaMin)for(const[key,min]of Object.entries(STATION_TO_NAGOYA_MIN))if(cleaned.includes(key)||key.includes(cleaned)){nagoyaMin=min;break}}nagoyaMin||(nagoyaMin=area.accessToNagoya);const distances=txs.filter(t=>t.DistanceToStation).map(t=>{const m=String(t.DistanceToStation).match(/(\d+)/);return m?parseInt(m[1]):null}).filter(Boolean),avgDistance=distances.length>0?Math.round(distances.reduce((a,b)=>a+b,0)/distances.length):null,typeCounts={};txs.forEach(t=>{const type=t.Type||t.Use||"その他";typeCounts[type]=(typeCounts[type]||0)+1});const typeDistribution=Object.entries(typeCounts).map(([name,count])=>({name:name,count:count,pct:Math.round(count/txs.length*100)})).sort((a,b)=>b.count-a.count),currentYear=(new Date).getFullYear(),ages=txs.filter(t=>t.BuildingYear).map(t=>{const yr=String(t.BuildingYear);let builtYear=parseInt(yr);if(yr.includes("令和")){builtYear=2018+parseInt(yr.replace(/[^0-9]/g,""))}else if(yr.includes("平成")){builtYear=1988+parseInt(yr.replace(/[^0-9]/g,""))}else if(yr.includes("昭和")){builtYear=1925+parseInt(yr.replace(/[^0-9]/g,""))}return builtYear>1900&&builtYear<=currentYear?currentYear-builtYear:null}).filter(Boolean),avgBuildingAge=ages.length>0?Math.round(ages.reduce((a,b)=>a+b,0)/ages.length):null,coords=findDistrictCoords(districtName,area.name);return{districtName:districtName,cityName:area.name,cityId:area.id,count:txs.length,transactions:txs,avgPrice:avgPrice,minPrice:minPrice,maxPrice:maxPrice,avgPricePerM2:avgPricePerM2,nearestStation:nearestStation,nagoyaMin:nagoyaMin,avgDistance:avgDistance,typeDistribution:typeDistribution,avgBuildingAge:avgBuildingAge,coords:coords}}async function geocodeAreaDistricts(area,options={}){if(!area._liveTransactions)return;const uncached=[];for(const tx of area._liveTransactions){if(!tx.District)continue;const key=`${area.name}-${tx.District}`;DISTRICT_CACHE.has(key)||uncached.find(u=>u.key===key)||uncached.push({key:key,district:tx.District,cityName:area.name})}if(0===uncached.length)return;const showOverlay=void 0===options.showOverlay||options.showOverlay,total=uncached.length;let done=0;showOverlay&&showMapLoading(`${area.name} 地区情報取得中...`,0);for(const{district:district,cityName:cityName}of uncached)done++,showOverlay&&updateMapLoading(`${area.name} 地区情報取得中... (${done}/${total})`,done/total*100),await geocodeDistrict(district,cityName),done%5==0&&saveDistrictCache(),done<total&&await new Promise(r=>setTimeout(r,200));saveDistrictCache(),showOverlay&&hideMapLoading()}function hashStr(s){let h=0;for(let i=0;i<s.length;i++)h=(h<<5)-h+s.charCodeAt(i)|0;return Math.abs(h)}function estimateTxPosition(area,tx,idx){const districtCoords=findDistrictCoords(tx.District,area.name);if(districtCoords){const jitterAngle=137.508*idx*(Math.PI/180),jitter=.001+idx%7*5e-4;return{lat:districtCoords[0]+Math.cos(jitterAngle)*jitter,lng:districtCoords[1]+Math.sin(jitterAngle)*jitter}}const stationCoords=findStationCoords(tx.NearestStation);if(stationCoords){const jitterAngle=137.508*idx*(Math.PI/180),jitter=8e-4+idx%5*4e-4;return{lat:stationCoords[0]+Math.cos(jitterAngle)*jitter,lng:stationCoords[1]+Math.sin(jitterAngle)*jitter}}const stationFromDistrict=findStationCoords(tx.District);if(stationFromDistrict){const jitterAngle=137.508*idx*(Math.PI/180),jitter=.0015+idx%7*5e-4;return{lat:stationFromDistrict[0]+Math.cos(jitterAngle)*jitter,lng:stationFromDistrict[1]+Math.sin(jitterAngle)*jitter}}const hash=hashStr((tx.District||tx.NearestStation||`tx-${idx}`)+area.id),angle=(150+hash%200)*(Math.PI/180),spread=.004+hash%40/40*.012,baseLat=area.lat+Math.cos(angle)*spread,baseLng=area.lng+Math.sin(angle)*spread,jitterAngle=137.508*idx*(Math.PI/180),jitter=8e-4+idx%5*4e-4;return{lat:baseLat+Math.cos(jitterAngle)*jitter,lng:baseLng+Math.sin(jitterAngle)*jitter}}function priceColor(price){return!price||isNaN(price)?"#9ca3af":price<5e6?"#22c55e":price<15e6?"#3b82f6":price<3e7?"#f59e0b":price<5e7?"#ef4444":"#7c3aed"}async function showAllTransactionPins(ranked){if(!txMarkerLayer)return;txMarkerLayer.clearLayers();for(const area of AREAS)area._liveTransactions&&area._liveTransactions.length>0&&await geocodeAreaDistricts(area,{showOverlay:!1});let totalPins=0;AREAS.forEach(area=>{const transactions=area._liveTransactions;if(!transactions)return;AREAS.indexOf(area);transactions.forEach((tx,i)=>{const pos=estimateTxPosition(area,tx,i),hasPrice=null!=tx.TradePrice&&!isNaN(tx.TradePrice);totalPins++;const cm=L.circleMarker([pos.lat,pos.lng],{radius:5,fillColor:hasPrice?priceColor(tx.TradePrice):"#9ca3af",color:"#fff",weight:1,opacity:.8,fillOpacity:.6});cm.bindPopup(buildTxPopup(tx,area.name),{maxWidth:220}),txMarkerLayer.addLayer(cm)})}),console.log(`[PIN] showAllTransactionPins: ${totalPins} total pins created`)}function showMapLoading(areaName,pct){const overlay=document.getElementById("map-loading-overlay");overlay&&(overlay.classList.remove("hidden"),updateMapLoading(areaName,pct))}function updateMapLoading(label,pct){const textEl=document.getElementById("map-loading-text"),barEl=document.getElementById("map-loading-bar");textEl&&(textEl.textContent=label),barEl&&(barEl.style.width=pct+"%")}function hideMapLoading(){const overlay=document.getElementById("map-loading-overlay");overlay&&overlay.classList.add("hidden")}let txMarkersByIdx={};function showTransactionPins(area){if(!txMarkerLayer)return;txMarkerLayer.clearLayers(),txMarkersByIdx={};const transactions=(AREAS.find(a=>a.id===area.id)||area)._liveTransactions;if(!transactions)return;let pinCount=0;transactions.forEach((tx,i)=>{const pos=estimateTxPosition(area,tx,i),hasPrice=null!=tx.TradePrice&&!isNaN(tx.TradePrice),cm=L.circleMarker([pos.lat,pos.lng],{radius:7,fillColor:hasPrice?priceColor(tx.TradePrice):"#9ca3af",color:"#fff",weight:1.5,opacity:.9,fillOpacity:hasPrice?.7:.4});cm.bindPopup(buildTxPopup(tx,area.name),{maxWidth:240}),txMarkerLayer.addLayer(cm),txMarkersByIdx[i]={marker:cm,pos:pos},pinCount++}),console.log(`[PIN] showTransactionPins: ${area.name} — ${pinCount} pins created from ${transactions.length} transactions`)}function flyToTransaction(idx){const entry=txMarkersByIdx[idx];entry&&mapInstance&&(mapInstance.flyTo([entry.pos.lat,entry.pos.lng],16,{duration:.6}),setTimeout(()=>{entry.marker.setRadius(12),entry.marker.openPopup(),setTimeout(()=>entry.marker.setRadius(7),2e3)},650))}function buildTxPopup(tx,cityName){return`\n    <div style="font-family:'Noto Sans JP',sans-serif;font-size:12px;line-height:1.6;">\n      <div style="font-weight:700;font-size:14px;color:#1e40af;margin-bottom:4px;">${null!=tx.TradePrice&&!isNaN(tx.TradePrice)?tx.TradePrice>=1e4?`${(tx.TradePrice/1e4).toFixed(0)}万円`:`${tx.TradePrice.toLocaleString()}円`:"価格不明"}</div>\n      <table style="font-size:11px;">\n        ${tx.District?`<tr><td style="color:#6b7280;padding-right:8px;">地区</td><td>${tx.District}</td></tr>`:""}\n        ${tx.Area?`<tr><td style="color:#6b7280;padding-right:8px;">面積</td><td>${tx.Area}m²</td></tr>`:""}\n        ${tx.Type||tx.Use?`<tr><td style="color:#6b7280;padding-right:8px;">種別</td><td>${tx.Type||tx.Use}</td></tr>`:""}\n        ${tx.NearestStation?`<tr><td style="color:#6b7280;padding-right:8px;">最寄駅</td><td>${tx.NearestStation}${tx.DistanceToStation?` (${tx.DistanceToStation})`:""}</td></tr>`:""}\n        ${tx.BuildingYear?`<tr><td style="color:#6b7280;padding-right:8px;">築年</td><td>${tx.BuildingYear}</td></tr>`:""}\n        ${tx.Structure?`<tr><td style="color:#6b7280;padding-right:8px;">構造</td><td>${tx.Structure}</td></tr>`:""}\n      </table>\n      <div style="font-size:10px;color:#9ca3af;margin-top:4px;">${cityName}</div>\n    </div>`}function createMapIcon(color,rank,score,isSelected){const size=isSelected?48:40,svgString=`\n    <svg width="${size}" height="${size}" xmlns="http://www.w3.org/2000/svg" style="${isSelected?"filter: drop-shadow(0 2px 6px rgba(0,0,0,0.3));":"filter: drop-shadow(0 1px 3px rgba(0,0,0,0.2));"}">\n      <circle cx="${size/2}" cy="${size/2}" r="${size/2-2}" fill="${color}" opacity="0.9" stroke="white" stroke-width="${isSelected?3:2}"/>\n      <text x="${size/2}" y="${size/2-2}" text-anchor="middle" fill="white" font-size="${isSelected?11:10}" font-weight="500" font-family="sans-serif">${rank}位</text>\n      <text x="${size/2}" y="${size/2+10}" text-anchor="middle" fill="white" font-size="${isSelected?13:11}" font-weight="700" font-family="sans-serif">${score}</text>\n    </svg>`;return L.icon({iconUrl:"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(svgString))),iconSize:[size,size],iconAnchor:[size/2,size/2],popupAnchor:[0,-size/2],tooltipAnchor:[0,-size/2]})}function updateMapSidebar(area,ranked){const sidebar=document.getElementById("map-sidebar");if(!sidebar)return;const rankedArea=ranked.find(a=>a.id===area.id)||area,canonical=AREAS.find(a=>a.id===area.id)||area;area=rankedArea;const rank=ranked.findIndex(a=>a.id===area.id)+1,medalStr=rank<=3?["🥇","🥈","🥉"][rank-1]:`${rank}位`,isFullLoaded=AREA_FULL_LOADED.has(area.id),isFetching=_currentFetchAreaId===area.id,txCount=canonical._liveTransactions?canonical._liveTransactions.length:0,loadingBadge=isFetching?'<span class="inline-flex items-center gap-1 text-xs text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full mb-2"><span class="w-1.5 h-1.5 rounded-full bg-blue-500 animate-pulse"></span>詳細データ取得中...</span>':isFullLoaded?`<span class="text-xs text-green-600 bg-green-50 px-2 py-0.5 rounded-full mb-2">✅ 全期間データ取得済み（${txCount}件）</span>`:`<span class="text-xs text-gray-400 mb-2">概要データのみ（${txCount}件）</span>`,txSection=txCount>0?renderTransactionList(canonical._liveTransactions):"connected"===state.mcpStatus?'<p class="text-xs text-gray-400 mt-2">取引データなし</p>':'<p class="text-xs text-gray-400 mt-2">MCPに接続すると取引データが表示されます</p>';sidebar.innerHTML=`\n    <div class="sidebar-header">\n      <div class="flex items-center justify-between">\n        <div class="flex items-center gap-2">\n          <span class="text-xl">${medalStr}</span>\n          <h3 class="text-lg font-bold text-gray-900">${area.name}</h3>\n        </div>\n        <span class="text-2xl font-bold text-blue-600">${area.scores.total}<span class="text-xs font-normal text-gray-400">pt</span></span>\n      </div>\n    </div>\n    <div class="sidebar-body space-y-4">\n      ${loadingBadge}\n      \x3c!-- Key metrics --\x3e\n      <div class="grid grid-cols-2 gap-2">\n        <div class="bg-blue-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">住宅地価格</div>\n          <div class="text-sm font-bold text-blue-700">${(area.residentialPrice/1e4).toFixed(1)}万/m²</div>\n        </div>\n        <div class="bg-green-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">名古屋まで</div>\n          <div class="text-sm font-bold text-green-700">${area.accessToNagoya}分</div>\n        </div>\n        <div class="bg-amber-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">地価変動</div>\n          <div class="text-sm font-bold text-amber-700">+${area.yoyChange}%</div>\n        </div>\n        <div class="bg-purple-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">人口</div>\n          <div class="text-sm font-bold text-purple-700">${(area.population/1e4).toFixed(1)}万人</div>\n        </div>\n      </div>\n\n      \x3c!-- Live average price --\x3e\n      ${area._liveAvgTradePrice?`\n        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">\n          <div class="flex items-center gap-2 mb-1">\n            <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span>\n            <span class="text-xs font-medium text-blue-700">LIVE 平均取引価格</span>\n          </div>\n          <div class="text-lg font-bold text-blue-800">${(area._liveAvgTradePrice/1e4).toFixed(0)}万円</div>\n          <div class="text-xs text-blue-500">${area._liveTransactionCount}件の取引データから算出</div>\n        </div>\n      `:""}\n\n      \x3c!-- Description --\x3e\n      <div>\n        <p class="text-xs text-gray-600 leading-relaxed">${area.description}</p>\n      </div>\n\n      \x3c!-- Highlights --\x3e\n      <div class="bg-green-50 rounded-lg p-3">\n        <div class="text-xs font-bold text-green-700 mb-2">✅ ポイント</div>\n        ${area.highlights.map(h=>`<div class="text-xs text-green-800 mb-1">• ${h}</div>`).join("")}\n      </div>\n\n      \x3c!-- Transaction data --\x3e\n      <div>\n        <div class="flex items-center justify-between mb-2">\n          <div class="text-xs font-bold text-gray-700">📊 取引データ</div>\n          <div class="text-xs text-gray-400">${area._liveTransactions?area._liveTransactions.length+"件":""}</div>\n        </div>\n        ${txSection}\n        ${area._liveTransactions&&area._liveTransactions.length>0?'\n          <div class="mt-2 flex flex-wrap gap-1 items-center">\n            <span class="text-xs text-gray-400">凡例:</span>\n            <span class="inline-flex items-center gap-1 text-xs"><span style="width:8px;height:8px;border-radius:50%;background:#22c55e;display:inline-block;"></span>~500万</span>\n            <span class="inline-flex items-center gap-1 text-xs"><span style="width:8px;height:8px;border-radius:50%;background:#3b82f6;display:inline-block;"></span>~1500万</span>\n            <span class="inline-flex items-center gap-1 text-xs"><span style="width:8px;height:8px;border-radius:50%;background:#f59e0b;display:inline-block;"></span>~3000万</span>\n            <span class="inline-flex items-center gap-1 text-xs"><span style="width:8px;height:8px;border-radius:50%;background:#ef4444;display:inline-block;"></span>~5000万</span>\n            <span class="inline-flex items-center gap-1 text-xs"><span style="width:8px;height:8px;border-radius:50%;background:#7c3aed;display:inline-block;"></span>5000万~</span>\n          </div>\n        ':""}\n      </div>\n\n      \x3c!-- Action buttons --\x3e\n      <div class="flex gap-2">\n        <button data-map-to-detail="${area.id}" class="flex-1 px-3 py-2 bg-blue-600 text-white rounded-lg text-xs font-medium hover:bg-blue-700 transition-colors text-center">\n          🔍 詳細を見る\n        </button>\n        <button data-map-zoom-out class="px-3 py-2 bg-gray-100 text-gray-600 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors">\n          🗺️ 全体表示\n        </button>\n      </div>\n    </div>\n  `;const detailBtn=sidebar.querySelector("[data-map-to-detail]");detailBtn&&detailBtn.addEventListener("click",()=>{state.selectedAreaId=area.id,state.view="detail",render()});const zoomOutBtn=sidebar.querySelector("[data-map-zoom-out]");zoomOutBtn&&zoomOutBtn.addEventListener("click",()=>{state.mapSelectedAreaId=null,mapInstance&&mapInstance.flyTo([34.98,136.56],10,{duration:.8});const ranked2=getRankedAreas();ranked2.forEach((a,i)=>{const c=COLORS[AREAS.findIndex(x=>x.id===a.id)%COLORS.length];mapMarkers[a.id]&&mapMarkers[a.id].setIcon(createMapIcon(c,i+1,a.scores.total,!1))}),showAllTransactionPins(ranked2),sidebar.innerHTML='\n        <div class="flex flex-col items-center justify-center h-full text-center p-8">\n          <div class="text-4xl mb-3">📍</div>\n          <p class="text-sm font-medium text-gray-700 mb-1">エリアを選択してください</p>\n          <p class="text-xs text-gray-400">マップ上のマーカーをクリックすると<br>土地情報・取引データが表示されます</p>\n        </div>'}),sidebar.querySelectorAll("tr[data-tx-idx]").forEach(row=>{row.addEventListener("click",()=>{const idx=parseInt(row.dataset.txIdx);sidebar.querySelectorAll("tr.tx-active").forEach(r=>r.classList.remove("tx-active")),row.classList.add("tx-active"),flyToTransaction(idx)})})}function updateDistrictSidebar(area,districtName,ranked){const sidebar=document.getElementById("map-sidebar");if(!sidebar)return;const metrics=aggregateDistrictMetrics(area,districtName);if(!metrics)return void(sidebar.innerHTML='<div class="p-4 text-sm text-gray-500">地区データなし</div>');const avgPriceStr=metrics.avgPrice?`${(metrics.avgPrice/1e4).toFixed(0)}万円`:"-",priceRange=metrics.minPrice&&metrics.maxPrice?`${(metrics.minPrice/1e4).toFixed(0)}〜${(metrics.maxPrice/1e4).toFixed(0)}万円`:"-",m2PriceStr=metrics.avgPricePerM2?`${(metrics.avgPricePerM2/1e4).toFixed(1)}万/m²`:"-",stationStr=metrics.nearestStation||"-",nagoyaStr=metrics.nagoyaMin?`約${metrics.nagoyaMin}分`:`約${area.accessToNagoya}分`,distStr=metrics.avgDistance?`徒歩${metrics.avgDistance}分`:"-",ageStr=null!==metrics.avgBuildingAge?`築${metrics.avgBuildingAge}年`:"-",typeColors={"宅地(土地)":"#22c55e","宅地(土地と建物)":"#3b82f6","中古マンション等":"#f59e0b","農地":"#84cc16","林地":"#14b8a6"},typeBar=metrics.typeDistribution.map(t=>{const color=typeColors[t.name]||"#9ca3af";return`<div style="width:${t.pct}%;background:${color};height:100%;display:inline-block;" title="${t.name} ${t.pct}%"></div>`}).join(""),typeLegend=metrics.typeDistribution.slice(0,4).map(t=>`<span class="inline-flex items-center gap-1 text-xs"><span style="width:6px;height:6px;border-radius:50%;background:${typeColors[t.name]||"#9ca3af"};display:inline-block;"></span>${t.name.replace("宅地(","").replace(")","").replace("中古マンション等","マンション")} ${t.pct}%</span>`).join(" "),txSection=renderTransactionList(metrics.transactions);sidebar.innerHTML=`\n    <div class="sidebar-header">\n      <button id="btn-back-to-city" class="flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 mb-2 cursor-pointer" style="background:none;border:none;padding:0;">\n        ← ${area.name}に戻る\n      </button>\n      <div class="flex items-center justify-between">\n        <h3 class="text-lg font-bold text-gray-900">📍 ${districtName}</h3>\n        <span class="text-sm font-medium text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full">${metrics.count}件</span>\n      </div>\n    </div>\n    <div class="sidebar-body space-y-4">\n      \x3c!-- Key metrics --\x3e\n      <div class="grid grid-cols-2 gap-2">\n        <div class="bg-blue-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">平均取引価格</div>\n          <div class="text-sm font-bold text-blue-700">${avgPriceStr}</div>\n        </div>\n        <div class="bg-indigo-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">㎡単価</div>\n          <div class="text-sm font-bold text-indigo-700">${m2PriceStr}</div>\n        </div>\n        <div class="bg-green-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">最寄駅</div>\n          <div class="text-sm font-bold text-green-700" style="font-size:11px;">${stationStr}</div>\n        </div>\n        <div class="bg-emerald-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">名古屋まで</div>\n          <div class="text-sm font-bold text-emerald-700">${nagoyaStr}</div>\n        </div>\n        <div class="bg-amber-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">駅距離</div>\n          <div class="text-sm font-bold text-amber-700">${distStr}</div>\n        </div>\n        <div class="bg-purple-50 rounded-lg p-2 text-center">\n          <div class="text-xs text-gray-500">平均築年数</div>\n          <div class="text-sm font-bold text-purple-700">${ageStr}</div>\n        </div>\n      </div>\n\n      \x3c!-- Price range --\x3e\n      <div class="bg-gray-50 rounded-lg p-2">\n        <div class="text-xs text-gray-500 mb-1">価格帯</div>\n        <div class="text-sm font-medium text-gray-700">${priceRange}</div>\n      </div>\n\n      \x3c!-- Type distribution --\x3e\n      ${metrics.typeDistribution.length>0?`\n        <div>\n          <div class="text-xs text-gray-500 mb-1">用途分布</div>\n          <div style="height:8px;border-radius:4px;overflow:hidden;background:#e5e7eb;display:flex;">${typeBar}</div>\n          <div class="mt-1 flex flex-wrap gap-2">${typeLegend}</div>\n        </div>\n      `:""}\n\n      \x3c!-- Transaction data --\x3e\n      <div>\n        <div class="text-xs font-bold text-gray-700 mb-2">📊 取引データ（${districtName}）</div>\n        ${txSection||'<p class="text-xs text-gray-400">取引データなし</p>'}\n      </div>\n\n      \x3c!-- Action buttons --\x3e\n      <div class="flex gap-2">\n        <button id="btn-district-back" class="flex-1 px-3 py-2 bg-gray-100 text-gray-600 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors text-center">\n          ↩ ${area.name}へ戻る\n        </button>\n        <button data-map-zoom-out class="px-3 py-2 bg-gray-100 text-gray-600 rounded-lg text-xs font-medium hover:bg-gray-200 transition-colors">\n          🗺️ 全体表示\n        </button>\n      </div>\n    </div>\n  `;const backBtn=sidebar.querySelector("#btn-back-to-city"),backBtn2=sidebar.querySelector("#btn-district-back"),goBack=()=>{state.mapSelectedDistrict=null,updateMapSidebar(area,ranked),showTransactionPins(area)};backBtn&&backBtn.addEventListener("click",goBack),backBtn2&&backBtn2.addEventListener("click",goBack);const zoomOutBtn=sidebar.querySelector("[data-map-zoom-out]");zoomOutBtn&&zoomOutBtn.addEventListener("click",()=>{state.mapSelectedAreaId=null,state.mapSelectedDistrict=null,mapInstance&&mapInstance.flyTo([34.98,136.56],10,{duration:.8});const ranked2=getRankedAreas();ranked2.forEach((a,i)=>{const c=COLORS[AREAS.findIndex(x=>x.id===a.id)%COLORS.length];mapMarkers[a.id]&&mapMarkers[a.id].setIcon(createMapIcon(c,i+1,a.scores.total,!1))}),showAllTransactionPins(ranked2),sidebar.innerHTML='\n        <div class="flex flex-col items-center justify-center h-full text-center p-8">\n          <div class="text-4xl mb-3">📍</div>\n          <p class="text-sm font-medium text-gray-700 mb-1">エリアを選択してください</p>\n          <p class="text-xs text-gray-400">マップ上のマーカーをクリックすると<br>土地情報・取引データが表示されます</p>\n        </div>'}),sidebar.querySelectorAll("tr[data-tx-idx]").forEach(row=>{row.addEventListener("click",()=>{const idx=parseInt(row.dataset.txIdx);sidebar.querySelectorAll("tr.tx-active").forEach(r=>r.classList.remove("tx-active")),row.classList.add("tx-active"),flyToTransaction(idx)})})}function renderTransactionList(transactions){if(!transactions||0===transactions.length)return"";const validTx=[...transactions.map((t,i)=>({...t,_origIdx:void 0!==t._areaIdx?t._areaIdx:i}))];return 0===validTx.length?'<p class="text-xs text-gray-400">取引データなし</p>':(validTx.sort((a,b)=>{const pa=null==a.TradePrice||isNaN(a.TradePrice)?-1:a.TradePrice;return(null==b.TradePrice||isNaN(b.TradePrice)?-1:b.TradePrice)-pa}),`\n    <div style="max-height: 300px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: 8px;">\n      <table class="tx-table">\n        <thead>\n          <tr>\n            <th>価格</th>\n            <th>面積</th>\n            <th>地区</th>\n            <th>最寄駅</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${validTx.map(t=>{const hasP=null!=t.TradePrice&&!isNaN(t.TradePrice),pStr=hasP?t.TradePrice>=1e4?(t.TradePrice/1e4).toFixed(0)+"万":t.TradePrice.toLocaleString()+"円":"-";return`\n            <tr data-tx-idx="${t._origIdx}" title="クリックで地図上のピンへ移動">\n              <td class="font-medium" style="color:${hasP?priceColor(t.TradePrice):"#9ca3af"}">${pStr}</td>\n              <td>${t.Area?t.Area+"m²":"-"}</td>\n              <td class="text-gray-500" style="max-width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${t.District||"-"}</td>\n              <td class="text-gray-500" style="max-width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${t.NearestStation||"-"}</td>\n            </tr>`}).join("")}\n        </tbody>\n      </table>\n    </div>\n  `)}function renderFooter(){return'\n    <footer style="margin-top:32px;padding:24px 16px;border-top:1px solid #e5e7eb;max-width:640px;margin-left:auto;margin-right:auto;">\n      <div style="text-align:center;">\n        <div style="margin-bottom:16px;">\n          <div style="font-size:11px;color:#9ca3af;margin-bottom:6px;">エリア</div>\n          <div><a href="/area/mie/yokkaichi/" style="color:#6b7280;text-decoration:none;font-size:12px;">四日市市</a> <span style="color:#d1d5db;">·</span> <a href="/area/mie/kuwana/" style="color:#6b7280;text-decoration:none;font-size:12px;">桑名市</a> <span style="color:#d1d5db;">·</span> <a href="/area/mie/suzuka/" style="color:#6b7280;text-decoration:none;font-size:12px;">鈴鹿市</a> <span style="color:#d1d5db;">·</span> <a href="/area/mie/inabe/" style="color:#6b7280;text-decoration:none;font-size:12px;">いなべ市</a> <span style="color:#d1d5db;">·</span> <a href="/area/mie/kameyama/" style="color:#6b7280;text-decoration:none;font-size:12px;">亀山市</a> <span style="color:#d1d5db;">·</span> <a href="/area/mie/komono/" style="color:#6b7280;text-decoration:none;font-size:12px;">菰野町</a> <span style="color:#d1d5db;">·</span> <a href="/area/mie/toin/" style="color:#6b7280;text-decoration:none;font-size:12px;">東員町</a></div>\n        </div>\n        <div style="margin-bottom:16px;">\n          <div style="font-size:11px;color:#9ca3af;margin-bottom:6px;">コンテンツ</div>\n          <a href="/knowledge/" style="color:#6b7280;text-decoration:none;font-size:12px;">知識記事</a>\n          <span style="color:#d1d5db;">·</span>\n          <a href="/about/" style="color:#6b7280;text-decoration:none;font-size:12px;">運営者情報</a>\n        </div>\n        <div style="margin-top:16px;padding-top:12px;border-top:1px solid #f3f4f6;">\n          <p style="font-size:11px;color:#9ca3af;margin:0 0 4px;">データ出典: <a href="https://www.reinfolib.mlit.go.jp/" style="color:#9ca3af;" rel="noopener">国土交通省 不動産情報ライブラリ</a> ｜ 更新: 2026-02-24</p>\n          <p style="font-size:11px;color:#b0b0b0;margin:0;">© 2025 <a href="/about/" style="color:#b0b0b0;text-decoration:none;">注文住宅比較.com</a></p>\n        </div>\n      </div>\n    </footer>\n  '}function destroyCharts(){Object.values(state.charts).forEach(c=>{try{c.destroy()}catch{}}),state.charts={}}function destroyCmpCharts(){Object.values(state.cmpCharts).forEach(c=>{try{c.destroy()}catch{}}),state.cmpCharts={}}function renderModalSeoContent(areaId){const seo=CITY_SEO_DATA[areaId];if(!seo)return"";let html='<hr style="margin:20px 0;border-color:#e5e7eb;">';seo.tips&&seo.tips.length>0&&(html+='<div style="margin-bottom:16px;">',html+=seo.tips.map(t=>`\n      <div style="background:#eff6ff;border:1px solid #bfdbfe;border-radius:12px;padding:14px 16px;margin-bottom:10px;">\n        <div style="font-size:13px;font-weight:700;color:#1d4ed8;margin-bottom:6px;">🏠 ${t.title}</div>\n        <div style="font-size:13px;color:#1e3a5f;line-height:1.7;">${t.body}</div>\n      </div>\n    `).join(""),html+="</div>"),seo.faqs&&seo.faqs.length>0&&(html+='<div style="margin-bottom:16px;">\n      <div style="font-size:14px;font-weight:700;color:#1f2937;margin-bottom:10px;">❓ よくある質問</div>',html+=seo.faqs.map(f=>`\n      <div class="border border-gray-200 rounded-lg overflow-hidden" style="margin-bottom:6px;">\n        <button style="width:100%;text-align:left;padding:10px 14px;display:flex;align-items:center;justify-content:space-between;background:#f9fafb;border:none;cursor:pointer;font-size:13px;font-weight:500;color:#1f2937;" onclick="this.parentElement.classList.toggle('faq-open')">\n          <span>${f.question}</span>\n          <svg style="width:16px;height:16px;color:#9ca3af;flex-shrink:0;transition:transform 0.2s;" class="faq-chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>\n        </button>\n        <div class="faq-answer" style="padding:10px 14px;font-size:13px;color:#4b5563;line-height:1.7;border-top:1px solid #f3f4f6;">${f.answer}</div>\n      </div>\n    `).join(""),html+="</div>");const checklist=CITY_SEO_DATA._checklist;checklist&&checklist.length>0&&(html+='<div style="margin-bottom:16px;">\n      <div style="font-size:14px;font-weight:700;color:#1f2937;margin-bottom:4px;">✅ 土地購入前チェックリスト</div>\n      <div style="font-size:11px;color:#9ca3af;margin-bottom:8px;">チェック状態はブラウザに自動保存されます</div>',seo.checklist_notes&&(html+=`<div style="background:#fffbeb;border:1px solid #fde68a;border-radius:8px;padding:10px 12px;margin-bottom:10px;font-size:12px;color:#92400e;">💡 ${seo.checklist_notes}</div>`),html+=`<div style="font-size:13px;font-weight:600;color:#2563eb;margin-bottom:8px;" id="cl-progress">0/${checklist.length} 完了</div>`,html+=checklist.map(item=>`\n      <label style="display:flex;align-items:flex-start;gap:10px;padding:10px 12px;border-radius:8px;border:1px solid #f3f4f6;margin-bottom:4px;cursor:pointer;" data-cl-id="${item.id}">\n        <input type="checkbox" style="margin-top:3px;width:16px;height:16px;cursor:pointer;" data-cl-check="${item.id}" onchange="clUpdate('${areaId}')">\n        <div>\n          <div style="font-size:13px;font-weight:500;color:#1f2937;">${item.label}</div>\n          <div style="font-size:11px;color:#6b7280;margin-top:2px;">${item.detail}</div>\n        </div>\n      </label>\n    `).join(""),html+="</div>"),seo.neighbors&&seo.neighbors.length>0&&(html+=`<div style="margin-bottom:16px;">\n      <div style="font-size:14px;font-weight:700;color:#1f2937;margin-bottom:8px;">🔗 近隣エリアの注文住宅情報</div>\n      <div style="display:flex;flex-wrap:wrap;gap:6px;">\n        ${seo.neighbors.map(n=>`<a href="/area/mie/${n.id}/" style="padding:6px 14px;background:#fff;border:1px solid #e5e7eb;border-radius:8px;font-size:12px;font-weight:500;color:#374151;text-decoration:none;">${n.name} →</a>`).join("")}\n      </div>\n    </div>`),html+='\n    <div style="background:linear-gradient(135deg,#eff6ff,#eef2ff);border:1px solid #bfdbfe;border-radius:12px;padding:20px;margin-bottom:16px;text-align:center;">\n      <div style="font-size:14px;font-weight:700;color:#1f2937;margin-bottom:6px;">具体的な物件が見つかったら...</div>\n      <div style="font-size:12px;color:#4b5563;margin-bottom:12px;">AIが複数物件を自動比較。SUUMO・ホームズ等のURLを貼るだけで、見やすい比較表を作成します。</div>\n      <a href="/" style="display:inline-flex;align-items:center;gap:6px;padding:10px 20px;background:#2563eb;color:white;border-radius:8px;font-size:13px;font-weight:500;text-decoration:none;">🏠 注文住宅比較.comで物件を比較する →</a>\n    </div>';const pageUrl=seo.cityUrl?"https://research.chuumon-soudan.com"+seo.cityUrl:window.location.href,pageTitle=seo.nameJa?seo.nameJa+"で注文住宅｜土地相場・費用シミュレーション":document.title,encodedUrl=encodeURIComponent(pageUrl);return html+=`\n    <div style="display:flex;align-items:center;justify-content:center;gap:8px;flex-wrap:wrap;padding:12px 0;">\n      <span style="font-size:11px;color:#9ca3af;">このページをシェア:</span>\n      <a href="https://twitter.com/intent/tweet?url=${encodedUrl}&text=${encodeURIComponent(pageTitle)}" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:4px;padding:5px 12px;background:#000;color:white;border-radius:6px;font-size:11px;font-weight:500;text-decoration:none;">𝕏 ポスト</a>\n      <a href="https://social-plugins.line.me/lineit/share?url=${encodedUrl}" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:4px;padding:5px 12px;background:#06c755;color:white;border-radius:6px;font-size:11px;font-weight:500;text-decoration:none;">LINE</a>\n      <a href="https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:4px;padding:5px 12px;background:#1877f2;color:white;border-radius:6px;font-size:11px;font-weight:500;text-decoration:none;">Facebook</a>\n    </div>`,html}function openCmpDetailModal(areaId){const area=getRankedAreas().find(a=>a.id===areaId);if(!area)return;const scoreKeys=["price","access","growth","living","family","nature"],SCORE_LABELS_LONG={price:"価格の手頃さ",access:"名古屋アクセス",growth:"資産価値上昇",living:"生活利便性",family:"子育て環境",nature:"自然環境"},SCORE_COLORS={price:"#3b82f6",access:"#10b981",growth:"#f59e0b",living:"#ef4444",family:"#8b5cf6",nature:"#06b6d4"},body=document.getElementById("cmp-detail-modal-body");body.innerHTML=`\n    <div class="flex items-center justify-between mb-4">\n      <h2 class="text-xl font-bold text-gray-900">${area.name}</h2>\n      <button id="cmp-close-detail" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200 transition text-lg">&times;</button>\n    </div>\n    <p class="text-sm text-gray-600 mb-4 leading-relaxed">${area.description}</p>\n    <div class="text-center mb-4">\n      <span class="text-4xl font-bold text-blue-600">${area.scores.total}</span>\n      <span class="text-sm text-gray-400 ml-1">/ 100点</span>\n    </div>\n    <div style="position:relative; height:240px; margin-bottom:16px;">\n      <canvas id="cmp-radar-modal"></canvas>\n    </div>\n    <div class="grid grid-cols-3 gap-2 mb-4">\n      ${scoreKeys.map(k=>`\n        <div class="text-center">\n          <div class="text-xs text-gray-400">${SCORE_LABELS_LONG[k]}</div>\n          <div class="text-lg font-bold" style="color:${SCORE_COLORS[k]}">${area.scores[k]}</div>\n        </div>\n      `).join("")}\n    </div>\n    <hr class="mb-4">\n    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4">\n      <div class="text-center p-3 bg-blue-50 rounded-xl">\n        <div class="text-xs text-gray-500 mb-1">住宅地価格</div>\n        <div class="text-sm font-bold text-blue-700">${(area.residentialPrice/1e4).toFixed(1)}万/m²</div>\n      </div>\n      <div class="text-center p-3 bg-green-50 rounded-xl">\n        <div class="text-xs text-gray-500 mb-1">名古屋まで</div>\n        <div class="text-sm font-bold text-green-700">${area.accessToNagoya}分</div>\n      </div>\n      <div class="text-center p-3 bg-amber-50 rounded-xl">\n        <div class="text-xs text-gray-500 mb-1">地価変動</div>\n        <div class="text-sm font-bold text-amber-700">+${area.yoyChange}%</div>\n      </div>\n      <div class="text-center p-3 bg-purple-50 rounded-xl">\n        <div class="text-xs text-gray-500 mb-1">人口</div>\n        <div class="text-sm font-bold text-purple-700">${(area.population/1e4).toFixed(1)}万人</div>\n      </div>\n    </div>\n    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4">\n      <div class="flex items-center gap-2 text-sm"><span class="text-gray-400">🏥</span><span class="text-gray-600">医療 ${area.hospitals}件</span></div>\n      <div class="flex items-center gap-2 text-sm"><span class="text-gray-400">🏫</span><span class="text-gray-600">学校 ${area.schools}校</span></div>\n      <div class="flex items-center gap-2 text-sm"><span class="text-gray-400">🌳</span><span class="text-gray-600">公園 ${area.parks}箇所</span></div>\n      <div class="flex items-center gap-2 text-sm"><span class="text-gray-400">🛒</span><span class="text-gray-600">商業 ${area.shopping}件</span></div>\n    </div>\n    <div class="mb-4">\n      <div class="text-xs font-semibold text-gray-500 mb-2">おすすめエリア</div>\n      <div class="flex flex-wrap gap-2">\n        ${area.recAreas.map(r=>`<span class="text-xs px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full">${r}</span>`).join("")}\n      </div>\n    </div>\n    ${area.risks.length?`\n    <div class="mb-4">\n      <div class="text-xs font-semibold text-gray-500 mb-2">注意点</div>\n      <div class="flex flex-wrap gap-2">\n        ${area.risks.map(r=>`<span class="text-xs px-3 py-1.5 bg-red-50 text-red-600 rounded-full">${r}</span>`).join("")}\n      </div>\n    </div>\n    `:""}\n    <div class="bg-gray-50 rounded-xl p-4">\n      <div class="text-xs font-semibold text-gray-500 mb-2">地価推移（2020-2025）</div>\n      <div style="position:relative; height:180px;">\n        <canvas id="cmp-trend-modal"></canvas>\n      </div>\n    </div>\n    <div style="margin-top:16px; text-center; text-align:center;">\n      <button style="display:inline-block; padding:10px 24px; background:#059669; color:#fff; border:none; border-radius:8px; font-size:14px; font-weight:600; cursor:pointer;" data-cmp-goto-map="${area.id}">🗺️ 地図で見る</button>\n    </div>\n    ${renderModalSeoContent(area.id)}\n  `,document.getElementById("cmp-detail-modal").classList.add("open"),document.getElementById("cmp-close-detail").addEventListener("click",()=>closeCmpModal("cmp-detail-modal"));const mapBtn=body.querySelector("[data-cmp-goto-map]");mapBtn&&mapBtn.addEventListener("click",()=>{closeCmpModal("cmp-detail-modal"),state.mapSelectedAreaId=areaId,state.view="map",render()}),"function"==typeof clRestore&&setTimeout(()=>clRestore(areaId),100),ensureChartJs().then(()=>{setTimeout(()=>{destroyCmpCharts();const radarCtx=document.getElementById("cmp-radar-modal");radarCtx&&(state.cmpCharts.radar=new Chart(radarCtx,{type:"radar",data:{labels:scoreKeys.map(k=>SCORE_LABELS_LONG[k]),datasets:[{data:scoreKeys.map(k=>area.scores[k]),backgroundColor:"rgba(59,130,246,0.15)",borderColor:"#3b82f6",borderWidth:2,pointBackgroundColor:"#3b82f6",pointRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{r:{min:0,max:100,ticks:{stepSize:25,font:{size:10}},pointLabels:{font:{size:11,family:"Noto Sans JP"}}}},plugins:{legend:{display:!1}}}}));const trendCtx=document.getElementById("cmp-trend-modal");trendCtx&&(state.cmpCharts.trend=new Chart(trendCtx,{type:"line",data:{labels:area.trend.map(t=>t.y),datasets:[{data:area.trend.map(t=>t.p),borderColor:"#3b82f6",backgroundColor:"rgba(59,130,246,0.1)",fill:!0,tension:.3,pointRadius:4,pointBackgroundColor:"#3b82f6"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{callback:v=>`${(v/1e4).toFixed(1)}万`,font:{size:10}}},x:{ticks:{font:{size:10}}}},plugins:{legend:{display:!1}}}}))},100)})}function openCmpColModal(){document.getElementById("cmp-col-modal-body").innerHTML=`\n    <div class="flex items-center justify-between mb-5">\n      <h2 class="text-lg font-bold text-gray-900">表示項目を選択</h2>\n      <button id="cmp-close-col" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200 transition text-lg">&times;</button>\n    </div>\n    <div class="space-y-2 mb-5">\n      ${CMP_COLUMNS.map(c=>`\n        <label class="flex items-center gap-3 p-2.5 rounded-lg hover:bg-gray-50 cursor-pointer transition">\n          <input type="checkbox" class="cmp-col-checkbox rounded" data-cmp-col-key="${c.key}" ${state.cmpSelectedColumns.includes(c.key)?"checked":""}>\n          <span class="text-sm">${c.icon} ${c.label}</span>\n        </label>\n      `).join("")}\n    </div>\n    <div class="flex justify-end gap-3">\n      <button id="cmp-cancel-col" class="px-4 py-2 text-sm text-gray-600 rounded-lg hover:bg-gray-100 transition">キャンセル</button>\n      <button id="cmp-apply-col" class="px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium">適用</button>\n    </div>\n  `,document.getElementById("cmp-col-modal").classList.add("open"),document.getElementById("cmp-close-col").addEventListener("click",()=>closeCmpModal("cmp-col-modal")),document.getElementById("cmp-cancel-col").addEventListener("click",()=>closeCmpModal("cmp-col-modal")),document.getElementById("cmp-apply-col").addEventListener("click",()=>{const checks=document.querySelectorAll(".cmp-col-checkbox:checked");state.cmpSelectedColumns=Array.from(checks).map(c=>c.dataset.cmpColKey),0===state.cmpSelectedColumns.length&&(state.cmpSelectedColumns=["total"]),closeCmpModal("cmp-col-modal"),render()})}function closeCmpModal(id){const el=document.getElementById(id);el&&el.classList.remove("open"),"cmp-detail-modal"===id&&destroyCmpCharts()}function drawCompareCharts(ranked){}function drawDetailCharts(area){destroyCharts();const radarCtx=document.getElementById("chart-radar");radarCtx&&(state.charts.radar=new Chart(radarCtx,{type:"radar",data:{labels:["価格","交通","成長性","利便性","子育て","自然"],datasets:[{label:area.name,data:[area.scores.price,area.scores.access,area.scores.growth,area.scores.living,area.scores.family,area.scores.nature],backgroundColor:"#3b82f630",borderColor:"#3b82f6",borderWidth:2,pointBackgroundColor:"#3b82f6",pointRadius:4}]},options:{responsive:!0,plugins:{legend:{display:!1}},scales:{r:{beginAtZero:!0,max:100,ticks:{font:{size:10},stepSize:20},pointLabels:{font:{size:12}}}}}}));const trendCtx=document.getElementById("chart-detail-trend");trendCtx&&(state.charts.detailTrend=new Chart(trendCtx,{type:"line",data:{labels:area.trend.map(t=>t.y),datasets:[{label:`${area.name} 地価推移`,data:area.trend.map(t=>t.p),borderColor:"#3b82f6",backgroundColor:"#3b82f615",borderWidth:3,pointRadius:5,pointBackgroundColor:"#3b82f6",tension:.3,fill:!0}]},options:{responsive:!0,plugins:{legend:{display:!1}},scales:{y:{title:{display:!0,text:"円/m²",font:{size:11}}}}}}))}function bindEvents(ranked){document.querySelectorAll("[data-tab]").forEach(btn=>{btn.addEventListener("click",()=>{state.view=btn.dataset.tab,closeMobileDrawer(),render()})}),document.querySelectorAll("input[data-weight]").forEach(slider=>{slider.addEventListener("input",e=>{const key=e.target.dataset.weight,val=parseInt(e.target.value);state.weights[key]=val;const vEl=document.getElementById(`wv-${key}`);vEl&&(vEl.textContent=val),e.target.style.background=`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${2*val}%, #e5e7eb ${2*val}%, #e5e7eb 100%)`,clearTimeout(state._renderTimeout),state._renderTimeout=setTimeout(()=>render(),150)})}),document.querySelectorAll("[data-area-detail]").forEach(el=>{el.addEventListener("click",()=>{openCmpDetailModal(el.dataset.areaDetail)})}),document.querySelectorAll("[data-area-switch]").forEach(btn=>{btn.addEventListener("click",()=>{state.selectedAreaId=btn.dataset.areaSwitch,render()})});const backBtn=document.getElementById("btn-back");backBtn&&backBtn.addEventListener("click",()=>{state.view="ranking",render()}),document.querySelectorAll("[data-weight-preset]").forEach(btn=>{btn.addEventListener("click",()=>{const preset=WEIGHT_PRESETS[btn.dataset.weightPreset];preset&&(state.weights={...preset.weights},render())})});const weightsToggle=document.getElementById("weights-toggle");weightsToggle&&weightsToggle.addEventListener("click",()=>{state.weightsExpanded=!state.weightsExpanded;const sliders=document.getElementById("weights-sliders");if(sliders){state.weightsExpanded?(sliders.style.maxHeight="300px",sliders.style.opacity="1",sliders.style.marginTop="16px"):(sliders.style.maxHeight="0",sliders.style.opacity="0",sliders.style.marginTop="0");const arrow=weightsToggle.querySelector("svg");arrow&&(arrow.style.transform=state.weightsExpanded?"rotate(180deg)":"")}}),document.querySelectorAll("[data-cmp-open-detail]").forEach(el=>{el.addEventListener("click",()=>openCmpDetailModal(el.dataset.cmpOpenDetail))}),document.querySelectorAll("[data-cmp-remove-col]").forEach(el=>{el.addEventListener("click",e=>{e.stopPropagation();const key=el.dataset.cmpRemoveCol;state.cmpSelectedColumns=state.cmpSelectedColumns.filter(k=>k!==key),0===state.cmpSelectedColumns.length&&(state.cmpSelectedColumns=["total"]),render()})});const colBtn=document.getElementById("cmp-open-col-modal");colBtn&&colBtn.addEventListener("click",()=>openCmpColModal()),document.querySelectorAll("[data-cmp-preset]").forEach(el=>{el.addEventListener("click",()=>{const preset=CMP_PRESETS[el.dataset.cmpPreset];preset&&(state.cmpSelectedColumns=[...preset.cols],render())})})}function csCalc(){const areaEl=document.getElementById("cs-area");if(!areaEl)return;const areaId=areaEl.value,area=AREAS.find(a=>a.id===areaId);if(!area)return;const landTsubo=parseInt(document.getElementById("cs-land").value),buildTsubo=parseInt(document.getElementById("cs-building").value),gradeEl=document.querySelector('input[name="cs-grade"]:checked'),grade=gradeEl?parseInt(gradeEl.value):65,downPayment=parseInt(document.getElementById("cs-down").value),rate=parseFloat(document.getElementById("cs-rate").value),years=parseInt(document.getElementById("cs-years").value);document.getElementById("cs-land-val").textContent=landTsubo,document.getElementById("cs-building-val").textContent=buildTsubo,document.getElementById("cs-down-val").textContent=downPayment,document.getElementById("cs-rate-val").textContent=rate.toFixed(2),document.getElementById("cs-years-val").textContent=years;const landPct=(landTsubo-30)/70*100;document.getElementById("cs-land").style.background="linear-gradient(to right,#3b82f6 0%,#3b82f6 "+landPct+"%,#e5e7eb "+landPct+"%,#e5e7eb 100%)";const buildPct=(buildTsubo-20)/40*100;document.getElementById("cs-building").style.background="linear-gradient(to right,#3b82f6 0%,#3b82f6 "+buildPct+"%,#e5e7eb "+buildPct+"%,#e5e7eb 100%)";const downPct=downPayment/2e3*100;document.getElementById("cs-down").style.background="linear-gradient(to right,#10b981 0%,#10b981 "+downPct+"%,#e5e7eb "+downPct+"%,#e5e7eb 100%)",document.querySelectorAll('[id^="cs-grade-"]').forEach(el=>{el.className=el.className.replace(/border-blue-500 bg-blue-50/g,"").trim()});const activeLabel=document.getElementById({50:"cs-grade-low-label",65:"cs-grade-std-label",85:"cs-grade-hi-label"}[String(grade)]);activeLabel&&(activeLabel.className+=" border-blue-500 bg-blue-50");const landCost=landTsubo*area.pricePerTsubo,buildCost=buildTsubo*grade*1e4,miscCost=Math.round(.08*(landCost+buildCost)),total=landCost+buildCost+miscCost,loanAmount=Math.max(0,total-1e4*downPayment);let monthly=0;if(loanAmount>0&&rate>0){const r=rate/100/12,n=12*years;monthly=Math.round(loanAmount*r*Math.pow(1+r,n)/(Math.pow(1+r,n)-1))}else loanAmount>0&&(monthly=Math.round(loanAmount/(12*years)));function fmtMan(yen){const man=Math.round(yen/1e4);return man>=1e4?(man/1e4).toFixed(1)+"億":man.toLocaleString()+"万円"}document.getElementById("cs-land-cost").textContent=fmtMan(landCost),document.getElementById("cs-build-cost").textContent=fmtMan(buildCost),document.getElementById("cs-misc-cost").textContent=fmtMan(miscCost),document.getElementById("cs-total").textContent=fmtMan(total),document.getElementById("cs-monthly").textContent=monthly>0?monthly.toLocaleString()+"円":"-"}document.querySelectorAll(".cmp-modal-overlay").forEach(m=>{m.addEventListener("click",e=>{e.target===m&&closeCmpModal(m.id)})}),document.addEventListener("keydown",e=>{"Escape"===e.key&&document.querySelectorAll(".cmp-modal-overlay.open").forEach(m=>closeCmpModal(m.id))}),loadDistrictCache(),render(),loadStaticData(),document.addEventListener("DOMContentLoaded",function(){setTimeout(csCalc,100)}),document.addEventListener("DOMContentLoaded",function(){var el=document.getElementById("seo-static");el&&(el.style.display="none");var g=document.getElementById("area-guide");g&&(g.style.display="none")});var GUIDE_ITEMS=[{title:"🏡 三重県が注文住宅に選ばれる理由",content:'<p>三重県北部は名古屋まで電車25〜50分の通勤圏でありながら、土地の坪単価は8〜19万円と全国平均（坪26万円）の1/3〜2/3。同じ4,000万円の予算でも、名古屋市内より300〜600万円分のゆとりが生まれます。</p><p>鈴鹿山脈から伊勢湾まで自然環境に恵まれ、子育て支援も充実。各市町村の医療費助成は15〜18歳までカバーされています。</p><p class="guide-modal-links">関連: <a href="/knowledge/mie-livability/">住みやすい街ランキング</a> / <a href="/knowledge/cost/">費用内訳ガイド</a></p>'},{title:"📍 エリア別の特徴と土地相場",content:'<ul><li><a href="/area/mie/yokkaichi/">四日市市</a>（坪18.8万円）— 県最大の商業都市、名古屋35分</li><li><a href="/area/mie/kuwana/">桑名市</a>（坪18.4万円）— 名古屋25分の好アクセス</li><li><a href="/area/mie/suzuka/">鈴鹿市</a>（坪13.6万円）— 手頃で広い家が建てやすい</li><li><a href="/area/mie/inabe/">いなべ市</a>（坪8.1万円）— 県北部最安、自然豊か</li><li><a href="/area/mie/kameyama/">亀山市</a>（坪9.8万円）— 交通の要衝、車通勤に便利</li><li><a href="/area/mie/komono/">菰野町</a>（坪10.3万円）— 温泉と自然の人気エリア</li><li><a href="/area/mie/toin/">東員町</a>（坪11.7万円）— 人口増加中の子育ての街</li></ul>'},{title:"💰 注文住宅の費用相場（三重県）",content:'<p>三重県で注文住宅を建てる場合、土地50坪＋建物35坪で総額2,800〜4,200万円が目安。全国平均（約4,903万円）より700〜2,100万円安く建てられます。</p><p>住宅ローンは変動金利0.3〜0.5%台が主流。つなぎ融資の手配も忘れずに。2026年は補助金・減税制度も充実しています。</p><p class="guide-modal-links">関連: <a href="/knowledge/cost/">費用の内訳</a> / <a href="/knowledge/housing-loan/">住宅ローンガイド</a> / <a href="/knowledge/subsidy-2026/">2026年の補助金</a></p>'},{title:"🚃 名古屋通勤・子育て環境",content:'<p>桑名から名古屋25分、四日市35分、鈴鹿50分（近鉄利用）。定期代は月1.5〜3万円程度。テレワーク併用なら、いなべ市や菰野町の自然豊かなエリアも選択肢に。</p><p>四日市市は小中学校58校・医療費助成18歳まで。桑名市は「子育て支援日本一」を掲げ、教育環境の充実に力を入れています。</p><p class="guide-modal-links">関連: <a href="/knowledge/mie-commute/">名古屋通勤ガイド</a> / <a href="/knowledge/mie-school-district/">学区ガイド</a></p>'},{title:"📋 家づくりの進め方",content:'<p>注文住宅は情報収集から入居まで12〜18ヶ月。まず予算を決め、土地探し・建築会社選びを並行して進めます。見積もりは必ず3社以上で比較しましょう。</p><p>設計打ち合わせは平均5〜10回。間取りは生活動線と収納計画が最重要ポイントです。</p><p class="guide-modal-links">関連: <a href="/knowledge/flow/">家づくりの流れ</a> / <a href="/knowledge/builder-comparison/">建築会社の選び方</a> / <a href="/knowledge/design-meeting/">設計打ち合わせのコツ</a></p>'},{title:"🔧 住宅性能の選び方",content:'<p>三重県は温暖な5〜6地域ですが、夏の猛暑対策に断熱等級5以上（UA値0.60以下）が推奨されます。ZEH水準にすると補助金35〜110万円の対象に。</p><p>南海トラフ地震に備え、耐震等級3の取得も検討しましょう。許容応力度計算による構造計算が最も信頼性が高い方法です。</p><p class="guide-modal-links">関連: <a href="/knowledge/energy-efficiency/">断熱性能ガイド</a> / <a href="/knowledge/earthquake-resistance/">耐震性能ガイド</a></p>'}];function openGuideModal(idx){var d=GUIDE_ITEMS[idx];d&&(document.getElementById("guide-modal-content").innerHTML="<h3>"+d.title+"</h3>"+d.content,document.getElementById("guide-modal").classList.add("open"),document.body.style.overflow="hidden")}function closeGuideModal(){document.getElementById("guide-modal").classList.remove("open"),document.body.style.overflow=""}</script>
</body>
</html>
